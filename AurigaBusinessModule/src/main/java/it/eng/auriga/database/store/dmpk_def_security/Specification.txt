1        PACKAGE DMPK_DEF_SECURITY AUTHID CURRENT_USER IS
2        
3        	/********* è il package che si occupa della definizione di tutte le entità legate alla sicurezza (tranne utenti, UO e ruoli) e della loro profilatura ********/
4        
5        	/****************************************************		INFORMAZIONI GENERALI		*******************************************************/
6        	/************** Argomenti delle stored per il controllo della transazione:											*******/
7        	/************** FlgRollBckFullIn -> se 1 in caso di errore viene fatta la rollback completa (non a savepoint), 					*******/
8        	/************** 				altrimenti la rollback delle sole modifiche effettuate nella stored						*******/
9        	/************** 				ATTENZIONE: la rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log			*******/
10        	/************** FlgAutoCommitIn  -> se vale 1, dopo la rollback e qualunque sia l'esito (positivo o no), la stored esegue una commit finale *****/
11        	/************** Tutte le funzioni/procedure che NON hanno gli argomenti in input FlgRollBckFullIn e FlgAutoCommitIn 				*******/
12        	/************** NON ESEGUONO AL LORO INTERNO ALCUNA COMMIT nè ROLLBACK 												*******/
13        
14        	/************** Tutte le funzioni, tranne quelle da utilizzarsi nelle select, restituiscono 1 in caso di successo, altrimenti 0		*******/
15        	/************** Tali funzioni restituiscono, in caso di result 0, un n.ro, un contesto e un messaggio di errore:					*******/
16        	/************** il n.ro è: <0 se errore ORACLE non specificamente gestito 											*******/
17        	/**************		   da 1->1000 errore "grave" (SEVERE_ERROR) gestito											*******/
18        	/**************		   >1000 errore non grave gestito														*******/
19        	/************** il contesto indica il package e/o funzione/procedura in cui si è verificato l'errore							*******/
20        
21        	/********** funzione per ottenere l'id. dell'organigramma in vigore per un dato soggetto prod./AOO ad un dato timestamp **********/
22        	function GetIdOrganigrammaSpAOO(
23        			IdSpAOOIn		IN		DMT_SOGGETTI_PROD_AOO.ID_SP_AOO%type,	-- (obblig) Id. del soggetto produttore o AOO per cui trovare l'organigramma
24        			TsRifIn			IN		DATE DEFAULT sysdate					-- Data e ora a cui ricavare l'organigramma
25        																			-- se non specificata si intende sysdate
26        			) return DMT_ORGANIGRAMMI.ID_ORGANIGRAMMA%type;					-- Id. dell'organigramma
27        																			-- in caso di errore o se non c'è il piano è NULL
28        
29        	/******* serve a ricercare una funzione del sistema (eventualmente solo se disponibile in un dato dominio di lavoro) a partire dal suo codice e/o sua descrizione		******/
30        	/******* restituisce il codice identificativo della funzione solo se a partire dagli estremi immessi riesce a identificarla univocamente			 			******/
31        	function FindFunzione(
32        			IdDominioIn				IN		DMT_SOGGETTI_PROD_AOO.ID_SP_AOO%type,	-- Identificativo del dominio di lavoro (se NULL si intende lo schema)
33        			CodFunzIn				IN		VARCHAR2 DEFAULT NULL,				-- Codice della funzione (stringa restituita dalla function dmpk_utility.GetCodFunz per quella funzione: ricerca case-sensitive esatta)
34        			DesFunzIn				IN		VARCHAR2 DEFAULT NULL,				-- Stringa contenuta nella descrizione della funzione (ricerca case-insenstive in like, se si mettono caratteri wilcard)
35        			FlgSoloDispIn			IN		PLS_INTEGER DEFAULT 1				-- (valori 1/0/NULL) Indica se la funzione deve essere valida e disponile nel dominio di lavoro (1) o no
36        			) return VARCHAR2;											-- restituisce il codice della funzione (stringa restituita dalla function dmpk_utility.GetCodFunz per quella funzione) se individuata univocamente, altrimenti NULL
37        
38        	/****** 	serve a ricercare le funzione del sistema e/o delle applicazioni esterne che vi si appogiano *******/
39        	function TrovaFunzioni(
40        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
41        																	-- (obblig). Codice identificativo del token di connessione
42        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
43        			FlgPreimpostaFiltroIn		IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1 i filtri e l'ordinamento vengono settati secondo le impostazioni dell'utente di lavoro, altrimenti restano come passati in input
44        			CodFunzP1IO				IN OUT	DMT_FUNZIONI.COD_FUNZ_P1%type,		-- 1° filtro di ricerca: Prima parte del codice della funzione, cioè quella che indica la macro-area di appartenenza (Ricerca case-sensitive esatta)
45        			CodFunzP2IO				IN OUT	DMT_FUNZIONI.COD_FUNZ_P2%type,		-- 2° filtro di ricerca: 2a parte del codice della funzione, cioè quella che indica l'area di appartenenza (Ricerca case-sensitive esatta)
46        			CodFunzP3IO				IN OUT	DMT_FUNZIONI.COD_FUNZ_P3%type,		-- 3° filtro di ricerca: 3a parte del codice della funzione (Ricerca case-sensitive esatta)
47        			CodFunzPnIO				IN OUT	VARCHAR2,						-- 4° filtro di ricerca: codice che deve essere contenuto in una qualsiasi delle 3 parti che compongono il codice della funzione (Ricerca case-sensitive esatta)
48        			DesFunzIO				IN OUT	VARCHAR2,						-- 5° filtro di ricerca: Stringa contenuta nella descrizione delle funzioni (ricerca case-insenstive in like)
49        			LivelloFunzIO			IN OUT	PLS_INTEGER,					-- 6° filtro di ricerca (valori ammessi 1/2/3/NULL): Serve a restringere la ricerca alle funzioni di primo livello (quelle che hanno COD_FUNZ_P2 e COD_FUNZ_P3 nulli), 2° livello (quelle che hanno COD_FUNZ_P3 nullo) e 3° livello (quelle che hanno COD_FUNZ_P3 valorizzato)
50        			FlgConSottoFunzioniIO		IN OUT	PLS_INTEGER,					-- 7° filtro di ricerca (valori 1/0/NULL) Se 1 indica che vanno ricercate funzioni con sotto-funzioni, se 0 funzioni senza sotto-funzioni
51        			FlgSoloDispIO			IN OUT	PLS_INTEGER,					-- 8° filtro di ricerca: (valori 1/0/NULL) Indica se le funzioni da cercare devono essere valide e disponili nel dominio di lavoro (1) o no
52        			FlgSoloConOpzStdIO		IN OUT	PLS_INTEGER,					-- 9° filtro di ricerca (valori 1/0/NULL) Se 1 indica che vanno ricercate solo le funzioni con opzioni standard, se 0 solo quelle senza opzioni standard
53        			CodApplOwnerIO			IN OUT	VARCHAR2,						-- 10° filtro di ricerca: Codice dell'applicazione "proprietaria" delle funzioni. Se valorizzata pari a #BY_CONN_TKN e si è connessi da un'applicazione esterna si ricercano solo funzioni di cui è proprietaria quell'applicazione
54        			CodIstApplOwnerIO			IN OUT	VARCHAR2,						-- 11° filtro di ricerca: Codice dell'istanza di applicazione "proprietaria" delle funzioni. Se valorizzata pari a #BY_CONN_TKN e si è connessi da un'applicazione esterna si ricercano solo funzioni di cui è proprietaria l'istanza di applicazione esterna da cui si è connessi
55        			FlgRestrApplOwnerIO		IN OUT	INTEGER,						-- (valori 1/0/NULL) Se 1 vengono estratte solo funzioni di cui è proprietaria l'applicazione proprietaria (ed eventuale istanza) specificata in CodApplOwnerIO; se 0 o NULL e se CodApplOwnerIO è valorizzata vengono estratte solo le funzioni senza applicazione proprietaria o con applicazione proprietria pari a quella specificata
56        			------------- inizio argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
57        			ColOrderByIO			IN OUT	VARCHAR2,						-- Indica il/i numeri della/e colonna dell'XML (CLOB ListaXMLOut) di output per cui ordinare i record nell'XML stesso (si può ordinare solo per le colonne da 1 a 6). Se l'ordinamento è per più colonne queste vanno separate con "," (es: 2; 2,3)
58        																	-- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul tipo di ordinamento una qualche preimpostazione di sistema/utente ecc.
59        																	-- se non valorizzato (neppure in output) la lista di record restituita non è ordinata
60        			FlgDescOrderByIO  		IN OUT	VARCHAR2,						-- E' una stringa di 1 o 0/NULL, tanti quanti le colonne di ordinamento, separati da ",": 1 significa che l'ordinamento per la data colonna deve essere discendente anzichè ascendente (es: 1; 1,0; 1, )
61        																	-- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul verso di ordinamento una qualche preimpostazione di sistema/utente ecc.
62        			FlgSenzaPaginazioneIn 		IN 		PLS_INTEGER DEFAULT NULL,            	-- (valori 1/0/NULL) Se 1 l'estrazione non è paginata, altrimenti sì
63        			NroPaginaIO      			IN OUT	PLS_INTEGER,                  		-- E' il numero della pagina da estrarre; se NULL e l'estrazione è paginata viene estratta la prima pagina
64           			BachSizeIO				IN OUT	PLS_INTEGER,					-- Indica il massimo n.ro di record da estrarre se l'estrazione non è paginata (FlgSenzaPaginazioneIn=1)
65        																	-- Indica la dimensione (n.ro di record) della pagina se l'estrazione è paginata (FlgSenzaPaginazioneIn 0 o NULL) e in tal caso se non è valorizzato la dimensione della pagina è quella settata per l'utente di lavoro o è pari al valore del parametro STD_PAGE_NUM_ROW del dominio di lavoro
66        			OverFlowLimitIn			IN		PLS_INTEGER DEFAULT NULL,			-- E' il n.ro di record soddisfacenti la ricerca superato il quale la funzione deve restituire errore di overflow
67        			FlgSenzaTotIn			IN		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 significa che non è richiesto come output il totale dei record soddisfacenti la ricerca (se la ricerca è paginata per la prima pagina il totale viene calcolato comunque, per le successive no)
68        			NroTotRecOut			OUT		PLS_INTEGER,					-- E' il n.ro di record complessivi trovati (valorizzato solo se FlgSenzaTotIn è 0 o NULL o se si estrae la prima pagina)
69             			NroRecInPaginaOut 		OUT   	PLS_INTEGER,                     		-- E' il numero di record nella pagina (valorizzato solo se l'estrazione è paginata, ovvero se FlgSenzaPaginazioneIn 0 o NULL)
70        			------------- fine argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
71        			ListaXMLOut				OUT		NOCOPY CLOB,					-- Lista delle funzionalità di sistema trovate (XML conforme a schema LISTA_STD.xsd)
72        																	-- Ogni funzionalità di sistema è un tag Riga che contiene le seguenti colonne:
73        																	-- 1: Codice completo della funzione (stringa restituita dalla function dmpk_utility.GetCodFunz per quella funzione)
74        																	-- 2: Parte 1 del codice funzione
75        																	-- 3: Parte 2 del codice funzione
76        																	-- 4: Parte 3 del codice funzione
77        																	-- 5: Descrizione semplice della funzione (senza le descrizioni delle funzioni superiori a prefisso)
78        																	-- 6: Descrizione estesa della funzione (con le descrizioni delle funzioni superiori a prefisso)
79        																	-- 7: (valori 1/0) Flag di funzione con opzioni standard (1) o senza (0)
80        																	-- 8: (valori 1/0) Flag di funzione valida e attiva nel dominio
81        																	-- 9: (valori 1/0/NULL) Flag che indica che la funzione è relativa all'applicazione CodApplOwnerIO ed eventuale sua istanza CodIstApplOwnerIO
82        																	-- 10: Descrizione dell'applicazione (ed eventuale sua istanza) proprietaria della funzione
83        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
84        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
85        			ErrMsgOut				OUT 		VARCHAR2,						-- Messaggio d'errore
86        			FlgStatoAbilIn			IN		PLS_INTEGER default NULL,			-- (valori 1/0/NULL): filtro di ricerca per restringere la ricerca alle sole funzioni cui l'utente/UO/scrivania/profilo ecc specificato nell'argomento IdDestAbilIn ha (= 1) o non ha (=0) abilitazione (con le opzioni eventualmente specificate nell'argomento OpzioniAbilIn)
87        			FlgTpDestAbilIn			IN		VARCHAR2 default NULL,				-- (obblig. e gestito solo se FlgStatoAbilIn è valorizzato) Indica il tipo di chi (utente o UO ecc) deve avere o non avere abilitazione - con tutte le opzioni specificate in OpzioniAbilIn - verso le funzioni da ricercare
88        																	-- Valori ammessi:
89        																	--	UO	=	U.O.
90        																	-- 	SV	=	Scrivania virtuale
91        																	--	UT	=	Utente
92        																	--	PR	=	Profilo
93        																	--	GP	=	Gruppo di privilegi
94        																	--	RA	=	Ruolo amministrativo
95        			IdDestAbilIn			IN		INTEGER default NULL,				-- (obblig. e gestito solo se FlgStatoAbilIn è valorizzato) Identificativo (ID_UO o ID_SCRIVANIA o ID_USER o ID_PROFILO o ID_GRUPPO_PRIV o ID_RUOLO_AMM) di chi deve avere o non avere abilitazione - con tutte le opzioni specificate in OpzioniAbilIn - verso le funzioni da ricercare
96        			OpzioniAbilIn			IN		VARCHAR2 DEFAULT NULL,				-- Indica la/le opzione (se più di una separate da ;) con cui IdDestAbilIn deve essere abilitato o meno (a seconda che FlgStatoAbilIn sia 1 o 0) alle funzioni da ricercare
97        																	-- Opzioni possibili:
98        																	--	M	=	Solo modifica
99        																	--	I	=	Inserimento e modifica
100        																	--	FC	=	Full control
101        																	--	SP	=	relativamente agli archivi di tutto il soggetto produttore
102        																	--	eSP	=	relativamente agli archivi di tutti i soggetti produttori in banca dati
103        			RigaTagNameIn			IN		VARCHAR2 DEFAULT NULL,				-- (opzionale) Come rinominare il tag Riga dell'XML ListaXMLOut di output
104        			ColTagNameIn			IN		DMVA_STRING DEFAULT NULL			-- (opzionale) Come rinominare i tag delle colonne in alternativa a Colonna Nro=.. nell'XML ListaXMLOut di output
105        			)return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine, altrimenti 0
106        
107        	/****** 	funzione per ricercare le applicazioni esterne e loro istanze censite in banca dati		*******/
108        	function TrovaApplicazioneEsterna(
109        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
110        																	-- (obblig). Codice identificativo del token di connessione
111        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
112        			FlgPreimpostaFiltroIn		IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1 i filtri e l'ordinamento vengono settati secondo le impostazioni dell'utente di lavoro, altrimenti restano come passati in input
113        			--------------- inizio filtri di ricerca-------------------
114        			CodApplicazioneIO			IN OUT	DMT_APPLICAZIONI_ESTERNE.CI_APPLICAZIONE%TYPE ,
115        																	-- 1° filtro di ricerca: codice identificativo dell'applicazione (ricerca case-insensitive in like )
116        			CodIstanzaApplicazioneIO	IN OUT	DMT_APPLICAZIONI_ESTERNE.CI_ISTANZA_APPLICAZIONE%TYPE,
117        																	-- 2° filtro di ricerca: codice identificativo dell'istanza di applicazione (ricerca case-insensitive in like)
118        			DescrizioneApplIstanzaIO	IN OUT	DMT_APPLICAZIONI_ESTERNE.DESCRIZIONE%TYPE,
119        																	-- 3° filtro di ricerca: descrizione dell'applicazione esterna e/o sua istanza (ricerca case-insensitive in like)
120        			IdSpAOOIO				IN OUT	DMT_APPLICAZIONI_ESTERNE.ID_SP_AOO%type,	-- 4° filtro di ricerca: id. del soggetto produttore/AOO sulla cui repository lavorano le applicazioni esterne e/o loro istanze da ricercare
121        																	-- Se NULL e si è connessi ad un certo dominio (soggetto produttore/AOO) vengono comunque estratte solo le applicazioni esterne e/o loro istanze che insistono sulla/e repository di quel dominio
122        			FlgUsaCredenzialiProprieIO	IN OUT	PLS_INTEGER,					-- 5° filtro di ricerca (valori 1/0/NULL) Serve a restiringere la ricerca alle applicazioni e istanze che usano per l'autenticazione:
123        																	-- 	1 = credenziali proprie diverse da quelle del sistema documentale
124        																	--	0 = le stesse del sistema documentale
125        			FlgInclAnnullatiIO		IN OUT	INTEGER,						-- (valori 1/0/NULL) 6° filtro di ricerca: se 1 vengono estratte anche le applicazioni esterne/loro istanze logicamente annullate, altrimenti no
126        			CriteriSuAttrDinIO		IN OUT 	NOCOPY CLOB,					-- Altri criteri di ricerca sugli attributi addizionali delle applicazioni esterne e loro istanze (XML conforme a schema LISTA_STD.xsd). Se più di uno vengono applicati in AND.
127        																	-- Ogni criterio è un tag Riga che può contenere le seguenti colonne:
128        																	--	1) Nome (ATTR_NAME) dell'attributo cui è relativo il criterio
129        																	--	2) (obblig.) Operatore logico. Valori possibili:
130        																	--		"uguale" (ricerca esatta)
131        																	--		"simile a (case-sensitive)" (ricerca case-sensitive in like)
132        																	--		"simile a (case-insensitive)" (ricerca case-insensitive in like e che ignora i caratteri quali spazi, ., ecc)
133        																	--		"maggiore" (se attributo numerico o data)
134        																	--		"maggiore o uguale" (se attributo numerico o data)
135        																	--		"minore" (se attributo numerico o data)
136        																	--		"minore o uguale" (se attributo numerico o data)
137        																	--		"tra" (se attributo numerico o data)
138        																	--		"non valorizzato"
139        																	--		"valorizzato"
140        																	--		"spuntato" (se attributo di tipo casella di spunta)
141        																	--		"non spuntato" (se attributo di tipo casella di spunta)
142        																	--	3) 1° valore di confronto (obblig. e gestito solo se l'operatore non ha uno dei seguenti valori: valorizzato, non valorizzato, spuntato, non spuntato) (se l'attributo è numerico deve avere la virgola come separatore dei decimali, se è di tipo data deve essere in uno dei formato dati dai parametri di conf. FMT_STD_DATA e FMT_STD_TIMESTAMP)
143        																	--	4) 2° valore di confronto (obblig. e gestito solo se l'operatore è "tra") (se l'attributo è numerico deve avere la virgola come separatore dei decimali, se è di tipo data deve essere in uno dei formato dati dai parametri di conf. FMT_STD_DATA e FMT_STD_TIMESTAMP)
144        																	--	5) Label dell''attributo cui è relativo il criterio (se sotto-attributo di complesso <label del complesso> - <label del sotto-attributo>
145        			------------- inizio argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
146        			ColOrderByIO			IN OUT	VARCHAR2,						-- Indica il/i numeri della/e colonna dell'XML (CLOB ListaXMLOut) di output per cui ordinare i record nell'XML stesso (si può ordinare solo per le colonne da 1 a 5). Se l'ordinamento è per più colonne queste vanno separate con "," (es: 2; 2,3)
147        																	-- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul tipo di ordinamento una qualche preimpostazione di sistema/utente ecc.
148        																	-- se non valorizzato (neppure in output) la lista di record restituita non è ordinata
149        			FlgDescOrderByIO  		IN OUT	VARCHAR2,						-- E' una stringa di 1 o 0/NULL, tanti quanti le colonne di ordinamento, separati da ",": 1 significa che l'ordinamento per la data colonna deve essere discendente anzichè ascendente (es: 1; 1,0; 1, )
150        																	-- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul verso di ordinamento una qualche preimpostazione di sistema/utente ecc.
151        			FlgSenzaPaginazioneIn 		IN 		PLS_INTEGER DEFAULT NULL,            	-- (valori 1/0/NULL) Se 1 l'estrazione non è paginata, altrimenti sì
152        			NroPaginaIO      			IN OUT	PLS_INTEGER,                  		-- E' il numero della pagina da estrarre; se NULL e l'estrazione è paginata viene estratta la prima pagina
153           			BachSizeIO				IN OUT	PLS_INTEGER,					-- Indica il massimo n.ro di record da estrarre se l'estrazione non è paginata (FlgSenzaPaginazioneIn=1)
154        																	-- Indica la dimensione (n.ro di record) della pagina se l'estrazione è paginata (FlgSenzaPaginazioneIn 0 o NULL) e in tal caso se non è valorizzato la dimensione della pagina è quella settata per l'utente di lavoro o è pari al valore del parametro STD_PAGE_NUM_ROW del dominio di lavoro
155        			OverFlowLimitIn			IN		PLS_INTEGER DEFAULT NULL,			-- E' il n.ro di record soddisfacenti la ricerca superato il quale la funzione deve restituire errore di overflow
156        			FlgSenzaTotIn			IN		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 significa che non è richiesto come output il totale dei record soddisfacenti la ricerca (se la ricerca è paginata per la prima pagina il totale viene calcolato comunque, per le successive no)
157        			NroTotRecOut			OUT		PLS_INTEGER,					-- E' il n.ro di record complessivi trovati (valorizzato solo se FlgSenzaTotIn è 0 o NULL o se si estrae la prima pagina)
158             			NroRecInPaginaOut 		OUT   	PLS_INTEGER,                     		-- E' il numero di record nella pagina (valorizzato solo se l'estrazione è paginata, ovvero se FlgSenzaPaginazioneIn 0 o NULL)
159        			------------- fine argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
160        			ListaXMLOut				OUT		NOCOPY CLOB,					-- Lista delle applicazioni esterne e loro istanze trovate (XML conforme a schema LISTA_STD.xsd)
161        																	-- Ogni applicazione esterna e sua istanza è un tag Riga che contiene le seguenti colonne:
162        																	-- 1: Codice dell'applicazione esterna
163        																	-- 2: Codice dell'istanza dell'applicazione esterna
164        																	-- 3: Descrizione dell'applicazione esterna/sua istanza
165        																	-- 4: (valori 1/0) Se 1 si tratta di un'applicazione esterna/sua istanza in cui ci si autentica con credenziali diverse da quelle del documentale
166        																	-- 5: (valori 1/0) Se 1 si tratta di un'applicazione esterna/sua istanza annullata
167        																	-- 6: Data e ora di prima connessione dall'applicazione/sua istanza (nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP)
168        																	-- 7: Data e ora di ultima connessione dall'applicazione/sua istanza (nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP)
169        																	-- 8: Timestamp di creazione dell'applicazione esterna/sua istanza (nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP)
170        																	-- 9: Descrizione dell'utente di creazione dell'applicazione esterna/sua istanza
171        																	-- 10: Timestamp di ultima modifica dei dati dell'applicazione esterna/sua istanza (nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP)
172        																	-- 11: Descrizione dell'utente di ultima modifica dei dati dell'applicazione esterna/sua istanza
173        																	-- 12: (valori 1/0) Se 1 indica che l'applicazione rappresenta una società del gruppo di società rappesentato dal dominio (ID_SP_AOO) cui si è collegati
174        																	-- 13: Codice fiscale della società che l'applicazione rappresenta
175        																	-- 14: Partita della società che l'applicazione rappresenta
176        																	-- 15: Indirizzo/i e-mail PEC attraverso cui inviare comunicazione all'applicazione/società (se più di uno separati da ;)
177        																	-- 16: Indirizzo/i e-mail PEO attraverso cui inviare comunicazione all'applicazione/società (se più di uno separati da ;)
178        																	-- 17: Modalita' di invio dei documenti alle societa' (attributo MODALITA_INVIO_DOC_SOCIETA)
179                                                                            -- 18: Formato di invio dei documenti alle societa' (attributo FORMATO_INVIO_DOC_SOCIETA)
180                                                                            -- 19: Indirizzo email destinazione dei documenti alle societa' (attributo EMAIL_DEST_DOC_SOCIETA)
181                                                                            -- 20: Protocollo invio ftp (ftp/ftps) (attributo PROTOCOLLO_FTP)
182                                                                            -- 21: Indirizzo ftp (attributo INDIRIZZO_FTP)
183                                                                            -- 22: Username ftp (attributo USERNAME_FTP)
184                                                                            -- 23: Password ftp (attributo PWD_FTP)
185        			FlgAbilInsOut	 		OUT 		PLS_INTEGER ,            			-- (valori 1/0) Se 1 si ha abilitazione a creazione di nuove applicazioni esterne/loro istanze
186        			FlgAbilUpdOut 			OUT 		PLS_INTEGER ,            			-- (valori 1/0) Se 1 si ha abilitazione a modifica di applicazioni esterne/loro istanze
187        			FlgAbilDelOut 			OUT 		PLS_INTEGER,            			-- (valori 1/0) Se 1 si ha abilitazione a cancellazione di applicazioni esterne/loro istanze
188        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
189        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
190        			ErrMsgOut				OUT 		VARCHAR2,						-- Messaggio d'errore
191        			RigaTagNameIn			IN		VARCHAR2 DEFAULT NULL,				-- (opzionale) Come rinominare il tag Riga dell'XML ListaXMLOut di output
192        			ColTagNameIn			IN		DMVA_STRING DEFAULT NULL)			-- (opzionale) Come rinominare i tag delle colonne in alternativa a Colonna Nro=.. nell'XML ListaXMLOut di output
193        			return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine, altrimenti 0
194        
195        	/***** Funzione per inserire o aggiornare un'applicazione esterna o sua istanza 									*****/
196        	/***** Se si specificano codice applicazione ed eventuale codice istanza già presenti si va in modifica, altrimenti in inserimento 	*****/
197        	function IUApplicazioneEsterna(
198        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
199        																	-- (obblig). Codice identificativo del token di connessione
200        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
201        			CodApplicazioneIO			IN OUT	DMT_APPLICAZIONI_ESTERNE.CI_APPLICAZIONE%TYPE ,
202        																	-- (obblig.) Codice identificativo dell'applicazione
203        			CodIstanzaApplicazioneIO	IN OUT	DMT_APPLICAZIONI_ESTERNE.CI_ISTANZA_APPLICAZIONE%TYPE,
204        																	-- Codice identificativo dell'istanza di applicazione
205        			DescrizioneApplIstanzaIn	IN		DMT_APPLICAZIONI_ESTERNE.DESCRIZIONE%TYPE DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
206        																	-- Descrizione dell'applicazione esterna e/o sua istanza
207        			IdSpAOOIn				IN 		DMT_APPLICAZIONI_ESTERNE.ID_SP_AOO%type DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
208        																	-- Id. del soggetto produttore/AOO sulla cui repository lavora l'applicazione esterna o sua istanza
209        																	-- Se si è connessi ad un dominio che è un soggetto produttore o AOO, il soggetto produttore/AOO sulla cui repository lavora l'applicazione esterna o sua istanza viene comunque inteso pari al dominio da cui si è connessi
210        																	-- altrimenti questo input non può essere NULL
211        			FlgUsaCredenzialiProprieIn	IN 		PLS_INTEGER DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
212        																	-- (valori 1/0/NULL) Indica se l'applicazione o la sua istanze usa per l'autenticazione:
213        																	-- 	1 = credenziali proprie diverse da quelle del sistema documentale
214        																	--	0 o NULL = le stesse del sistema documentale
215        			AttributiAddIn			IN		CLOB DEFAULT NULL,				-- XML contenente nomi e valori degli attributi dinamici da aggiornare (conforme allo schema SezioneCache.xsd)
216        																	-- Gli attributi già presenti in DB e per i quali non c'è corrispondente nell'XML restano invariati
217        																	-- Per tutti gli attributi vale quanto segue:
218        																	-- Un attributo da settare è un tag "Variabile" dell'XML il cui tag "Nome" contiene il nome identificativo dell'attributo (ATTR_NAME di DMT_ATTRIBUTES_DEF)
219        																	-- Un attributo da settare è una variabile con tag "ValoreSemplice" se è un attributo a singolo valore e non strutturato (cioè con tipo diverso da COMPLEX)
220        																	-- altrimenti è una variabile con tag "Lista" che ha un'unica colonna con "Nro" pari a 1 se l'attributo non è strutturato, che ha invece tante colonne quanti gli attributi componenti (ordinate in base al loro NRO_ORD_IN_SUP) se l'attributo è complesso
221        																	-- Nel caso di variabili con tag "Lista" i valori specificati nell'XML si aggiungono o sostituiscono quelli già presenti in DB a seconda che nell'XML sia presente o meno una variabile con tag "Nome" pari a #Append_<Nome attributo> e tag "ValoreSemplice" pari a 1
222        																	-- In particolare se non sono specificati valori nell'XML (tag Lista vuoto) e se i valori non sono da aggiungere significa che tutti i valori dell'attributo già presenti in DB vanno rimossi
223        			FlgIgnoreWarningIn 		IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 0 o NULL significa che in presenza di WARNING la stored si comporta come in caso di errore; se 1 gli WARNING vengono ignorati
224        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
225        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
226        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
227        			WarningMsgOut			OUT		VARCHAR2,						-- Messaggio di warning (valorizzato solo se non c'è errore)
228        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
229        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
230        			ErrMsgOut				OUT 		VARCHAR2						-- Messaggio d'errore
231        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine (senza warning), altrimenti 0 (in caso di errore o warning)
232        
233        	/*** Funzione di eliminazione di un'applicazione esterna o sua istanza 					***/
234        	/*** Si può specificare se l'eliminazione deve essere fisica o solo logica (annullamento)		***/
235        	/*** Se non lo si specifica il sistema fa quella fisica se possibile, se no quella logica		***/
236        	function DApplicazioneEsterna(
237        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
238        																	-- (obblig). Codice identificativo del token di connessione
239        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
240        			CodApplicazioneIn			IN 		DMT_APPLICAZIONI_ESTERNE.CI_APPLICAZIONE%TYPE ,
241        																	-- (obblig.) Codice identificativo dell'applicazione
242        			CodIstanzaApplicazioneIn	IN 		DMT_APPLICAZIONI_ESTERNE.CI_ISTANZA_APPLICAZIONE%TYPE,
243        																	-- Codice identificativo dell'istanza di applicazione
244        			FlgCancFisicaIn			IN		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL): Se 1 si richiede la cancellazione fisica; se 0 l'annullamento logico; se non è valorizzato quella possibile delle 2.
245        			MotiviIn				IN		DMT_ACTIVITIES.NOTE%type,			-- Motivi della cancellazione/annullamento
246        			FlgIgnoreWarningIn 		IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 0 o NULL significa che in presenza di WARNING la stored si comporta come in caso di errore; se 1 gli WARNING vengono ignorati
247        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
248        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
249        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
250        			WarningMsgOut			OUT		VARCHAR2,						-- Messaggio di warning (valorizzato solo se non c'è errore)
251        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
252        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
253        			ErrMsgOut				OUT 		VARCHAR2						-- Messaggio d'errore
254        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine (senza warning), altrimenti 0 (in caso di errore o warning)
255        
256        	/***** funzione per estrarre i dati di un'applicazione esterna o sua istanza 				***/
257        	/***** noto il suo codice identificativo										***/
258        	function LoadDettApplicazioneEsterna(
259        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
260        																	-- (obblig). Codice identificativo del token di connessione
261        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
262        			CodApplicazioneIn			IN 		DMT_APPLICAZIONI_ESTERNE.CI_APPLICAZIONE%TYPE ,
263        																	-- (obblig.) Codice identificativo dell'applicazione
264        			CodIstanzaApplicazioneIn	IN 		DMT_APPLICAZIONI_ESTERNE.CI_ISTANZA_APPLICAZIONE%TYPE,
265        																	-- Codice identificativo dell'istanza di applicazione
266        			DescrizioneApplIstanzaOut	OUT		DMT_APPLICAZIONI_ESTERNE.DESCRIZIONE%TYPE,-- Descrizione dell'applicazione esterna e/o sua istanza
267        			IdSpAOOOut				OUT		DMT_APPLICAZIONI_ESTERNE.ID_SP_AOO%type,	-- Id. del soggetto produttore/AOO sulla cui repository lavora l'applicazione esterna o sua istanza
268        			FlgUsaCredenzialiProprieOut	OUT 		PLS_INTEGER,					-- (valori 1/0) Indica se l'applicazione o la sua istanze usa per l'autenticazione:
269        																	-- 	1 = credenziali proprie diverse da quelle del sistema documentale
270        																	--	0 = le stesse del sistema documentale
271        			TsFirstLogonOut			OUT		VARCHAR2,						-- Data e ora di prima connessione dall'applicazione/sua istanza (nel formato dato dal parametro FMT_STD_TIMESTAMP)
272        			TsLastLogonOut			OUT		VARCHAR2,						-- Data e ora di ultima connessione dall'applicazione/sua istanza (nel formato dato dal parametro FMT_STD_TIMESTAMP
273        			RowidOut				OUT		VARCHAR2,						-- Rowid del record del tipo di processo
274        			AttributiAddOut			OUT		NOCOPY CLOB,					-- Lista degli eventuali ulteriori attributi con cui caratterizzare l'applicazione esterna e/o sua istanza (XML conforme a schema LISTA_STD.xsd)
275        																	-- Ogni attributo è un tag "Riga" che contiene le seguenti colonne:
276        																	-- 1: N.ro (valori da 1 a n) del riquadro (fieldset) in cui mostrare l'attributo
277        																	-- 2: Nome identificativo dell'attributo (ATTR_NAME)
278        																	-- 3: Label del campo con cui rappresentare l'attributo
279        																	-- 4: Tipo di attributo. Valori: DATE, DATETIME, TEXT, TEXT-AREA, CHECK, INTEGER, EURO, DECIMAL, COMBO-BOX, LISTA
280        																	-- 5: N.ro massimo di caratteri/cifre
281        																	-- 6: Larghezza del campo con cui rappresentare l'attributo (size)
282        																	-- 7: Valore dell'attributo
283        																	-- 8: Label del riquadro (fieldset) in cui mostrare l'attributo
284        																	-- 9: (valori 1/0) 1 indica che l'attributo è obbligatorio, 0 che è facoltativo
285        																	-- 10: Altezza (in nro righe) del campo con cui rappresentare l'attributo (se TEXT-AREA)
286        																	-- 11:(valori 1/0) 1 indica se l'attributo è modificabile, 0 che è in sola visualizzazione
287        			FlgMostraAltriAttrOut		OUT		PLS_INTEGER,					-- (valori 1/0) Se 1 nella GUI vanno mostrati gli attributi addizionali (ce ne sono di visibile all'utente), se 0 no
288        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
289        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
290        			ErrMsgOut				OUT 		VARCHAR2)						-- Messaggio d'errore
291        			return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine, altrimenti 0
292        
293        
294        	/******* Funzione per assegnare ad un dato destinatario (Soggetto Produttore/AOO/UO/scrivania/utente/profilo/ruolo/gruppo di privilegi)  	*******/
295        	/******* privilegi su un dato oggetto di definizione del contesto organizzativo,archivistico e procedurale 						*******/
296        	/******* ATTENZIONE: se i privilegi sono già dati non viene dato errore 											*******/
297        	function GrantPrivSuOggDefContesto(
298        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
299        																	-- (obblig). Codice identificativo del token di connessione
300        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
301        			FlgTpObjPrivOnIn			IN		VARCHAR2,						-- (obblig.) Indica il tipo di oggetto su cui dare i privilegi
302        																	-- Valori ammessi:
303        																	--	F	=	Funzionalità del sistema;
304        																	--	TP	=	Tipo di processo/procedimento;
305        																	--	TD	=	Tipo di documento;
306        																	--	TF	=	Tipo di folder;
307        																	--	C	=	Classificazione;
308        																	--	TR	=	Tipo di registrazione (protocollo o repertorio o altro);
309        																	--	MR	=	Modello di registrazione
310        			CIObjPrivOnIn			IN		DMT_PRIVILEGI.CI_OGG_PRIVILEGIO%type DEFAULT NULL,
311        																	-- Codice identificativo dell'oggetto su cui dare i privilegi (se funzione è la stringa restituita dalla function dmpk_utility.GetCodFunz per quella funzione, se tipo di registrazione è il suo ID_TP_REGISTRAZIONE, non la categoria e sigla)
312        			DesObjPrivOnIn			IN		VARCHAR2 DEFAULT NULL,				-- Descrizione/denominazione dell'oggetto su cui dare i privilegi (ricerca case insensitive in like)
313        			LivelliClassifPrivOnIn		IN		VARCHAR2 DEFAULT NULL,				-- (da valorizzare solo se FlgTpObjPrivOnIn=C) Stringa con i n.ri livello della classificazione su cui dare i privilegi (tutti o solo alcuni; però se si specifica un livello è obbligatorio indicare tutti i livelli superiori; vanno indicati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; vanno separati dal separatore dei livelli di classificazione valido per il soggetto produttore/AOO)
314        			FlgTpObjPrivToIn			IN		VARCHAR2,						-- (obblig.) Indica il tipo di destinatario a cui dare i privilegi
315        																	-- Valori ammessi:
316        																	-- 	SA	=	Soggetto produttore/AOO
317        																	--	UO	=	U.O.
318        																	-- 	SV	=	Scrivania virtuale
319        																	--	UT	=	Utente
320        																	--	PR	=	Profilo
321        																	--	GP	=	Gruppo di privilegi
322        																	--	RA	=	Ruolo amministrativo (consentito solo se si assegna abilitazione a funzione, ovvero se FlgTpObjPrivOnIn=F)
323        			IdObjPrivToIn			IN		INTEGER DEFAULT NULL,				-- Identificativo (ID_SP_AOO o ID_UO o ID_SCRIVANIA o ID_USER o ID_PROFILO o ID_GRUPPO_PRIV o ID_RUOLO_AMM) del destinatario dei privilegi
324        			DesObjPrivToIn			IN		VARCHAR2 DEFAULT NULL,				-- Descrizione/denominazione del destinatario dei privilegi (ricerca case insensitive in like)
325        			LivelliUOPrivToIn			IN		VARCHAR2 DEFAULT NULL,				-- (da valorizzare solo se FlgTpObjPrivToIn=UO o SV) Stringa con i n.ri livello della UO destinataria o a cui appartiene la scrivania destinataria (tutti o alcuni; però se si specifica un livello è obbligatorio indicare tutti i livelli superiori; vanno specificati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; sono separati dal separatore dei livelli valido per il soggetto produttore/AOO di appartenenza della UO)
326        			DesUOAppScrivaniaToIn		IN		VARCHAR2 DEFAULT NULL,				-- (da valorizzare solo se FlgTpObjPrivToIn=SV) Denominazione della UO in cui si trova la scrivania destinataria (o suo inizio; ricerca case insensitive in like). Può essere quella semplice o la concatenazione con separatore "|" delle denominazioni delle UO superiori + quella della UO
327        			DesUserScrivaniaToIn		IN		VARCHAR2 DEFAULT NULL,				-- (da valorizzare solo se FlgTpObjPrivToIn=SV) Denominazione dell'utente che occupa la scrivania destinataria (ricerca case insensitive in like).
328        			ListaPrivilegiIn			IN		VARCHAR2 DEFAULT NULL,				-- Indica i privilegi (se più di uno separati da ;) da aggiungere (non va specificato nulla nel caso di oggetti, per esempio certe funzioni, in cui l'oggetto e il destinatario già definiscono il privilegio)
329        																	-- Valori possibili:
330        																	-- 	FC	=	Full control
331        																	--	I	=	Inserimento (e anche modifica)
332        																	--	M	=	Modifica
333        																	--	A	=	ad Assegnare/Avviare/registrare/creare
334        																	--	F	=	a Firmare
335        																	--	AF	=	ad Aprire Fascicoli
336        																	--	SP	=	relativamente agli archivi di tutto il soggetto produttore
337        																	--	eSP	=	relativamente agli archivi di tutti i soggetti produttori in banca dati
338        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
339        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
340        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
341        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
342        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
343        			ErrMsgOut				OUT 		VARCHAR2						-- Messaggio d'errore
344        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine (senza warning), altrimenti 0 (in caso di errore o warning)
345        
346        	/******* Funzione per assegnare ad un dato destinatario (Soggetto Produttore/AOO/UO/scrivania/utente/profilo/ruolo/gruppo di privilegi)  	*******/
347        	/******* o privilegi su oggetti omogenei di definizione del contesto organizzativo,archivistico e procedurale o gruppi di privilegi		*******/
348        	/******* ATTENZIONE: se i privilegi/gruppi di privilegi sono già dati non viene dato errore 								*******/
349        	function GrantPrivSuDefContesto(
350        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
351        																	-- (obblig). Codice identificativo del token di connessione
352        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
353        			FlgTpObjPrivToIn			IN		VARCHAR2,						-- (obblig.) Indica il tipo di destinatario a cui dare i privilegi
354        																	-- Valori ammessi:
355        																	-- 	SA	=	Soggetto produttore/AOO
356        																	--	UO	=	U.O.
357        																	-- 	SV	=	Scrivania virtuale
358        																	--	UT	=	Utente
359        																	--	PR	=	Profilo
360        																	--	GP	=	Gruppo di privilegi
361        																	--	RA	=	Ruolo amministrativo (consentito solo se si assegna abilitazione a funzione, ovvero se FlgTpObjPrivOnIn=F)
362        			IdObjPrivToIn			IN		INTEGER DEFAULT NULL,				-- Identificativo (ID_SP_AOO o ID_UO o ID_SCRIVANIA o ID_USER o ID_PROFILO o ID_GRUPPO_PRIV o ID_RUOLO_AMM) del destinatario dei privilegi
363        			DesObjPrivToIn			IN		VARCHAR2 DEFAULT NULL,				-- Descrizione/denominazione del destinatario dei privilegi (ricerca case insensitive in like)
364        			LivelliUOPrivToIn			IN		VARCHAR2 DEFAULT NULL,				-- (da valorizzare solo se FlgTpObjPrivToIn=UO o SV) Stringa con i n.ri livello della UO destinataria o a cui appartiene la scrivania destinataria (tutti o alcuni; però se si specifica un livello è obbligatorio indicare tutti i livelli superiori; vanno specificati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; sono separati dal separatore dei livelli valido per il soggetto produttore/AOO di appartenenza della UO)
365        			DesUOAppScrivaniaToIn		IN		VARCHAR2 DEFAULT NULL,				-- (da valorizzare solo se FlgTpObjPrivToIn=SV) Denominazione della UO in cui si trova la scrivania destinataria (o suo inizio; ricerca case insensitive in like). Può essere quella semplice o la concatenazione con separatore "|" delle denominazioni delle UO superiori + quella della UO
366        			DesUserScrivaniaToIn		IN		VARCHAR2 DEFAULT NULL,				-- (da valorizzare solo se FlgTpObjPrivToIn=SV) Denominazione dell'utente che occupa la scrivania destinataria (ricerca case insensitive in like).
367        			FlgTpObjToGrantIn			IN		VARCHAR2,						-- (obblig.) Indica il tipo degli oggetti da grantare
368        																	-- Valori ammessi:
369        																	--	F	=	Privilegi su Funzionalità del sistema;
370        																	--	TP	=	Privilegi su Tipi di processi/procedimenti;
371        																	--	TD	=	Privilegi su Tipi di documenti;
372        																	--	TF	=	Privilegi su Tipi di folder;
373        																	--	C	=	Privilegi su Classificazioni;
374        																	--	TR	=	Privilegi su Tipi di registrazione (protocollo o repertorio o altro);
375        																	--	MR	=	Privilegi su Modelli di registrazione
376        																	--	GP	=	Gruppi di privilegi (solo se FlgTpObjPrivToIn = UO o SV o UT o PR)
377        			ListaObjToGrantXMLIn		IN		CLOB,							-- Lista con gli estremi degli oggetti di definizione contesto su cui dare privilegi o dei gruppi di privilegi da dare (XML conforme a schema LISTA_STD.xsd)
378        																	-- Ogni tag "Riga" rappresenta un oggetto di definizione del contesto o un gruppo di privilegi e può contenere le seguenti colonne:
379        																	-- 1: Codice identificativo dell'oggetto su cui dare i privilegi (se funzione è la stringa restituita dalla function dmpk_utility.GetCodFunz per quella funzione, se tipo di registrazione è il suo ID_TP_REGISTRAZIONE, non la categoria e sigla)
380        																	-- 	o del gruppo di privilegi
381        																	-- 2: Descrizione/denominazione dell'oggetto su cui dare i privilegi o del gruppo di privilegi (ricerca case insensitive in like)
382        																	-- 3: (da valorizzare solo se FlgTpObjToGrantIn=C) Stringa con i n.ri livello della classificazione su cui dare i privilegi (tutti o solo alcuni; però se si specifica un livello è obbligatorio indicare tutti i livelli superiori; vanno indicati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; vanno separati dal separatore dei livelli di classificazione valido per il soggetto produttore/AOO)
383        			ListaPrivilegiIn			IN		VARCHAR2 DEFAULT NULL,				-- Indica i privilegi (se più di uno separati da ;) da aggiungere sugli oggetti di definizione contesto presenti nella lista XML (non va specificato nulla nel caso di oggetti, per esempio certe funzioni, in cui l'oggetto e il destinatario già definiscono il privilegio)
384        																	-- Valori possibili:
385        																	-- 	FC	=	Full control
386        																	--	I	=	Inserimento (e anche modifica)
387        																	--	M	=	Modifica
388        																	--	A	=	ad Assegnare/Avviare/registrare/creare
389        																	--	F	=	a Firmare
390        																	--	AF	=	ad Aprire Fascicoli
391        																	--	SP	=	relativamente agli archivi di tutto il soggetto produttore
392        																	--	eSP	=	relativamente agli archivi di tutti i soggetti produttori in banca dati
393        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
394        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
395        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
396        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
397        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
398        			ErrMsgOut				OUT 		VARCHAR2						-- Messaggio d'errore
399        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine (senza warning), altrimenti 0 (in caso di errore o warning)
400        
401        	/******* Funzione per togliere ad un dato destinatario (Soggetto Produttore/AOO/UO/scrivania/utente/profilo/ruolo/gruppo di privilegi)  	*******/
402        	/******* privilegi su un dato oggetto di definizione del contesto organizzativo,archivistico e procedurale 						*******/
403        	/******* ATTENZIONE: se i privilegi non erano già dati non viene dato errore											*******/
404        	function RevokePrivSuOggDefContesto(
405        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
406        																	-- (obblig). Codice identificativo del token di connessione
407        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
408        			FlgTpObjPrivOnIn			IN		VARCHAR2,						-- (obblig.) Indica il tipo di oggetto su cui si esercitano i privilegi da togliere
409        																	-- Valori ammessi:
410        																	--	F	=	Funzionalità del sistema;
411        																	--	TP	=	Tipo di processo/procedimento;
412        																	--	TD	=	Tipo di documento;
413        																	--	TF	=	Tipo di folder;
414        																	--	C	=	Classificazione;
415        																	--	TR	=	Tipo di registrazione (protocollo o repertorio o altro);
416        																	--	MR	=	Modello di registrazione
417        			CIObjPrivOnIn			IN		DMT_PRIVILEGI.CI_OGG_PRIVILEGIO%type,	-- (obblig.) Codice identificativo dell'oggetto su cui si esercitano i privilegi da togliere (se funzione è la stringa restituita dalla function dmpk_utility.GetCodFunz per quella funzione, se tipo di registrazione è il suo ID_TP_REGISTRAZIONE, non la categoria e sigla)
418        			DesObjPrivOnIn			IN		VARCHAR2 DEFAULT NULL,				-- Descrizione/denominazione dell'oggetto su cui si esercitano i privilegi da togliere (ricerca case insensitive in like)
419        			LivelliClassifPrivOnIn		IN		VARCHAR2 DEFAULT NULL,				-- (da valorizzare solo se FlgTpObjPrivOnIn=C) Stringa con i n.ri livello della classificazione su cui si esercitano i privilegi da togliere (tutti o solo alcuni; però se si specifica un livello è obbligatorio indicare tutti i livelli superiori; vanno indicati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; vanno separati dal separatore dei livelli di classificazione valido per il soggetto produttore/AOO)
420        			FlgTpObjPrivToIn			IN		VARCHAR2,						-- (obblig.) Indica il tipo di destinatario a cui togliere privilegi
421        																	-- Valori ammessi:
422        																	-- 	SA	=	Soggetto produttore/AOO
423        																	--	UO	=	U.O.
424        																	-- 	SV	=	Scrivania virtuale
425        																	--	UT	=	Utente
426        																	--	PR	=	Profilo
427        																	--	GP	=	Gruppo di privilegi
428        																	--	RA	=	Ruolo amministrativo (consentito solo se si assegna abilitazione a funzione, ovvero se FlgTpObjPrivOnIn=F)
429        			IdObjPrivToIn			IN		INTEGER DEFAULT NULL,				-- Identificativo (ID_SP_AOO o ID_UO o ID_SCRIVANIA o ID_USER o ID_PROFILO o ID_GRUPPO_PRIV o ID_RUOLO_AMM) del destinatario del privilegio da togliere
430        			DesObjPrivToIn			IN		VARCHAR2 DEFAULT NULL,				-- Descrizione/denominazione del destinatario dei privilegi da togliere(ricerca case insensitive in like)
431        			LivelliUOPrivToIn			IN		VARCHAR2 DEFAULT NULL,				-- (da valorizzare solo se FlgTpObjPrivToIn=UO o SV) Stringa con i n.ri livello della UO destinataria o a cui appartiene la scrivania destinataria (tutti o alcuni; però se si specifica un livello è obbligatorio indicare tutti i livelli superiori; vanno specificati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; sono separati dal separatore dei livelli valido per il soggetto produttore/AOO di appartenenza della UO)
432        			DesUOAppScrivaniaToIn		IN		VARCHAR2 DEFAULT NULL,				-- (da valorizzare solo se FlgTpObjPrivToIn=SV) Denominazione della UO in cui si trova la scrivania destinataria (o suo inizio; ricerca case insensitive in like). Può essere quella semplice o la concatenazione con separatore "|" delle denominazioni delle UO superiori + quella della UO
433        			DesUserScrivaniaToIn		IN		VARCHAR2 DEFAULT NULL,				-- (da valorizzare solo se FlgTpObjPrivToIn=SV) Denominazione dell'utente che occupa la scrivania destinataria (ricerca case insensitive in like).
434        			ListaPrivilegiIn			IN		VARCHAR2 DEFAULT NULL,				-- Indica i privilegi (se più di uno separati da ;) da togliere.
435        																	-- ATTENZIONE: Se nulla è specificato si intende che al destinatario va tolto qualsiasi privilegio sul dato oggetto
436        																	-- Valori possibili:
437        																	--	I	=	Inserimento
438        																	--	M	=	Modifica
439        																	-- 	C	=	Cancellazione
440        																	--	A	=	ad Assegnare/Avviare/registrare/creare
441        																	--	F	=	a Firmare
442        																	--	AF	=	ad Aprire Fascicoli
443        																	--	SP	=	relativamente agli archivi di tutto il soggetto produttore
444        																	--	eSP	=	relativamente agli archivi di tutti i soggetti produttori in banca dati
445        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
446        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
447        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
448        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
449        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
450        			ErrMsgOut				OUT 		VARCHAR2						-- Messaggio d'errore
451        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine (senza warning), altrimenti 0 (in caso di errore o warning)
452        
453        	/******* Funzione per togliere ad un dato destinatario (Soggetto Produttore/AOO/UO/scrivania/utente/profilo/ruolo/gruppo di privilegi)  	*******/
454        	/******* privilegi su oggetti di definizione del contesto organizzativo,archivistico e procedurale o gruppi di privilegi			*******/
455        	/******* ATTENZIONE: se i privilegi non erano già dati non viene dato errore											*******/
456        	function RevokePrivSuDefContesto(
457        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
458        																	-- (obblig). Codice identificativo del token di connessione
459        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
460        			FlgTpObjPrivToIn			IN		VARCHAR2,						-- (obblig.) Indica il tipo di destinatario a cui togliere privilegi
461        																	-- Valori ammessi:
462        																	-- 	SA	=	Soggetto produttore/AOO
463        																	--	UO	=	U.O.
464        																	-- 	SV	=	Scrivania virtuale
465        																	--	UT	=	Utente
466        																	--	PR	=	Profilo
467        																	--	GP	=	Gruppo di privilegi
468        																	--	RA	=	Ruolo amministrativo (consentito solo se si assegna abilitazione a funzione, ovvero se FlgTpObjPrivOnIn=F)
469        			IdObjPrivToIn			IN		INTEGER DEFAULT NULL,				-- Identificativo (ID_SP_AOO o ID_UO o ID_SCRIVANIA o ID_USER o ID_PROFILO o ID_GRUPPO_PRIV o ID_RUOLO_AMM) del destinatario del privilegio da togliere
470        			DesObjPrivToIn			IN		VARCHAR2 DEFAULT NULL,				-- Descrizione/denominazione del destinatario dei privilegi da togliere(ricerca case insensitive in like)
471        			LivelliUOPrivToIn			IN		VARCHAR2 DEFAULT NULL,				-- (da valorizzare solo se FlgTpObjPrivToIn=UO o SV) Stringa con i n.ri livello della UO destinataria o a cui appartiene la scrivania destinataria (tutti o alcuni; però se si specifica un livello è obbligatorio indicare tutti i livelli superiori; vanno specificati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; sono separati dal separatore dei livelli valido per il soggetto produttore/AOO di appartenenza della UO)
472        			DesUOAppScrivaniaToIn		IN		VARCHAR2 DEFAULT NULL,				-- (da valorizzare solo se FlgTpObjPrivToIn=SV) Denominazione della UO in cui si trova la scrivania destinataria (o suo inizio; ricerca case insensitive in like). Può essere quella semplice o la concatenazione con separatore "|" delle denominazioni delle UO superiori + quella della UO
473        			DesUserScrivaniaToIn		IN		VARCHAR2 DEFAULT NULL,				-- (da valorizzare solo se FlgTpObjPrivToIn=SV) Denominazione dell'utente che occupa la scrivania destinataria (ricerca case insensitive in like).
474        			ListaObjToRevokeXMLIn		IN		CLOB,							-- Lista con gli estremi degli oggetti di definizione contesto da cui togliere privilegi e/o dei gruppi di privilegi da togliere (XML conforme a schema LISTA_STD.xsd)
475        																	-- Ogni tag "Riga" rappresenta un oggetto di definizione del contesto da cui togliere privilegi o un gruppo di privilegi e può contenere le seguenti colonne:
476        																	-- 1: (obblig.) Indica il tipo di oggetto rappresentato dalla riga
477        																		-- Valori ammessi:
478        																		--	F	=	Privilegi su Funzionalità del sistema;
479        																		--	TP	=	Privilegi su Tipo di processo/procedimento;
480        																		--	TD	=	Privilegi su Tipo di documento;
481        																		--	TF	=	Privilegi su Tipo di folder;
482        																		--	C	=	Privilegi su Classificazione;
483        																		--	TR	=	Privilegi su Tipo di registrazione (protocollo o repertorio o altro);
484        																		--	MR	=	Privilegi su Modello di registrazione
485        																		--	GP	=	Gruppo di privilegi
486        																	-- 2: Codice identificativo dell'oggetto su cui si esercitano i privilegi (se funzione è la stringa restituita dalla function dmpk_utility.GetCodFunz per quella funzione) o del gruppo di privilegi
487        																	-- 3: Descrizione/denominazione dell'oggetto su cui si esercitano i privilegi o del gruppo di privilegi
488        																	-- 4: (valorizzato solo solo se colonna 1=C) Stringa con i n.ri livello della classificazione su cui si esercitano i privilegi (i livelli sono indicati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; sono separati dal separatore dei livelli di classificazione valido per il soggetto produttore/AOO)
489        			ListaPrivilegiIn			IN		VARCHAR2 DEFAULT NULL,				-- Indica i privilegi (se più di uno separati da ;) da togliere.
490        																	-- ATTENZIONE: Se nulla è specificato si intende che al destinatario va tolto qualsiasi privilegio sul dato oggetto o l'intero gruppo di privilegi
491        																	-- Valori possibili:
492        																	--	I	=	Inserimento
493        																	--	M	=	Modifica
494        																	-- 	C	=	Cancellazione
495        																	--	A	=	ad Assegnare/Avviare/registrare/creare
496        																	--	F	=	a Firmare
497        																	--	AF	=	ad Aprire Fascicoli
498        																	--	SP	=	relativamente agli archivi di tutto il soggetto produttore
499        																	--	eSP	=	relativamente agli archivi di tutti i soggetti produttori in banca dati
500        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
501        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
502        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
503        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
504        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
505        			ErrMsgOut				OUT 		VARCHAR2						-- Messaggio d'errore
506        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine (senza warning), altrimenti 0 (in caso di errore o warning)
507        
508        	/****** 	funzione per ricercare sui gruppi di privilegi		*******/
509        	function TrovaGruppiPrivilegi(
510        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
511        																	-- (obblig). Codice identificativo del token di connessione
512        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
513        			FlgPreimpostaFiltroIn		IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1 i filtri e l'ordinamento vengono settati secondo le impostazioni dell'utente di lavoro, altrimenti restano come passati in input
514        			--------------- inizio filtri di ricerca-------------------
515        			IdGruppoPrivIO			IN OUT	DMT_GRUPPI_PRIVILEGI.ID_GRUPPO_PRIV%TYPE ,
516        																	-- 1° filtro di ricerca: identificativo del gruppo di privilegi
517        			NomeGruppoPrivIO			IN OUT	DMT_GRUPPI_PRIVILEGI.NOME_GRUPPO_PRIV%TYPE,
518        																	-- 2° filtro di ricerca: nome del gruppo di privilegi(ricerca case-insensitive in like)
519        			CIProvGruppoPrivIO		IN OUT	DMT_GRUPPI_PRIVILEGI.PROV_CI_GRUPPO%TYPE,	-- 3° filtro di ricerca: codice che identifica il gruppo di privilegi in un eventuale sistema esterno di provenienza (ricerca esatta case-sensitive)
520        			FlgInclAnnullatiIO		IN OUT	INTEGER,						-- (valori 1/0/NULL) 4° filtro di ricerca: se 1 vengono estratti anche i gruppi logicamente annullati, altrimenti no
521        			FlgTpObjPrivOnIO			IN OUT	VARCHAR2,						-- 5° filtro di ricerca: Indica il tipo di oggetto su cui si esercitano privilegi che devono essere inclusi nel gruppo
522        																	-- Valori ammessi:
523        																	--	F	=	Funzionalità del sistema;
524        																	--	TP	=	Tipo di processo/procedimento;
525        																	--	TD	=	Tipo di documento;
526        																	--	TF	=	Tipo di folder;
527        																	--	C	=	Classificazione;
528        																	--	TR	=	Tipo di registrazione (protocollo o repertorio o altro);
529        																	--	MR	=	Modello di registrazione
530        			CIObjPrivOnIO			IN OUT	DMT_PRIVILEGI.CI_OGG_PRIVILEGIO%type,	-- 6° filtro di ricerca: Codice identificativo dell'oggetto su cui si esercitano privilegi che devono essere inclusi nel gruppo (se funzione è la stringa restituita dalla function dmpk_utility.GetCodFunz per quella funzione, se tipo di registrazione è il suo ID_TP_REGISTRAZIONE, non la categoria e sigla)(ricerca esatta)
531        			DesObjPrivOnIO			IN OUT	VARCHAR2,						-- 7° filtro di ricerca: Descrizione/denominazione del/degli oggetti su cui si esercitano privilegi che devono essere inclusi nel gruppo (ricerca case insensitive in like)
532        			LivelliClassifPrivOnIO		IN OUT	VARCHAR2,						-- 8° filtro di ricerca: (da valorizzare solo se FlgTpObjPrivOnIO=C) Stringa con i n.ri livello della/e classificazioni su cui si esercitano privilegi che devono essere inclusi nel gruppo (tutti o solo alcuni livelli; però se si specifica un livello è obbligatorio indicare tutti i livelli superiori; vanno indicati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; vanno separati dal separatore dei livelli di classificazione valido per il soggetto produttore/AOO)
533        			CodApplOwnerIO			IN OUT	VARCHAR2,						-- 9° filtro di ricerca: Codice dell'applicazione "proprietaria" dei gruppi. Se valorizzata pari a #BY_CONN_TKN e si è connessi da un'applicazione esterna si ricercano solo gruppi di cui è proprietaria quell'applicazione
534        			CodIstApplOwnerIO			IN OUT	VARCHAR2,						-- 10° filtro di ricerca: Codice dell'istanza di applicazione "proprietaria" dei gruppi. Se valorizzata pari a #BY_CONN_TKN e si è connessi da un'applicazione esterna si ricercano solo gruppi di cui è proprietaria l'istanza di applicazione esterna da cui si è connessi
535        			FlgRestrApplOwnerIO		IN OUT	INTEGER,						-- (valori 1/0/NULL) Se 1 vengono estratti solo gruppi di cui è proprietaria l'applicazione proprietaria (ed eventuale istanza) specificata in CodApplOwnerIO; se 0 o NULL e se CodApplOwnerIO è valorizzata vengono estratti solo i gruppi senza applicazione proprietaria o con applicazione proprietria pari a quella specificata
536        			------------- inizio argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
537        			ColOrderByIO			IN OUT	VARCHAR2,						-- Indica il/i numeri della/e colonna dell'XML (CLOB ListaXMLOut) di output per cui ordinare i record nell'XML stesso (si può ordinare solo per le colonne da 1 a 5). Se l'ordinamento è per più colonne queste vanno separate con "," (es: 2; 2,3)
538        																	-- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul tipo di ordinamento una qualche preimpostazione di sistema/utente ecc.
539        																	-- se non valorizzato (neppure in output) la lista di record restituita non è ordinata
540        			FlgDescOrderByIO  		IN OUT	VARCHAR2,						-- E' una stringa di 1 o 0/NULL, tanti quanti le colonne di ordinamento, separati da ",": 1 significa che l'ordinamento per la data colonna deve essere discendente anzichè ascendente (es: 1; 1,0; 1, )
541        																	-- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul verso di ordinamento una qualche preimpostazione di sistema/utente ecc.
542        			FlgSenzaPaginazioneIn 		IN 		PLS_INTEGER DEFAULT NULL,            	-- (valori 1/0/NULL) Se 1 l'estrazione non è paginata, altrimenti sì
543        			NroPaginaIO      			IN OUT	PLS_INTEGER,                  		-- E' il numero della pagina da estrarre; se NULL e l'estrazione è paginata viene estratta la prima pagina
544           			BachSizeIO				IN OUT	PLS_INTEGER,					-- Indica il massimo n.ro di record da estrarre se l'estrazione non è paginata (FlgSenzaPaginazioneIn=1)
545        																	-- Indica la dimensione (n.ro di record) della pagina se l'estrazione è paginata (FlgSenzaPaginazioneIn 0 o NULL) e in tal caso se non è valorizzato la dimensione della pagina è quella settata per l'utente di lavoro o è pari al valore del parametro STD_PAGE_NUM_ROW del dominio di lavoro
546        			OverFlowLimitIn			IN		PLS_INTEGER DEFAULT NULL,			-- E' il n.ro di record soddisfacenti la ricerca superato il quale la funzione deve restituire errore di overflow
547        			FlgSenzaTotIn			IN		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 significa che non è richiesto come output il totale dei record soddisfacenti la ricerca (se la ricerca è paginata per la prima pagina il totale viene calcolato comunque, per le successive no)
548        			NroTotRecOut			OUT		PLS_INTEGER,					-- E' il n.ro di record complessivi trovati (valorizzato solo se FlgSenzaTotIn è 0 o NULL o se si estrae la prima pagina)
549             			NroRecInPaginaOut 		OUT   	PLS_INTEGER,                     		-- E' il numero di record nella pagina (valorizzato solo se l'estrazione è paginata, ovvero se FlgSenzaPaginazioneIn 0 o NULL)
550        			------------- fine argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
551        			ListaXMLOut				OUT		NOCOPY CLOB,					-- Lista dei gruppi di privilegi trovati (XML conforme a schema LISTA_STD.xsd)
552        																	-- Ogni gruppo di privilegi è un tag Riga che contiene le seguenti colonne:
553        																	-- 1: Identificativo del gruppo di privilegi
554        																	-- 2: Nome del gruppo di privilegi
555        																	-- 3: Codice che identifica il gruppo di privilegi in un eventuale sistema esterno di provenienza
556        																	-- 4: (valori 1/0) Se 1 si tratta di un gruppo di privilegi riservato di sistema e dunque non modificabile/cancellabile da applicativo
557        																	-- 5: (valori 1/0) Se 1 si tratta di un gruppo di privilegi annullato
558        																	-- 6: Note/dettagli sul gruppo
559        																	-- 7:  Flag che indica che il gruppo è "di proprieà" dell'applicazione CodApplOwnerIO ed eventuale sua istanza CodIstApplOwnerIO
560        																	-- 8:  Descrizione dell'applicazione (ed eventuale istanza) proprietaria del gruppo
561        																	-- 9: Timestamp di creazione del gruppo di privilegi (nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP)
562        																	-- 10: Descrizione dell'utente di creazione del gruppo di privilegi
563        																	-- 11: Timestamp di ultima modifica dei dati del gruppo di privilegi (nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP)
564        																	-- 12: Descrizione dell'utente di ultima modifica dei dati del gruppo di privilegi
565        			FlgAbilInsOut	 		OUT 		PLS_INTEGER ,            			-- (valori 1/0) Se 1 si ha abilitazione a creazione di nuovi gruppo di privilegi
566        			FlgAbilUpdOut 			OUT 		PLS_INTEGER ,            			-- (valori 1/0) Se 1 si ha abilitazione a modifica di gruppo di privilegi
567        			FlgAbilDelOut 			OUT 		PLS_INTEGER,            			-- (valori 1/0) Se 1 si ha abilitazione a cancellazione di gruppo di privilegi
568        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
569        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
570        			ErrMsgOut				OUT 		VARCHAR2,						-- Messaggio d'errore
571        			FlgStatoAssegnIn			IN		PLS_INTEGER default NULL,			-- (valori 1/0/NULL): filtro di ricerca per restringere la ricerca ai soli gruppi di privilegi assegnati (=1) o non assegnati  all'utente/UO/scrivania/profilo ecc specificato nell'argomento IdObjXStatoAssegnIn
572        			FlgTpDestAssegnIn			IN		VARCHAR2 default NULL,				-- (obblig. e gestito solo se FlgStatoAssegnIn è valorizzato) Indica il tipo di chi (utente o UO ecc) deve avere o non avere i gruppi di privilegi da ricercare
573        																	-- Valori ammessi:
574        																	--	UO	=	U.O.
575        																	-- 	SV	=	Scrivania virtuale
576        																	--	UT	=	Utente
577        																	--	PR	=	Profilo
578        			IdDestAssegnIn			IN		INTEGER default NULL,				-- (obblig. e gestito solo se FlgStatoAssegnIn è valorizzato) Identificativo (ID_UO o ID_SCRIVANIA o ID_USER o ID_PROFILO) di chi deve avere o non avere i gruppi di privilegi da ricercare
579        			RigaTagNameIn			IN		VARCHAR2 DEFAULT NULL,				-- (opzionale) Come rinominare il tag Riga dell'XML ListaXMLOut di output
580        			ColTagNameIn			IN		DMVA_STRING DEFAULT NULL			-- (opzionale) Come rinominare i tag delle colonne in alternativa a Colonna Nro=.. nell'XML ListaXMLOut di output
581        			)return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine, altrimenti 0
582        
583        	/*******  funzione per creare o modificare un gruppo di privilegi su oggetti di definizione del contesto organizzativo,archivistico e procedurale  *******/
584        	function IUGruppoPrivilegi(
585        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
586        																	-- (obblig). Codice identificativo del token di connessione
587        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
588        			IdGruppoPrivIO 	  		IN OUT   	DMT_GRUPPI_PRIVILEGI.ID_GRUPPO_PRIV%type, -- Identificativo del gruppo di privilegi da modificare. Se non valorizzato il gruppo di privilegi è da inserire ex-novo
589        																	-- In output, salvo in caso di errore, è sempre valorizzato
590        			NomeGruppoPrivIn			IN		DMT_GRUPPI_PRIVILEGI.NOME_GRUPPO_PRIV%TYPE DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
591        																	-- (obblig.) Nome del gruppo di privilegi
592        			NoteGruppoPrivIn			IN		DMT_GRUPPI_PRIVILEGI.NOTE%TYPE DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
593        																	-- Note/dettagli sul gruppo di privilegi
594        			CIProvGruppoPrivIn		IN 		DMT_GRUPPI_PRIVILEGI.PROV_CI_GRUPPO%TYPE DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
595        																	-- Codice identificativo del gruppo di privilegi nel sistema di provenienza
596        			FlgLockedIn				IN		PLS_INTEGER DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
597        																	-- (valori 1/0/NULL) Indicatore di gruppo di privilegi riservato dal sistema e non modificabile/cancellabile da GUI
598        			FlgModPrivilegiIn			IN		VARCHAR2 DEFAULT 'I',				-- (valori I/C) Indica se i privilegi indicati nell'argomento successivo sono forniti in modo incrementale (=I) (solo quelle da inserire/modificare/cancellare) oppure completo (=C), vale a dire che dovranno soppiantare tutti quelli già appartenenti al gruppo in caso di gruppo di privilegi da aggiornare
599        			XMLPrivilegiIn			IN		CLOB DEFAULT NULL,				-- Lista con i privilegi del gruppo da aggiungere/togliere (XML conforme a schema LISTA_STD.xsd)
600        																	-- Ogni privilegio/set di privilegi su un dato oggetto è un tag "Riga" che può contenere le seguenti colonne:
601        																	-- 1: (obblig.) Indica il tipo di oggetto su cui si esercitano i privilegi da dare/togliere
602        																		-- Valori ammessi:
603        																		--	F	=	Funzionalità del sistema;
604        																		--	TP	=	Tipo di processo/procedimento;
605        																		--	TD	=	Tipo di documento;
606        																		--	TF	=	Tipo di folder;
607        																		--	C	=	Classificazione;
608        																		--	TR	=	Tipo di registrazione (protocollo o repertorio o altro);
609        																		--	MR	=	Modello di registrazione
610        																	-- 2: Codice identificativo dell'oggetto su cui si esercitano i privilegi da dare/togliere (se funzione è la stringa restituita dalla function dmpk_utility.GetCodFunz per quella funzione, se tipo di registrazione è il suo ID_TP_REGISTRAZIONE, non la categoria e sigla)
611        																	-- 3: Descrizione/denominazione dell'oggetto su cui si esercitano i privilegi da dare/togliere (ricerca case insensitive in like)
612        																	-- 4: (da valorizzare solo se colonna 1=C) Stringa con i n.ri livello della classificazione cui si esercitano i privilegi (tutti o solo alcuni i livelli; però se si specifica un livello è obbligatorio indicare tutti i livelli superiori; vanno indicati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; vanno separati dal separatore dei livelli di classificazione valido per il soggetto produttore/AOO)
613        																	-- 5: Indica i privilegi (se più di uno separati da ;) da aggiungere/togliere sull'oggetto (può non essere specificato nulla nel caso di oggetti, per esempio certe funzioni, in cui l'oggetto già definisce il privilegio)
614        																		-- Valori possibili:
615        																		-- 	FC	=	Full control (solo come privilegio da aggiungere)
616        																		--	I	=	Inserimento (e anche modifica)
617        																		--	M	=	Modifica
618        																		--	C	=	Cancellazione (solo come privilegio da togliere)
619        																		--	A	=	ad Assegnare/Avviare/registrare/creare
620        																		--	F	=	a Firmare
621        																		--	AF	=	ad Aprire Fascicoli
622        																		--	SP	=	relativamente agli archivi di tutto il soggetto produttore
623        																		--	eSP	=	relativamente agli archivi di tutti i soggetti produttori in banca dati
624        																	-- 6: (valori 1/0/NULL) Se 1 indica che il/i privilegi del record sono da togliere (anzichè da aggiungere)
625        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
626        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
627        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
628        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
629        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
630        			ErrMsgOut				OUT 		VARCHAR2						-- Messaggio d'errore
631        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine (senza warning), altrimenti 0 (in caso di errore o warning)
632        
633        
634        	/*** Funzione di eliminazione di un gruppo di privilegi							***/
635        	/*** Si può specificare se l'eliminazione deve essere fisica o solo logica (annullamento)		***/
636        	/*** Se non lo si specifica il sistema fa quella fisica se possibile, se no quella logica		***/
637        	function DGruppoPrivilegi(
638        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
639        																	-- (obblig). Codice identificativo del token di connessione
640        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
641        			IdGruppoPrivIn			IN		DMT_GRUPPI_PRIVILEGI.ID_GRUPPO_PRIV%type, -- (obblig. se NomeGruppoPrivIn è nullo) Identificativo del gruppo di privilegi da cancellare
642        			NomeGruppoPrivIn			IN		DMT_GRUPPI_PRIVILEGI.NOME_GRUPPO_PRIV%type, -- (obblig. se IdGruppoPrivIn è nullo) Nome del gruppo di privilegi da cancellare (ricerca case-insensitive in like senza forzare % finale)
643        			FlgCancFisicaIn			IN		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL): Se 1 si richiede la cancellazione fisica; se 0 l'annullamento logico; se non è valorizzato quella possibile delle 2.
644        			MotiviIn				IN		DMT_ACTIVITIES.NOTE%type DEFAULT NULL,	-- Motivi della cancellazione/annullamento
645        			FlgIgnoreWarningIn 		IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 0 o NULL significa che in presenza di WARNING la stored si comporta come in caso di errore; se 1 gli WARNING vengono ignorati
646        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
647        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
648        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
649        			WarningMsgOut			OUT		VARCHAR2,						-- Messaggio di warning (valorizzato solo se non c'è errore)
650        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
651        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
652        			ErrMsgOut				OUT 		VARCHAR2						-- Messaggio d'errore
653        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine (senza warning), altrimenti 0 (in caso di errore o warning)
654        
655        
656        	/*******  funzione per ottenere i dati di dettaglio di un gruppo di privilegi *******/
657        	function LoadDettGruppoPrivilegi(
658        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
659        																	-- (obblig). Codice identificativo del token di connessione
660        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
661        			IdGruppoPrivIO			IN OUT	DMT_GRUPPI_PRIVILEGI.ID_GRUPPO_PRIV%type,	-- (obblig se NomeGruppoPrivIO non è valorizzato) Id. del gruppo
662        																	-- in output, salvo in caso di errore, è sempre valorizzato
663        			NomeGruppoPrivIO			IN OUT	DMT_GRUPPI_PRIVILEGI.NOME_GRUPPO_PRIV%type,-- (obblig se IdGruppoPrivIO non è valorizzato in input) Nome del gruppo (ricerca case-insensitive in like senza forzare il % finale)
664        																	-- in output, salvo in caso di errore, è sempre valorizzato
665        			NoteGruppoPrivOut			OUT		DMT_GRUPPI_PRIVILEGI.NOTE%TYPE,		-- Note/dettagli sul gruppo di privilegi
666        			CIProvGruppoPrivOut		OUT 		DMT_GRUPPI_PRIVILEGI.PROV_CI_GRUPPO%TYPE,	-- Codice identificativo del gruppo di privilegi nel sistema di provenienza
667        			FlgLockedOut			OUT		PLS_INTEGER,					-- (valori 1/0) Indicatore di gruppo di privilegi riservato dal sistema e non modificabile/cancellabile da GUI
668        			FlgNoListaPrivsIn			IN		PLS_INTEGER,					-- (valori 1/0/NULL) Se 1 la lista dei privilegi contenuti non viene estratta, altrimenti sì
669        			XMLPrivilegiOut			OUT		NOCOPY CLOB,					-- Lista con i privilegi contenuti nel gruppo(XML conforme a schema LISTA_STD.xsd)
670        																	-- Ogni privilegio/set di privilegi su un dato oggetto è un tag "Riga" che contiene le seguenti colonne:
671        																	-- 1: (obblig.) Indica il tipo di oggetto su cui si esercitano i privilegi
672        																		-- Valori ammessi:
673        																		--	F	=	Funzionalità del sistema;
674        																		--	TP	=	Tipo di processo/procedimento;
675        																		--	TD	=	Tipo di documento;
676        																		--	TF	=	Tipo di folder;
677        																		--	C	=	Classificazione;
678        																		--	TR	=	Tipo di registrazione (protocollo o repertorio o altro);
679        																		--	MR	=	Modello di registrazione
680        																	-- 2: Codice identificativo dell'oggetto su cui si esercitano i privilegi (se funzione è la stringa restituita dalla function dmpk_utility.GetCodFunz per quella funzione, se tipo di registrazione è il suo ID_TP_REGISTRAZIONE, non la categoria e sigla)
681        																	-- 3: Descrizione/denominazione dell'oggetto su cui si esercitano i privilegi da dare/togliere
682        																	-- 4: (valorizzato solo solo se colonna 1=C) Stringa con i n.ri livello della classificazione cui si esercitano i privilegi (i livelli sono indicati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; sono separati dal separatore dei livelli di classificazione valido per il soggetto produttore/AOO)
683        																	-- 5: Indica i privilegi (se più di uno separati da ;) sull'oggetto (può non essere specificato nulla nel caso di oggetti, per esempio certe funzioni, in cui l'oggetto già definisce il privilegio)
684        																		-- Valori possibili:
685        																		-- 	FC	=	Full control (solo come privilegio da aggiungere)
686        																		--	I	=	Inserimento (e anche modifica)
687        																		--	M	=	Modifica
688        																		--	A	=	ad Assegnare/Avviare/registrare/creare
689        																		--	F	=	a Firmare
690        																		--	AF	=	ad Aprire Fascicoli
691        																		--	SP	=	relativamente agli archivi di tutto il soggetto produttore
692        																		--	eSP	=	relativamente agli archivi di tutti i soggetti produttori in banca dati
693        																	-- 6: Descrizione dei privilegi sull'oggetto (è la decodifica della colonna 5)
694        			BachSizeOut				OUT		PLS_INTEGER,					-- Indica il massimo n.ro di record per ogni pagina da mostrare nella lista dei privilegi
695        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
696        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
697        			ErrMsgOut				OUT 		VARCHAR2						-- Messaggio d'errore
698        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine (senza warning), altrimenti 0 (in caso di errore o warning)
699        
700        	/******* Funzione per ricercare i privilegi e/o gruppi di privilegi su oggetti di definizione del contesto organizzativo,archivistico e procedurale 		******/
701        	/******* che sono dati ad un dato destinatario (Soggetto Produttore/AOO/UO/scrivania/utente/profilo/ruolo/gruppo di privilegi)  					******/
702        	/******* si possono ricercare sia i privilegi/gruppi di privilegi dati anche indirettamente che solo quelli dati direttamente al destinatario indicato	******/
703        	function TrovaPrivSuOggDefContestoPer(
704        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
705        																	-- (obblig). Codice identificativo del token di connessione
706        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
707        			FlgPreimpostaFiltroIn		IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1 i filtri e l'ordinamento vengono settati secondo le impostazioni dell'utente di lavoro, altrimenti restano come passati in input
708        			FlgTpObjPrivToIn			IN		VARCHAR2,						-- (obblig.): Indica il tipo di destinatario dei privilegi e gruppi di privilegi da ricercare
709        																	-- Valori ammessi:
710        																	-- 	SA	=	Soggetto produttore/AOO
711        																	--	UO	=	U.O.
712        																	-- 	SV	=	Scrivania virtuale
713        																	--	UT	=	Utente
714        																	--	PR	=	Profilo
715        																	--	GP	=	Gruppo di privilegi
716        																	--	RA	=	Ruolo amministrativo (consentito solo se si assegna abilitazione a funzione, ovvero se FlgTpObjPrivOnIn=F)
717        			IdObjPrivToIn			IN		INTEGER DEFAULT NULL,				-- Identificativo (ID_SP_AOO o ID_UO o ID_SCRIVANIA o ID_USER o ID_PROFILO o ID_GRUPPO_PRIV o ID_RUOLO_AMM) del destinatario dei privilegi
718        			DesObjPrivToIn			IN		VARCHAR2 DEFAULT NULL,				-- Descrizione/denominazione del destinatario dei privilegi (ricerca case insensitive in like)
719        			LivelliUOPrivToIn			IN		VARCHAR2 DEFAULT NULL,				-- (da valorizzare solo se FlgTpObjPrivToIn=UO o SV) Stringa con i n.ri livello della UO destinataria o a cui appartiene la scrivania destinataria (tutti o alcuni; però se si specifica un livello è obbligatorio indicare tutti i livelli superiori; vanno specificati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; sono separati dal separatore dei livelli valido per il soggetto produttore/AOO di appartenenza della UO)
720        			DesUOAppScrivaniaToIn		IN		VARCHAR2 DEFAULT NULL,				-- (da valorizzare solo se FlgTpObjPrivToIn=SV) Denominazione della UO in cui si trova la scrivania destinataria (o suo inizio; ricerca case insensitive in like). Può essere quella semplice o la concatenazione con separatore "|" delle denominazioni delle UO superiori + quella della UO
721        			DesUserScrivaniaToIn		IN		VARCHAR2 DEFAULT NULL,				-- (da valorizzare solo se FlgTpObjPrivToIn=SV) Denominazione dell'utente che occupa la scrivania destinataria (ricerca case insensitive in like).
722        			--------------- inizio filtri di ricerca-------------------
723        			FlgTpObjPrivOnIn			IN		VARCHAR2,						-- 1° filtro di ricerca: Indica il tipo degli oggetti da cercare
724        																	-- Valori ammessi:
725        																	--	F	=	Privilegi su Funzionalità del sistema;
726        																	--	TP	=	Privilegi su Tipo di processo/procedimento;
727        																	--	TD	=	Privilegi su Tipo di documento;
728        																	--	TF	=	Privilegi su Tipo di folder;
729        																	--	C	=	Privilegi su Classificazione;
730        																	--	TR	=	Privilegi su Tipo di registrazione (protocollo o repertorio o altro);
731        																	--	MR	=	Privilegi su Modello di registrazione
732        																	--	GP	=	Gruppo di privilegi
733        																	-- può essere anche una lista di più valori tra quelli sopraelencati, separati da ;
734        			FlgSoloPrivilegiDirettiIn	IN		PLS_INTEGER DEFAULT NULL,			-- 2° filtro di ricerca (valori 1/0/NULL): Se 1 indica che si devono ricercare solo i privilegi e/o gruppi di privilegi dati direttamente al destinatario (non derivati ad esempio dalla sua appartenenza a gruppi o UO o i privilegi singoli derivati da gruppi di privilegi ecc)
735        			FlgTpPrivilegioIn			IN		VARCHAR2 DEFAULT NULL,				-- 3° filtro di ricerca: Indica il tipo dei privilegi singoli da cercare
736        																		-- Valori possibili:
737        																		-- 	FC	=	Full control (solo come privilegio da aggiungere)
738        																		--	I	=	Inserimento (e anche modifica)
739        																		--	M	=	Modifica
740        																		--	C	=	Cancellazione (solo come privilegio da togliere)
741        																		--	A	=	ad Assegnare/Avviare/registrare/creare
742        																		--	F	=	a Firmare
743        																		--	AF	=	ad Aprire Fascicoli
744        																		--	SP	=	relativamente agli archivi di tutto il soggetto produttore
745        																		--	eSP	=	relativamente agli archivi di tutti i soggetti produttori in banca dati
746        			------------- inizio argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
747        			ColOrderByIO			IN OUT	VARCHAR2,						-- Indica il/i numeri della/e colonna dell'XML (CLOB ListaXMLOut) di output per cui ordinare i record nell'XML stesso (si può ordinare solo per le colonne da 1 a 4). Se l'ordinamento è per più colonne queste vanno separate con "," (es: 2; 2,3)
748        																	-- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul tipo di ordinamento una qualche preimpostazione di sistema/utente ecc.
749        																	-- se non valorizzato (neppure in output) la lista di record restituita non è ordinata
750        			FlgDescOrderByIO  		IN OUT	VARCHAR2,						-- E' una stringa di 1 o 0/NULL, tanti quanti le colonne di ordinamento, separati da ",": 1 significa che l'ordinamento per la data colonna deve essere discendente anzichè ascendente (es: 1; 1,0; 1, )
751        																	-- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul verso di ordinamento una qualche preimpostazione di sistema/utente ecc.
752        			FlgSenzaPaginazioneIn 		IN 		PLS_INTEGER DEFAULT NULL,            	-- (valori 1/0/NULL) Se 1 l'estrazione non è paginata, altrimenti sì
753        			NroPaginaIO      			IN OUT	PLS_INTEGER,                  		-- E' il numero della pagina da estrarre; se NULL e l'estrazione è paginata viene estratta la prima pagina
754           			BachSizeIO				IN OUT	PLS_INTEGER,					-- Indica il massimo n.ro di record da estrarre se l'estrazione non è paginata (FlgSenzaPaginazioneIn=1)
755        																	-- Indica la dimensione (n.ro di record) della pagina se l'estrazione è paginata (FlgSenzaPaginazioneIn 0 o NULL) e in tal caso se non è valorizzato la dimensione della pagina è quella settata per l'utente di lavoro o è pari al valore del parametro STD_PAGE_NUM_ROW del dominio di lavoro
756        			OverFlowLimitIn			IN		PLS_INTEGER DEFAULT NULL,			-- E' il n.ro di record soddisfacenti la ricerca superato il quale la funzione deve restituire errore di overflow
757        			FlgSenzaTotIn			IN		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 significa che non è richiesto come output il totale dei record soddisfacenti la ricerca (se la ricerca è paginata per la prima pagina il totale viene calcolato comunque, per le successive no)
758        			NroTotRecOut			OUT		PLS_INTEGER,					-- E' il n.ro di record complessivi trovati (valorizzato solo se FlgSenzaTotIn è 0 o NULL o se si estrae la prima pagina)
759             			NroRecInPaginaOut 		OUT   	PLS_INTEGER,                     		-- E' il numero di record nella pagina (valorizzato solo se l'estrazione è paginata, ovvero se FlgSenzaPaginazioneIn 0 o NULL)
760        			------------- fine argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
761        			ListaXMLOut				OUT		NOCOPY CLOB,					-- Lista con i privilegi e/o gruppi di privilegi trovati, o meglio, per i privilegi singoli, con gli oggetti su cui insistono i privilegi trovati.
762        																	-- Ogni privilegio su un dato oggetto o gruppi di privilegi è un tag "Riga" che contiene le seguenti colonne:
763        																	-- 1: (obblig.) Indica il tipo di oggetto rappresentato dalla riga
764        																		-- Valori ammessi:
765        																		--	F	=	Privilegi su Funzionalità del sistema;
766        																		--	TP	=	Privilegi su Tipo di processo/procedimento;
767        																		--	TD	=	Privilegi su Tipo di documento;
768        																		--	TF	=	Privilegi su Tipo di folder;
769        																		--	C	=	Privilegi su Classificazione;
770        																		--	TR	=	Privilegi su Tipo di registrazione (protocollo o repertorio o altro);
771        																		--	MR	=	Privilegi su Modello di registrazione
772        																		--	GP	=	Gruppo di privilegi
773        																	-- 2: Codice identificativo dell'oggetto su cui si esercitano i privilegi (se funzione è la stringa restituita dalla function dmpk_utility.GetCodFunz per quella funzione) o del gruppo di privilegi
774        																	-- 3: Descrizione/denominazione dell'oggetto su cui si esercitano i privilegi o del gruppo di privilegi
775        																	-- 4: (valorizzato solo solo se colonna 1=C) Stringa con i n.ri livello della classificazione cui si esercitano i privilegi (i livelli sono indicati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; sono separati dal separatore dei livelli di classificazione valido per il soggetto produttore/AOO)
776        																	-- 5: (valorizzata solo se FlgSoloPrivilegiDirettiIn=1) Indica i privilegi (se più di uno separati da ;) sull'oggetto (può non essere specificato nulla nel caso di oggetti, per esempio certe funzioni, in cui l'oggetto già definisce il privilegio)
777        																		-- Valori possibili:
778        																		-- 	FC	=	Full control (solo come privilegio da aggiungere)
779        																		--	I	=	Inserimento (e anche modifica)
780        																		--	M	=	Modifica
781        																		--	A	=	ad Assegnare/Avviare/registrare/creare
782        																		--	F	=	a Firmare
783        																		--	AF	=	ad Aprire Fascicoli
784        																		--	SP	=	relativamente agli archivi di tutto il soggetto produttore
785        																		--	eSP	=	relativamente agli archivi di tutti i soggetti produttori in banca dati
786        																	-- 6: (valorizzata solo se FlgSoloPrivilegiDirettiIn=1) Descrizione dei privilegi sull'oggetto (è la decodifica della colonna 5)
787        																	-- 7: (valorizzata solo se FlgSoloPrivilegiDirettiIn=1) (valori 1/0) Se 1 indica che il privilegio è dato al profilo anzichè direttamente all'utente/UO/scrivania
788        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
789        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
790        			ErrMsgOut				OUT 		VARCHAR2,						-- Messaggio d'errore
791        			RigaTagNameIn			IN		VARCHAR2 DEFAULT NULL,				-- (opzionale) Come rinominare il tag Riga dell'XML ListaXMLOut di output
792        			ColTagNameIn			IN		DMVA_STRING DEFAULT NULL)			-- (opzionale) Come rinominare i tag delle colonne in alternativa a Colonna Nro=.. nell'XML ListaXMLOut di output
793        			return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine, altrimenti 0
794        
795        	/********* funzione per profilare o aggiornare la profilatura (ovvero profilo e gruppi di privilegi assegnati) di un dato utente, scrivania virtuale o UO 	*******/
796        	/********* se si tratta di un utente la profilatura viene fatta/aggiornata nel dominio a cui si è connessi									*******/
797        	/********* Nota: il profilo contiene sia informazioni di abilitazione che in generale di caratterizzazione									*******/
798        	function Profila(
799        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
800        																	-- (obblig). Codice identificativo del token di connessione
801        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
802        			FlgTpSoggDaProfilareIn		IN		VARCHAR2,						-- (obblig.) Indica il tipo di soggetto da profilare/di cui aggiornare il profilo
803        																	-- Valori ammessi:
804        																	--	UO	=	U.O.
805        																	-- 	SV	=	Scrivania virtuale
806        																	--	UT	=	Utente
807        			IdSoggettoDaProfilareIn		IN		INTEGER,						-- (obblig.) Identificativo (ID_UO o ID_SCRIVANIA o ID_USER) del soggetto da profilare/di cui aggiornare il profilo
808        			IdProfiloIn				IN		DMT_PROFILI.ID_PROFILO%type DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
809        																	-- Id. del profilo di DMT_PROFILI (uno di quelli che hanno un nome) da assegnare
810        			NomeProfiloIn			IN		DMT_PROFILI.NOME_PROFILO%type DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
811        																	-- Nome del profilo di DMT_PROFILI da assegnare (ricerca case-insensitive in like)
812        			XMLDatiProfiloIn			IN		CLOB DEFAULT NULL,				-- XML (conforme a schema SezioneCache.xsd) che contiene tutti gli attributi del profilo (tranne i gruppi di provilegi) da settare/aggiornare
813        																	-- ATTENZIONE: Si intende che gli attributi corrispondenti a tag non presenti restino invariati
814        																	-- Nell'XML possono esserci tag corrispondenti ad attributi di profilatura solo se non si è specificato un profilo predefinito con i due argomenti IdProfiloIn e/o NomeProfiloIn
815        			FlgModGruppiPrivIn		IN		VARCHAR2 DEFAULT 'I',				-- (valori I/C) Indica se i gruppi di privilegi indicati nell'argomento successivo sono forniti in modo incrementale (=I) (solo quelle da inserire/cancellare) oppure completo (=C), vale a dire che dovranno soppiantare tutti quelli già associati al soggetto di cui aggiornare la profilatura
816        			XMLGruppiPrivIn			IN		CLOB DEFAULT NULL,				-- Lista con i gruppi di privilegi assegnati/da assegnare direttamente (ovvero non tramite profilo) al soggetto (XML conforme a schema LISTA_STD.xsd)
817        																	-- Ogni gruppo è un tag "Riga" che può contenere le seguenti colonne:
818        																	-- 1: Identificativo del gruppo di privilegi
819        																	-- 2: Nome del gruppo di privilegi (ricerca case insesnsitive in like)
820        																	-- 3: (valori 1/0/NULL) Flag di gruppo da eliminare
821        			FlgIgnoreWarningIn 		IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 0 o NULL significa che in presenza di WARNING la stored si comporta come in caso di errore; se 1 gli WARNING vengono ignorati
822        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
823        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
824        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
825        			WarningMsgOut			OUT		VARCHAR2,						-- Messaggio di warning (valorizzato solo se non c'è errore)
826        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
827        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
828        			ErrMsgOut				OUT 		VARCHAR2						-- Messaggio d'errore
829        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine (senza warning), altrimenti 0 (in caso di errore o warning)
830        
831        	/************* funzione per creare o aggiornare un profilo della DMT_PROFILI, sia un profilo con nome, ovvero associabile a più soggetti, sia quello di uno specifico soggetto (anche senza nome) ******/
832        	function IUProfilo(
833        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
834        																	-- (obblig). Codice identificativo del token di connessione
835        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
836        			IdProfiloIO				IN OUT	DMT_PROFILI.ID_PROFILO%type,			-- Id. del profilo di DMT_PROFILI da aggiornare
837        																	-- Se NULL si intende che il profilo sia da creare
838        																	-- In output, salvo in caso di errore, è sempre valorizzato
839        			NomeProfiloIn			IN		DMT_PROFILI.NOME_PROFILO%type DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
840        																	-- Nome del profilo
841        			XMLDatiProfiloIn			IN		CLOB DEFAULT NULL,	-- XML (conforme a schema SezioneCache.xsd) che contiene tutti gli attributi del profilo (tranne i gruppi di provilegi) da settare/aggiornare
842        																	-- Contiene le variabili:
843        																	-- LivMaxRiservatezza: massimo livello di riservatezza a cui si è abilitati
844        																	-- FlgVisibTuttiRiservati: (valori 1/0) Se 1 indica che si è abilitati a vedere in chiaro tutti i documenti e fascicoli riservati (se ACL e altre caratteristiche del documento/fascicolo oltre la riservatezza lo consentono)
845        																	-- AccessoDocIndipACL: (valori FC/V/NULL) Se FC significa che si ha accesso full-control ai documenti indipendentemente dalla loro ACL, se V che si ha accesso in sola visualizzazione ai documenti indipendentemente dalla loro ACL
846        																	-- AccessoFolderIndipACL: (valori FC/V/NULL) Se FC significa che si ha accesso full-control ai fascicoli/folder indipendentemente dalla loro ACL, se V che si ha accesso in sola visualizzazione ai folder indipendentemente dalla loro ACL
847        																	-- AccessoWorkspaceIndipACL: (valori FC/V/NULL) Se FC significa che si ha accesso full-control ai workspace indipendentemente dalla loro ACL, se V che si ha accesso in sola visualizzazione ai workspace indipendentemente dalla loro ACL
848        																	-- AccessoDocIndipUserAbil: (valori FC/V/NULL) Se FC significa che si ha accesso full-control ai documenti indipendentemente dalle abilitazioni dell'utente alla tipologia e altre caratterizzazioni del documento, se V che si ha accesso in sola visualizzazione ai documenti indipendentemente dalle loro caratteristiche (tipologia ecc)
849        																	-- AccessoFolderIndipUserAbil: (valori FC/V/NULL) Se FC significa che si ha accesso full-control ai fascicoli/folder indipendentementedalle abilitazioni dell'utente alla tipologia e altre caratterizzazioni del folder (tipo di procedimento collegato ecc), se V che si ha accesso in sola visualizzazione ai folder indipendentemente dalle loro caratteristiche (tipologia ecc)
850        																	-- ATTENZIONE: Si intende che gli attributi corrispondenti a tag non presenti restino invariati
851        			FlgModGruppiPrivIn		IN		VARCHAR2 DEFAULT 'I',				-- (valori I/C) Indica se i gruppi di privilegi indicati nell'argomento successivo sono forniti in modo incrementale (=I) (solo quelle da inserire/cancellare) oppure completo (=C), vale a dire che dovranno soppiantare tutti quelli già associati al profilo
852        			XMLGruppiPrivIn			IN		CLOB DEFAULT NULL,				-- Lista con i gruppi di privilegi assegnati/da assegnare al profilo (XML conforme a schema LISTA_STD.xsd)
853        																	-- Ogni gruppo è un tag "Riga" che può contenere le seguenti colonne:
854        																	-- 1: Identificativo del gruppo di privilegi
855        																	-- 2: Nome del gruppo di privilegi (ricerca case insesnsitive in like)
856        																	-- 3: (valori 1/0/NULL) Flag di gruppo da eliminare
857        			FlgIgnoreWarningIn 		IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 0 o NULL significa che in presenza di WARNING la stored si comporta come in caso di errore; se 1 gli WARNING vengono ignorati
858        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
859        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
860        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
861        			WarningMsgOut			OUT		VARCHAR2,						-- Messaggio di warning (valorizzato solo se non c'è errore)
862        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
863        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
864        			ErrMsgOut				OUT 		VARCHAR2						-- Messaggio d'errore
865        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine (senza warning), altrimenti 0 (in caso di errore o warning)
866        
867        	/*** Funzione di eliminazione di un profilo della DMT_PROFILI									***/
868        	/*** Si può specificare se l'eliminazione deve essere fisica o solo logica (annullamento)		***/
869        	/*** Se non lo si specifica il sistema fa quella fisica se possibile, se no quella logica		***/
870        	function DProfilo(
871        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
872        																	-- (obblig). Codice identificativo del token di connessione
873        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
874        			IdProfiloIn				IN 		DMT_PROFILI.ID_PROFILO%type,			-- (obblig. se NomeProfiloIn non è valorizzato) Id. del profilo di DMT_PROFILI da cancellare/annullare
875        			NomeProfiloIn			IN		DMT_PROFILI.NOME_PROFILO%type,			-- (obblig. se IdProfiloIn non è valorizzato) Nome del profilo di DMT_PROFILI da cancellare/annullare
876        			FlgCancFisicaIn			IN		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL): Se 1 si richiede la cancellazione fisica; se 0 l'annullamento logico; se non è valorizzato quella possibile delle 2.
877        			MotiviIn				IN		DMT_ACTIVITIES.NOTE%type,			-- Motivi della cancellazione/annullamento
878        			FlgIgnoreWarningIn 		IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 0 o NULL significa che in presenza di WARNING la stored si comporta come in caso di errore; se 1 gli WARNING vengono ignorati
879        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
880        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
881        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
882        			WarningMsgOut			OUT		VARCHAR2,						-- Messaggio di warning (valorizzato solo se non c'è errore)
883        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
884        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
885        			ErrMsgOut				OUT 		VARCHAR2						-- Messaggio d'errore
886        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine (senza warning), altrimenti 0 (in caso di errore o warning)
887        
888        	/******* funzione per ottenere i dati di un profilo *******/
889        	function LoadDettProfilo(
890        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
891        																						-- (obblig). Codice identificativo del token di connessione
892        			IdUserLavoroIn				IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
893        			IdProfiloIO					IN OUT	DMT_PROFILI.ID_PROFILO%type,			-- (obblig se NomeProfiloIO non è valorizzato) Id. del profilo
894        																						-- in output, salvo in caso di errore, è sempre valorizzato
895        			NomeProfiloIO				IN OUT	DMT_PROFILI.NOME_PROFILO%type,
896        																						-- (obblig se IdProfiloIO non è valorizzato in input) Nome profilo (ricerca case-insensitive in like senza forzare il % finale)
897        																						-- in output, salvo in caso di errore, è sempre valorizzato
898        			XMLDatiProfiloOut			OUT		NOCOPY CLOB,							-- XML (conforme a schema SezioneCache.xsd) con i dati del profilo (tranne i privilegi)
899        																						-- Contiene le variabili:
900        																						-- LivMaxRiservatezza: massimo livello di riservatezza a cui si è abilitati
901        																						-- FlgVisibTuttiRiservati: (valori 1/0) Se 1 indica che si è abilitati a vedere in chiaro tutti i documenti e fascicoli riservati (se ACL e altre caratteristiche del documento/fascicolo oltre la riservatezza lo consentono)
902        																						-- AccessoDocIndipACL: (valori FC/V/NULL) Se FC significa che si ha accesso full-control ai documenti indipendentemente dalla loro ACL, se V che si ha accesso in sola visualizzazione ai documenti indipendentemente dalla loro ACL
903        																						-- AccessoFolderIndipACL: (valori FC/V/NULL) Se FC significa che si ha accesso full-control ai fascicoli/folder indipendentemente dalla loro ACL, se V che si ha accesso in sola visualizzazione ai folder indipendentemente dalla loro ACL
904        																						-- AccessoWorkspaceIndipACL: (valori FC/V/NULL) Se FC significa che si ha accesso full-control ai workspace indipendentemente dalla loro ACL, se V che si ha accesso in sola visualizzazione ai workspace indipendentemente dalla loro ACL
905        																						-- AccessoDocIndipUserAbil: (valori FC/V/NULL) Se FC significa che si ha accesso full-control ai documenti indipendentemente dalle abilitazioni dell'utente alla tipologia e altre caratterizzazioni del documento, se V che si ha accesso in sola visualizzazione ai documenti indipendentemente dalle loro caratteristiche (tipologia ecc)
906        																						-- AccessoFolderIndipUserAbil: (valori FC/V/NULL) Se FC significa che si ha accesso full-control ai fascicoli/folder indipendentementedalle abilitazioni dell'utente alla tipologia e altre caratterizzazioni del folder (tipo di procedimento collegato ecc), se V che si ha accesso in sola visualizzazione ai folder indipendentemente dalle loro caratteristiche (tipologia ecc)
907        																						-- PresentiPrivSuFunzioni (valori 1/0): Se 1 significa che sono presenti abilitazioni a funzioni
908        			ErrContextOut				OUT		VARCHAR2,								-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
909        			ErrCodeOut					OUT		PLS_INTEGER,							-- N.ro errore di uscita
910        			ErrMsgOut					OUT 	VARCHAR2								-- Messaggio d'errore
911        			) return PLS_INTEGER;														-- Vale 1 se tutto è andato a buon fine (senza warning), altrimenti 0 (in caso di errore o warning)
912        
913        	/**** Funzione per ricercare i gruppi di utenti/UO/scrivanie 													*****/
914        	/**** permette anche di ricercare i gruppi cui appartiene un certo utente/UO/scrivania (anche indirettamete, attraverso gruppi innestati) *****/
915        	FUNCTION TrovaGruppiSoggInt(
916        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
917        																	-- (obblig). Codice identificativo del token di connessione
918        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
919        			FlgPreimpostaFiltroIn		IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1 i filtri e l'ordinamento vengono settati secondo le impostazioni dell'utente di lavoro, altrimenti restano come passati in input
920        			--------------- inizio filtri di ricerca-------------------
921        			IdGruppoIO				IN OUT	DMT_GRUPPI.ID_GRUPPO%type,			-- 1° filtro di ricerca: id. del gruppo da ricercare
922        			NomeIO				IN OUT	DMT_GRUPPI.NOME_GRUPPO%type, 			-- 2° filtro di ricerca: stringa contenuta nel nome del gruppo (ricerca case-insensitive in like)
923        			FlgDiDefInACLIO			IN OUT	PLS_INTEGER,					-- (valori 1/0/NULL) 3° filtro di ricerca: 1 = Solo gruppi che di default sono messi nell'ACL di oggetti della repository; 0 = Solo gruppi che di default NON sono messi nell'ACL di oggetti della repository; NULL = nessun filtro
924        			CIProvGruppoIO			IN OUT	DMT_GRUPPI.PROV_CI_GRUPPO%TYPE,		-- 4° filtro di ricerca: Codice identificativo del gruppo nel sistema di provenienza: ricerca esatta case-sensitive
925        			FlgIncludiNonVldIO 		IN OUT 	INTEGER, 						-- (valori 1/0/NULL) 5° filtro di ricerca: Se 1 indica se si devono estrarre anche i gruppi non validi alla data odierna, altrimenti solo quelli validi
926        			TsVldIO				IN OUT	VARCHAR2,						-- 6° filtro di ricerca: Stinga con il timestamp (nel formato GG/MM/AAAA HH24:MI:SS) a cui devono essere validi i gruppi da estrarre
927        			CodApplOwnerIO			IN OUT	VARCHAR2,						-- 7° filtro di ricerca: Codice dell'applicazione "proprietaria" dei gruppi. Se valorizzata pari a #BY_CONN_TKN e si è connessi da un'applicazione esterna si ricercano solo gruppi di cui è proprietaria quell'applicazione
928        			CodIstApplOwnerIO			IN OUT	VARCHAR2,						-- 8° filtro di ricerca: Codice dell'istanza di applicazione "proprietaria" dei gruppi. Se valorizzata pari a #BY_CONN_TKN e si è connessi da un'applicazione esterna si ricercano solo gruppi di cui è proprietaria l'istanza di applicazione esterna da cui si è connessi
929        			FlgRestrApplOwnerIO		IN OUT	INTEGER,						-- (valori 1/0/NULL) Se 1 vengono estratti solo gruppi di cui è proprietaria l'applicazione proprietaria (ed eventuale istanza) specificata in CodApplOwnerIO; se 0 o NULL e se CodApplOwnerIO è valorizzata vengono estratti solo i gruppi senza applicazione proprietaria o con applicazione proprietria pari a quella specificata
930        			FlgTpObjAppartenenteIO		IN OUT	VARCHAR2,						-- Indica il tipo di soggetto interno che si vuole appartenga al gruppo.
931        																	-- Valori ammessi:
932        																	--	UO	=	U.O.
933        																	-- 	SV	=	Scrivania virtuale
934        																	--	UT	=	Utente
935        																	--	G	=	Gruppo di soggetti interni
936        			IdObjAppartenenteIO		IN OUT	INTEGER,						-- 9° filtro di ricerca: identificativo (ID_UO o ID_SCRIVANIA o ID_USER o ID_GRUPPO) del soggetto interno che deve appartenere ai gruppi da trovare
937        			DesObjAppartenenteIO		IN OUT	VARCHAR2,						-- 10° filtro di ricerca: descrizione/denominazione del soggetto interno che deve appartenere ai gruppi da trovare (ricerca case insensitive in like senza forzare il % finale)
938        			LivelliUOAppartenenteIO		IN OUT	VARCHAR2,						-- 11° filtro di ricerca: (da valorizzare solo se FlgTpObjAppartenenteIO=UO o SV) Stringa con i n.ri livello della UO appartenente ai gruppi da trovare o a cui appartiene la scrivania appartenente ai gruppi da trovare (tutti o alcuni; però se si specifica un livello è obbligatorio indicare tutti i livelli superiori; vanno specificati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; sono separati dal separatore dei livelli valido per il soggetto produttore/AOO di appartenenza della UO)
939        			DesUOAppScrivaniaToIO		IN OUT	VARCHAR2,						-- 12° filtro di ricerca: (da valorizzare solo se FlgTpObjAppartenenteIO=SV) Denominazione della UO in cui si trova la scrivania appartenente ai gruppi da trovare (o suo inizio; ricerca case insensitive in like senza forzare il % finale). Può essere quella semplice o la concatenazione con separatore "|" delle denominazioni delle UO superiori + quella della UO
940        			DesUserScrivaniaToIO		IN OUT	VARCHAR2,						-- 13° filtro di ricerca: (da valorizzare solo se FlgTpObjAppartenenteIO=SV) Denominazione dell'utente che occupa la scrivania appartenente ai gruppi da trovare (ricerca case insensitive in like senza forzare il % finale).
941        			FlgAncheAppartIndirettaIO	IN OUT	PLS_INTEGER,					-- (valori 1/0/NULL) Se 1 vengono trovati anche gruppi a cui il soggetto interno individuato dagli argomenti precedenti appartiene indirettamente (cioè attraverso innestamento di gruppi e gerarchia di UO), altrmenti solo quelli cui appartiene direttamente
942        			AltriCriteriIO			IN OUT 	NOCOPY CLOB,					-- Altri criteri di ricerca sugli attributi addizionali (XML conforme a schema LISTA_STD.xsd). Se più di uno vengono applicati in AND.
943        																	-- Ogni criterio è un tag Riga che può contenere le seguenti colonne:
944        																	--	1) Nome (ATTR_NAME) dell'attributo cui è relativo il criterio
945        																	--	2) (obblig.) Operatore logico. Valori possibili:
946        																	--		"uguale" (ricerca esatta)
947        																	--		"simile a (case-sensitive)" (ricerca case-sensitive in like)
948        																	--		"simile a (case-insensitive)" (ricerca case-insensitive in like e che ignora i caratteri quali spazi, ., ecc)
949        																	--		"maggiore" (se attributo numerico o data)
950        																	--		"maggiore o uguale" (se attributo numerico o data)
951        																	--		"minore" (se attributo numerico o data)
952        																	--		"minore o uguale" (se attributo numerico o data)
953        																	--		"tra" (se attributo numerico o data)
954        																	--		"non valorizzato"
955        																	--		"valorizzato"
956        																	--		"spuntato" (se attributo di tipo casella di spunta)
957        																	--		"non spuntato" (se attributo di tipo casella di spunta)
958        																	--	3) 1° valore di confronto (obblig. e gestito solo se l'operatore non ha uno dei seguenti valori: valorizzato, non valorizzato, spuntato, non spuntato) (se l'attributo è numerico deve avere la virgola come separatore dei decimali, se è di tipo data deve essere in uno dei formato dati dai parametri di conf. FMT_STD_DATA e FMT_STD_TIMESTAMP)
959        																	--	4) 2° valore di confronto (obblig. e gestito solo se l'operatore è "tra") (se l'attributo è numerico deve avere la virgola come separatore dei decimali, se è di tipo data deve essere in uno dei formato dati dai parametri di conf. FMT_STD_DATA e FMT_STD_TIMESTAMP)
960        																	--	5) Label dell''attributo cui è relativo il criterio (se sotto-attributo di complesso <label del complesso> - <label del sotto-attributo>
961        			------------- inizio argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
962        			ColOrderByIO			IN OUT	VARCHAR2,						-- Indica il/i numeri della/e colonna dell'XML (CLOB ListaXMLOut) di output per cui ordinare i record nell'XML stesso (si può ordinare solo per le colonne da 1 a 6). Se l'ordinamento è per più colonne queste vanno separate con "," (es: 2; 2,3)
963        																	-- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul tipo di ordinamento una qualche preimpostazione di sistema/utente ecc.
964        																	-- se non valorizzato (neppure in output) la lista di record restituita non è ordinata
965        			FlgDescOrderByIO  		IN OUT	VARCHAR2,						-- E' una stringa di 1 o 0/NULL, tanti quanti le colonne di ordinamento, separati da ",": 1 significa che l'ordinamento per la data colonna deve essere discendente anzichè ascendente (es: 1; 1,0; 1, )
966        																	-- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul verso di ordinamento una qualche preimpostazione di sistema/utente ecc.
967        			FlgSenzaPaginazioneIn 		IN 		PLS_INTEGER DEFAULT NULL,            	-- (valori 1/0/NULL) Se 1 l'estrazione non è paginata, altrimenti sì
968        			NroPaginaIO      			IN OUT	PLS_INTEGER,                  		-- E' il numero della pagina da estrarre; se NULL e l'estrazione è paginata viene estratta la prima pagina
969           			BachSizeIO				IN OUT	PLS_INTEGER,					-- Indica il massimo n.ro di record da estrarre se l'estrazione non è paginata (FlgSenzaPaginazioneIn=1)
970        																	-- Indica la dimensione (n.ro di record) della pagina se l'estrazione è paginata (FlgSenzaPaginazioneIn 0 o NULL) e in tal caso se non è valorizzato la dimensione della pagina è quella settata per l'utente di lavoro o è pari al valore del parametro STD_PAGE_NUM_ROW del dominio di lavoro
971        			OverFlowLimitIn			IN		PLS_INTEGER DEFAULT NULL,			-- E' il n.ro di record soddisfacenti la ricerca superato il quale la funzione deve restituire errore di overflow
972        			FlgSenzaTotIn			IN		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 significa che non è richiesto come output il totale dei record soddisfacenti la ricerca (se la ricerca è paginata per la prima pagina il totale viene calcolato comunque, per le successive no)
973        			NroTotRecOut			OUT		PLS_INTEGER,					-- E' il n.ro di record complessivi trovati (valorizzato solo se FlgSenzaTotIn è 0 o NULL o se si estrae la prima pagina)
974             			NroRecInPaginaOut 		OUT   	PLS_INTEGER,                     		-- E' il numero di record nella pagina (valorizzato solo se l'estrazione è paginata, ovvero se FlgSenzaPaginazioneIn 0 o NULL)
975        			------------- fine argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
976        			ListaXMLOut				OUT		NOCOPY CLOB,					-- Lista dei tipi gruppi trovati (XML conforme a schema LISTA_STD.xsd)
977        																	-- Ogni gruppo è un tag Riga che può contenere le seguenti colonne:
978        																	-- 1:  Identificativo del gruppo
979        																	-- 2:  Nome del gruppo
980        																	-- 3:  Data di inizio validità (nel formato dato dal parametro FMT_STD_DATA)
981        																	-- 4:  Data di fine validità (nel formato dato dal parametro FMT_STD_DATA)
982        																	-- 5:  (valori 1/0) Flag che indica se il gruppo viene messo di defaul nell'ACL degli oggetti caricati nella repository documentale
983        																	-- 6:  Cod. identificativo del gruppo nel sistema di provenienza
984        																	-- 7:  Flag che indica che il gruppo è "di proprieà" dell'applicazione CodApplOwnerIO ed eventuale sua istanza CodIstApplOwnerIO
985        																	-- 8:  Descrizione dell'applicazione (ed eventuale istanza) proprietaria del gruppo
986        																	-- 9:  Timestamp di creazione del gruppo (nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP)
987        																	-- 10: Descrizione dell'utente di creazione del gruppo
988        																	-- 11: Timestamp di ultima modifica dei dati del gruppo (nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP)
989        																	-- 12: Descrizione dell'utente di ultima modifica dei dati del del gruppo
990        																	-- 13: (valori 1/0) Indicatore di gruppo riservato dal sistema e non modificabile da applicativo
991        																	-- 14: (valori 1/0) Indicatore di gruppo attualmente valido
992        			FlgAbilInsOut	 		OUT 		PLS_INTEGER ,            			-- (valori 1/0) Se 1 si ha abilitazione a inserimento di gruppi
993        			FlgAbilUpdOut 			OUT 		PLS_INTEGER ,            			-- (valori 1/0) Se 1 si ha abilitazione a modifica di gruppi
994        			FlgAbilDelOut 			OUT 		PLS_INTEGER,            			-- (valori 1/0) Se 1 si ha abilitazione a cancellazione di gruppi
995        			FlgMostraAltriAttrOut		OUT		PLS_INTEGER,					-- (valori 1/0) Se 1 nella GUI vanno mostrati gli attributi addizionali per un nuovo gruppo (ce ne sono di visibile all'utente), se 0 no
996        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
997        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
998        			ErrMsgOut				OUT 		VARCHAR2,						-- Messaggio d'errore
999        			RigaTagNameIn			IN		VARCHAR2 DEFAULT NULL,				-- (opzionale) Come rinominare il tag Riga dell'XML ListaXMLOut di output
1000        			ColTagNameIn			IN		DMVA_STRING DEFAULT NULL)			-- (opzionale) Come rinominare i tag delle colonne in alternativa a Colonna Nro=.. nell'XML ListaXMLOut di output
1001        			return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine, altrimenti 0
1002        
1003        	/********* funzione per caricare i dati di dettaglio di un gruppo di soggetti interni, inclusi i suoi membri 	**********/
1004        	/********* ATTENZIONE: come membri vengono mostrati solo quelli direttamente appartenenti al gruppo 			**********/
1005        	function LoadDettGruppoSoggInt(
1006        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
1007        																	-- (obblig). Codice identificativo del token di connessione
1008        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
1009        			IdGruppoIO				IN OUT	DMT_GRUPPI.ID_GRUPPO%type,			-- (obblig se NomeGruppoIO non è valorizzato) Id. del gruppo
1010        																	-- in output, salvo in caso di errore, è sempre valorizzato
1011        			NomeGruppoIO			IN OUT	DMT_GRUPPI.NOME_GRUPPO%type, 			-- (obblig se IdGruppoIO non è valorizzato in input) Nome del gruppo (ricerca case-insensitive in like se	nza forzare il % finale)
1012        																	-- in output, salvo in caso di errore, è sempre valorizzato
1013        			FlgDiDefaultInACLOut		OUT		PLS_INTEGER,					-- (valori 1/0) Se 1 è un gruppo che di default viene messo nell'ACL di oggetti della repository
1014        			DtInizioVldOut			OUT		VARCHAR2,						-- Data di inizio validità (nel formato dato dal parametro di conf. FMT_STD_DATA).
1015        			DtFineVldOut			OUT		VARCHAR2,						-- Data di fine validità (nel formato dato dal parametro di conf. FMT_STD_DATA).
1016        			CIProvGruppoOut			OUT 		DMT_GRUPPI.PROV_CI_GRUPPO%TYPE,		-- Codice identificativo del gruppo nel sistema di provenienza
1017        			FlgLockedOut			OUT		PLS_INTEGER,					-- (valori 1/0) Indicatore di gruppo riservato dal sistema e non modificabile/cancellabile da GUI
1018        			RowidOut				OUT		VARCHAR2,						-- Rowid del record del gruppo
1019        			XMLMembriOut			OUT		NOCOPY CLOB,					-- Lista dei membri del gruppo (XML conforme a schema LISTA_STD.xsd)
1020        																	-- Ogni membro è tag "Riga" che contiene le seguenti colonne:
1021        																	-- 1: Indicatore del tipo di membro:
1022        																	-- Valori ammessi:
1023        																	--	UO	=	U.O.
1024        																	-- 	SV	=	Scrivania virtuale
1025        																	--	UT	=	Utente
1026        																	--	G	=	Gruppo di soggetti interni
1027        																	-- 2: identificativo (ID_UO o ID_SCRIVANIA o ID_USER o ID_GRUPPO) del membro
1028        																	-- 3: descrizione/denominazione del membro
1029        																	-- 4: (solo se colonna 1 = UO o SV) Stringa con i n.ri livello della UO membro o a cui appartiene la scrivania membro (sono specificati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; sono separati dal separatore dei livelli valido per il soggetto produttore/AOO di appartenenza della UO)
1030        																	-- 5: (solo se colonna 1 = SV) Denominazione della UO in cui si trova la scrivania membro
1031        																	-- 6: (solo se colonna 1 = SV) Denominazione dell'utente che occupa la scrivania membro
1032        																	-- 7: (valori 1/0/NULL; valorizzata solo se colonna 1 = UO) Se 1 le sotto-UO sono incluse ne gruppo
1033        																	-- 8: (valori 1/0/NULL; valorizzata solo se colonna 1 = UO) Se 1 le scrivanie della UO (e sue sotto-UO se a lro volta incluse) sono incluse nel gruppo
1034        			AttributiAddOut			OUT		NOCOPY CLOB,					-- Lista degli eventuali ulteriori attributi con cui caratterizzare il gruppo (XML conforme a schema LISTA_STD.xsd)
1035        																	-- Ogni attributo è un tag "Riga" che contiene le seguenti colonne:
1036        																	-- 1: N.ro (valori da 1 a n) del riquadro (fieldset) in cui mostrare l'attributo
1037        																	-- 2: Nome identificativo dell'attributo (ATTR_NAME)
1038        																	-- 3: Label del campo con cui rappresentare l'attributo
1039        																	-- 4: Tipo di attributo. Valori: DATE, DATETIME, TEXT, TEXT-AREA, CHECK, INTEGER, EURO, DECIMAL, COMBO-BOX, LISTA
1040        																	-- 5: N.ro massimo di caratteri/cifre
1041        																	-- 6: Larghezza del campo con cui rappresentare l'attributo (size)
1042        																	-- 7: Valore dell'attributo
1043        																	-- 8: Label del riquadro (fieldset) in cui mostrare l'attributo
1044        																	-- 9: (valori 1/0) 1 indica che l'attributo è obbligatorio, 0 che è facoltativo
1045        																	-- 10: Altezza (in nro righe) del campo con cui rappresentare l'attributo (se TEXT-AREA)
1046        																	-- 11:(valori 1/0) 1 indica se l'attributo è modificabile, 0 che è in sola visualizzazione
1047        			BachSizeOut				OUT		PLS_INTEGER,					-- Indica il massimo n.ro di record per ogni pagina da mostrare nella lista dei membri
1048        			FlgMostraAltriAttrOut		OUT		PLS_INTEGER,					-- (valori 1/0) Se 1 nella GUI vanno mostrati gli attributi addizionali (ce ne sono di visibile all'utente), se 0 no
1049        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1050        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
1051        			ErrMsgOut				OUT 		VARCHAR2)						-- Messaggio d'errore
1052        			return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine, altrimenti 0
1053        
1054        	/********* funzione per creare o modificare un gruppo di soggetti interni, inclusi i suoi membri 	**********/
1055        	function IUGruppoSoggInt(
1056        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
1057        																	-- (obblig). Codice identificativo del token di connessione
1058        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
1059        			IdGruppoIO				IN OUT	DMT_GRUPPI.ID_GRUPPO%type,			-- Id. del gruppo da modificare. Se NULL si intende che il gruppo è da creare ex-novo
1060        																	-- in output, salvo in caso di errore, è sempre valorizzato
1061        			NomeGruppoIn			IN 		DMT_GRUPPI.NOME_GRUPPO%type DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
1062        																	-- (obblig.) Nome del gruppo
1063        			FlgDiDefaultInACLIn		IN		PLS_INTEGER DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
1064        																	-- (valori 1/0/NULL) Se 1 è un gruppo che di default viene messo nell'ACL di oggetti della repository
1065        			DtInizioVldIn			IN		VARCHAR2 DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'DATE_VAL_NO_UPD'),
1066        																	-- Data di inizio validità (nel formato dato dal parametro di conf. FMT_STD_DATA).
1067        			DtFineVldIn				IN		VARCHAR2 DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'DATE_VAL_NO_UPD'),
1068        																	-- Data di fine validità (nel formato dato dal parametro di conf. FMT_STD_DATA).
1069        			CIProvGruppoIn			IN 		DMT_GRUPPI.PROV_CI_GRUPPO%TYPE DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
1070        																	-- Codice identificativo del gruppo nel sistema di provenienza
1071        			FlgLockedIn				IN		PLS_INTEGER DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
1072        																	-- (valori 1/0/NULL) Indicatore di gruppo riservato dal sistema e non modificabile/cancellabile da GUI
1073        			RowidOut				OUT		VARCHAR2,						-- Rowid del record del gruppo
1074        			FlgModMembriIn			IN		VARCHAR2 DEFAULT 'I',				-- (valori I/C) Indica se i membri del gruppo indicati nell'argomento successivo sono forniti in modo incrementale (=I) (solo quelli da aggiungere o cancellare) oppure completo (=C), vale a dire che dovranno soppiantare tutti quelli già specificati (e relativi al dominio di lavoro) in caso di gruppo da aggiornare
1075        			XMLMembriIn				IN		CLOB DEFAULT NULL,				-- Lista dei membri del gruppo da aggiornare (XML conforme a schema LISTA_STD.xsd)
1076        																	-- Ogni membro è tag "Riga" che contiene le seguenti colonne:
1077        																	-- 1: (obblig) Indicatore del tipo di membro:
1078        																	-- Valori ammessi:
1079        																	--	UO	=	U.O.
1080        																	-- 	SV	=	Scrivania virtuale
1081        																	--	UT	=	Utente
1082        																	--	G	=	Gruppo di soggetti interni
1083        																	-- 2: identificativo (ID_UO o ID_SCRIVANIA o ID_USER o ID_GRUPPO) del soggetto interno
1084        																	-- 3: descrizione/denominazione del soggetto interno (ricerca case insensitive in like senza forzare il % finale)
1085        																	-- 4: (da valorizzare solo se colonna 1 = UO o SV) Stringa con i n.ri livello della UO o a cui appartiene la scrivania (tutti o alcuni; però se si specifica un livello è obbligatorio indicare tutti i livelli superiori; vanno specificati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; sono separati dal separatore dei livelli valido per il soggetto produttore/AOO di appartenenza della UO)
1086        																	-- 5: (da valorizzare solo se colonna 1 = UO o SV) Denominazione della UO in cui si trova la scrivania (o suo inizio; ricerca case insensitive in like senza forzare il % finale). Può essere quella semplice o la concatenazione con separatore "|" delle denominazioni delle UO superiori + quella della UO
1087        																	-- 6: (da valorizzare solo se colonna 1 = UO o SV) Denominazione dell'utente che occupa la scrivania (ricerca case insensitive in like senza forzare il % finale).
1088        																	-- 7: (valori 1/0/NULL; da valorizzare a 1 solo se colonna 1 = UO) Se 1 le sotto-UO sono incluse ne gruppo
1089        																	-- 8: (valori 1/0/NULL; da valorizzare a 1 solo se colonna 1 = UO) Se 1 le scrivanie della UO (e sue sotto-UO se a lro volta incluse) sono incluse nel gruppo
1090        																	-- 9: (valori 1/0/NULL) Flag di record da eliminare
1091        			AttributiAddIn			IN		CLOB DEFAULT NULL,				-- XML contenente nomi e valori degli attributi dinamici da aggiornare (conforme allo schema SezioneCache.xsd)
1092        																	-- Gli attributi già presenti in DB e per i quali non c'è corrispondente nell'XML restano invariati
1093        																	-- Per tutti gli attributi vale quanto segue:
1094        																	-- Un attributo da settare è un tag "Variabile" dell'XML il cui tag "Nome" contiene il nome identificativo dell'attributo (ATTR_NAME di DMT_ATTRIBUTES_DEF)
1095        																	-- Un attributo da settare è una variabile con tag "ValoreSemplice" se è un attributo a singolo valore e non strutturato (cioè con tipo diverso da COMPLEX)
1096        																	-- altrimenti è una variabile con tag "Lista" che ha un'unica colonna con "Nro" pari a 1 se l'attributo non è strutturato, che ha invece tante colonne quanti gli attributi componenti (ordinate in base al loro NRO_ORD_IN_SUP) se l'attributo è complesso
1097        																	-- Nel caso di variabili con tag "Lista" i valori specificati nell'XML si aggiungono o sostituiscono quelli già presenti in DB a seconda che nell'XML sia presente o meno una variabile con tag "Nome" pari a #Append_<Nome attributo> e tag "ValoreSemplice" pari a 1
1098        																	-- In particolare se non sono specificati valori nell'XML (tag Lista vuoto) e se i valori non sono da aggiungere significa che tutti i valori dell'attributo già presenti in DB vanno rimossi
1099        			FlgIgnoreWarningIn 		IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 0 o NULL significa che in presenza di WARNING la stored si comporta come in caso di errore; se 1 gli WARNING vengono ignorati
1100        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
1101        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
1102        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
1103        			WarningMsgOut			OUT		VARCHAR2,						-- Messaggio di warning (valorizzato solo se non c'è errore)
1104        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1105        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
1106        			ErrMsgOut				OUT 		VARCHAR2						-- Messaggio d'errore
1107        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine (senza warning), altrimenti 0 (in caso di errore o warning)
1108        
1109        	/*** Funzione di eliminazione (fisica) di un gruppo di soggetti inerni (UO, scrivanie, utenti)		***/
1110        	function DGruppoSoggInt(
1111        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
1112        																	-- (obblig). Codice identificativo del token di connessione
1113        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
1114        			IdGruppoIn				IN 		DMT_GRUPPI.ID_GRUPPO%type DEFAULT NULL,	-- (obblig. se NomeGruppoIn non è valorizzato) Id. del gruppo da eliminare.
1115        			NomeGruppoIn			IN 		DMT_GRUPPI.NOME_GRUPPO%type DEFAULT NULL,	-- (obblig. se IdGruppoIn non è valorizzato) Nome del gruppo da eliminare.
1116        			MotiviIn				IN		DMT_PROCESS_TYPES.MOTIVI_ANN%type,		-- Motivi della cancellazione
1117        			FlgIgnoreWarningIn 		IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 0 o NULL significa che in presenza di WARNING la stored si comporta come in caso di errore; se 1 gli WARNING vengono ignorati
1118        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
1119        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
1120        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
1121        			WarningMsgOut			OUT		VARCHAR2,						-- Messaggio di warning (valorizzato solo se non c'è errore)
1122        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1123        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
1124        			ErrMsgOut				OUT 		VARCHAR2						-- Messaggio d'errore
1125        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine (senza warning), altrimenti 0 (in caso di errore o warning)
1126        
1127        	/********* funzione per assegnare uno o più soggetti interni omogenei (utenti, UO, scrivanie, gruppi) ad un dato gruppo di soggetti interni 							*********/
1128        	/********* se alcuni dei soggetti da assegnare sono già nel gruppo non viene dato errore, ma viene aggiornata la vecchia appartenenza con le opzioni specificate in input 		*********/
1129        	function AssegnaAGruppoSoggInt(
1130        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
1131        																	-- (obblig). Codice identificativo del token di connessione
1132        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
1133        			IdGruppoIO				IN OUT	DMT_GRUPPI.ID_GRUPPO%type,			-- (obblig se NomeGruppoIn non è valorizzato) Id. del gruppo cui assegnare membri
1134        																	-- in output, salvo in caso di errore, è sempre valorizzato
1135        			NomeGruppoIn			IN 		DMT_GRUPPI.NOME_GRUPPO%type DEFAULT NULL, -- (obblig se IdGruppoIO non è valorizzato in input) Nome del gruppo cui assegnare membri (ricerca case-insensitive in like senza forzare il % finale)
1136        			FlgTipoMembriDaAggiungereIn	IN		VARCHAR2,						-- (obblig.) Indica cosa sono i soggetti interno da assegnare al gruppo
1137        																	-- Valori ammessi:
1138        																	--	UO	=	U.O.
1139        																	-- 	SV	=	Scrivania virtuale
1140        																	--	UT	=	Utente
1141        																	--	G	=	Gruppo di soggetti interni
1142        			MembriDaAggiungereXMLIn		IN		CLOB,							-- Lista con gli estremi dei soggetti da assegnare al gruppo (XML conforme a schema LISTA_STD.xsd)
1143        																	-- Ogni tag "Riga" rappresenta un soggetto da assegnare al gruppo e può contenere le seguenti colonne:
1144        																	-- 1: identificativo (ID_UO o ID_SCRIVANIA o ID_USER o ID_GRUPPO) del soggetto interno
1145        																	-- 2: descrizione/denominazione del soggetto interno (ricerca case insensitive in like senza forzare il % finale)
1146        																	-- 3: (da valorizzare solo se FlgTipoMembriDaAggiungereIn=UO o SV) Stringa con i n.ri livello della UO o a cui appartiene la scrivania (tutti o alcuni; però se si specifica un livello è obbligatorio indicare tutti i livelli superiori; vanno specificati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; sono separati dal separatore dei livelli valido per il soggetto produttore/AOO di appartenenza della UO)
1147        																	-- 4: (da valorizzare solo se FlgTipoMembriDaAggiungereIn=SV) Denominazione della UO in cui si trova la scrivania (o suo inizio; ricerca case insensitive in like senza forzare il % finale). Può essere quella semplice o la concatenazione con separatore "|" delle denominazioni delle UO superiori + quella della UO
1148        																	-- 5: (da valorizzare solo se FlgTipoMembriDaAggiungereIn=SV) Denominazione dell'utente che occupa la scrivania (ricerca case insensitive in like senza forzare il % finale).
1149        			FlgInclSottoUOIn			IN		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL; da valorizzare solo se FlgTipoMembriDaAggiungereIn=UO) Se 1 indica che anche le sotto-UO delle UO da assegnare al gruppo ricadranno nel gruppo
1150        			FlgInclScrivanieIn		IN		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL; da valorizzare solo se FlgTipoMembriDaAggiungereIn=UO) Se 1 indica che anche le scrivanie delle UO (e delle loro eventuali sotto-UO, se anch'esse incluse) da assegnare al gruppo ricadranno nel gruppo
1151        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
1152        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
1153        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
1154        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1155        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
1156        			ErrMsgOut				OUT 		VARCHAR2						-- Messaggio d'errore
1157        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine, altrimenti 0 (in caso di errore)
1158        
1159        	/********* funzione per assegnare un soggetto interno (utente, UO, scrivania, gruppo) ad un dato gruppo di soggetti interni o per modificare le opzioni di un'assegnazione già esistente	*********/
1160        	/********* Infatti se l''assegnazione già esiste non viene dato errore, ma viene aggiornata la vecchia assegnazione con le opzioni specificate in input 						*********/
1161        	function IUMembroGruppoSoggInt(
1162        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
1163        																	-- (obblig). Codice identificativo del token di connessione
1164        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
1165        			IdGruppoIO				IN OUT	DMT_GRUPPI.ID_GRUPPO%type,			-- (obblig se NomeGruppoIn non è valorizzato) Id. del gruppo cui assegnare il membro
1166        																	-- in output, salvo in caso di errore, è sempre valorizzato
1167        			NomeGruppoIn			IN 		DMT_GRUPPI.NOME_GRUPPO%type DEFAULT NULL, -- (obblig se IdGruppoIO non è valorizzato in input) Nome del gruppo cui assegnare il membro (ricerca case-insensitive in like senza forzare il % finale)
1168        			FlgTpObjAppartenenteIn		IN		VARCHAR2,						-- (obblig.) Indica cosa è il soggetto interno da assegnare al gruppo
1169        																	-- Valori ammessi:
1170        																	--	UO	=	U.O.
1171        																	-- 	SV	=	Scrivania virtuale
1172        																	--	UT	=	Utente
1173        																	--	G	=	Gruppo di soggetti interni
1174        			IdObjAppartenenteIn		IN 		INTEGER DEFAULT NULL,				-- Identificativo (ID_UO o ID_SCRIVANIA o ID_USER o ID_GRUPPO) del soggetto interno da assegnare al gruppo
1175        			DesObjAppartenenteIn		IN 		VARCHAR2 DEFAULT NULL,				-- Descrizione/denominazione del soggetto interno da assegnare al gruppo (ricerca case insensitive in like senza forzare il % finale)
1176        			LivelliUOAppartenenteIn		IN 		VARCHAR2 DEFAULT NULL,				-- (da valorizzare solo se FlgTpObjAppartenenteIn=UO o SV) Stringa con i n.ri livello della UO o a cui appartiene la scrivania da assegnare al gruppo (tutti o alcuni; però se si specifica un livello è obbligatorio indicare tutti i livelli superiori; vanno specificati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; sono separati dal separatore dei livelli valido per il soggetto produttore/AOO di appartenenza della UO)
1177        			DesUOAppScrivaniaToIn		IN 		VARCHAR2 DEFAULT NULL,				-- (da valorizzare solo se FlgTpObjAppartenenteIn=SV) Denominazione della UO in cui si trova la scrivania da assegnare al gruppo (o suo inizio; ricerca case insensitive in like senza forzare il % finale). Può essere quella semplice o la concatenazione con separatore "|" delle denominazioni delle UO superiori + quella della UO
1178        			DesUserScrivaniaToIn		IN		VARCHAR2 DEFAULT NULL,				-- (da valorizzare solo se FlgTpObjAppartenenteIn=SV) Denominazione dell'utente che occupa la scrivania da assegnare al gruppo (ricerca case insensitive in like senza forzare il % finale).
1179        			FlgInclSottoUOIn			IN		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL; da valorizzare solo se FlgTpObjAppartenenteIn=UO) Se 1 indica che anche le sotto-UO della UO da assegnare al gruppo ricadranno nel gruppo
1180        			FlgInclScrivanieIn		IN		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL; da valorizzare solo se FlgTpObjAppartenenteIn=UO) Se 1 indica che anche le scrivanie della UO (e delle sue eventuali sotto-UO, se anch'esse incluse) da assegnare al gruppo ricadranno nel gruppo
1181        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
1182        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
1183        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
1184        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1185        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
1186        			ErrMsgOut				OUT 		VARCHAR2						-- Messaggio d'errore
1187        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine, altrimenti 0 (in caso di errore)
1188        
1189        	/********* funzione per togliere uno o più soggetti interni (utenti, UO, scrivanie, sotto-gruppi) da un dato gruppo di soggetti interni 							*********/
1190        	function TogliDaGruppoSoggInt(
1191        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
1192        																	-- (obblig). Codice identificativo del token di connessione
1193        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
1194        			IdGruppoIO				IN OUT	DMT_GRUPPI.ID_GRUPPO%type,			-- (obblig se NomeGruppoIn non è valorizzato) Id. del gruppo da cui togliere membri
1195        																	-- in output, salvo in caso di errore, è sempre valorizzato
1196        			NomeGruppoIn			IN 		DMT_GRUPPI.NOME_GRUPPO%type DEFAULT NULL, -- (obblig se IdGruppoIO non è valorizzato in input) Nome del gruppo da cui togliere membri (ricerca case-insensitive in like senza forzare il % finale)
1197        			MembriDaTogliereXMLIn		IN		CLOB,							-- Lista con gli estremi dei soggetti da togliere dal gruppo (XML conforme a schema LISTA_STD.xsd)
1198        																	-- Ogni tag "Riga" rappresenta un soggetto da togliere e può contenere le seguenti colonne:
1199        																	-- 1: (obblig.) Indica il tipo del soggetto membro:
1200        																	-- Valori ammessi:
1201        																	--	UO	=	U.O.
1202        																	-- 	SV	=	Scrivania virtuale
1203        																	--	UT	=	Utente
1204        																	--	G	=	Gruppo di soggetti interni
1205        																	-- 2: Identificativo (ID_UO o ID_SCRIVANIA o ID_USER o ID_GRUPPO) del soggetto interno
1206        																	-- 3: Descrizione/denominazione del soggetto interno (ricerca case insensitive in like senza forzare il % finale)
1207        																	-- 4: (da valorizzare solo se tipo = UO o SV) Stringa con i n.ri livello della UO o a cui appartiene la scrivania (tutti o alcuni; però se si specifica un livello è obbligatorio indicare tutti i livelli superiori; vanno specificati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; sono separati dal separatore dei livelli valido per il soggetto produttore/AOO di appartenenza della UO)
1208        																	-- 5: (da valorizzare solo se tipo = SV) Denominazione della UO in cui si trova la scrivania (o suo inizio; ricerca case insensitive in like senza forzare il % finale). Può essere quella semplice o la concatenazione con separatore "|" delle denominazioni delle UO superiori + quella della UO
1209        																	-- 6: (da valorizzare solo se tipo = SV) Denominazione dell'utente che occupa la scrivania (ricerca case insensitive in like senza forzare il % finale).
1210        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
1211        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
1212        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
1213        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1214        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
1215        			ErrMsgOut				OUT 		VARCHAR2						-- Messaggio d'errore
1216        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine, altrimenti 0 (in caso di errore)
1217        
1218        	/********* funzione per togliere un singolo soggetto interno (utente, UO, scrivania, gruppo) da un dato gruppo di soggetti interni *********/
1219        	function DMembroGruppoSoggInt(
1220        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
1221        																	-- (obblig). Codice identificativo del token di connessione
1222        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
1223        			IdGruppoIO				IN OUT	DMT_GRUPPI.ID_GRUPPO%type,			-- (obblig se NomeGruppoIn non è valorizzato) Id. del gruppo da cui togliere il membro
1224        																	-- in output, salvo in caso di errore, è sempre valorizzato
1225        			NomeGruppoIn			IN 		DMT_GRUPPI.NOME_GRUPPO%type DEFAULT NULL, -- (obblig se IdGruppoIO non è valorizzato in input) Nome del gruppo da cui togliere il membro (ricerca case-insensitive in like senza forzare il % finale)
1226        			FlgTpObjAppartenenteIn		IN		VARCHAR2,						-- (obblig.) Indica cosa è il soggetto interno da togliere dal gruppo
1227        																	-- Valori ammessi:
1228        																	--	UO	=	U.O.
1229        																	-- 	SV	=	Scrivania virtuale
1230        																	--	UT	=	Utente
1231        																	--	G	=	Gruppo di soggetti interni
1232        			IdObjAppartenenteIn		IN 		INTEGER DEFAULT NULL,				-- Identificativo (ID_UO o ID_SCRIVANIA o ID_USER o ID_GRUPPO) del soggetto interno da togliere dal gruppo
1233        			DesObjAppartenenteIn		IN 		VARCHAR2 DEFAULT NULL,				-- Descrizione/denominazione del soggetto interno da togliere dal gruppo(ricerca case insensitive in like senza forzare il % finale)
1234        			LivelliUOAppartenenteIn		IN 		VARCHAR2 DEFAULT NULL,				-- (da valorizzare solo se FlgTpObjAppartenenteIn=UO o SV) Stringa con i n.ri livello della UO o a cui appartiene la scrivania da togliere dal gruppo (tutti o alcuni; però se si specifica un livello è obbligatorio indicare tutti i livelli superiori; vanno specificati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; sono separati dal separatore dei livelli valido per il soggetto produttore/AOO di appartenenza della UO)
1235        			DesUOAppScrivaniaToIn		IN 		VARCHAR2 DEFAULT NULL,				-- (da valorizzare solo se FlgTpObjAppartenenteIn=SV) Denominazione della UO in cui si trova la scrivania da togliere dal gruppo (o suo inizio; ricerca case insensitive in like senza forzare il % finale). Può essere quella semplice o la concatenazione con separatore "|" delle denominazioni delle UO superiori + quella della UO
1236        			DesUserScrivaniaToIn		IN		VARCHAR2 DEFAULT NULL,				-- (da valorizzare solo se FlgTpObjAppartenenteIn=SV) Denominazione dell'utente che occupa la scrivania da togliere dal gruppo (ricerca case insensitive in like senza forzare il % finale).
1237        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
1238        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
1239        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
1240        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1241        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
1242        			ErrMsgOut				OUT 		VARCHAR2						-- Messaggio d'errore
1243        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine, altrimenti 0 (in caso di errore)
1244        
1245        	/****** 	serve a ricercare gli utenti del sistema (accreditati o meno nel dominio di lavoro) *******/
1246        	function TrovaUsers(
1247        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
1248        																	-- (obblig). Codice identificativo del token di connessione
1249        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
1250        			FlgPreimpostaFiltroIn		IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1 i filtri e l'ordinamento vengono settati secondo le impostazioni dell'utente di lavoro, altrimenti restano come passati in input
1251        			IdUserIO				IN OUT	DMT_USERS.USERNAME%type,			-- 1° filtro di ricerca: Identificativo interno al sistema dell'utente da trovare
1252        			UsernameIO				IN OUT	DMT_USERS.USERNAME%type,			-- 2° filtro di ricerca: Username interna al sistema (Ricerca case-insensitive in like)
1253        			DescrizioneIO			IN OUT	DMT_USERS.DES_USER%type,			-- 3° filtro di ricerca: Descrizione dell'utente o suo inizio (ricerca case-insensitive in like)
1254        			QualificaIO				IN OUT	DMT_USERS.QUALIFICA%type,			-- 4° filtro di ricerca: Qualifica dell'utente o suo inizio (ricerca case-insensitive in like)
1255        			MatricolaIO				IN OUT	DMT_USERS.NRO_MATRICOLA%type,			-- 5° filtro di ricerca: N.ro di matricola dell'utente o suo inizio (ricerca case-insensitive in like)
1256        			CIProvUserIO			IN OUT	VARCHAR2,						-- 6° filtro di ricerca: Codice che identifica l'utente in un eventuale sistema di provenienza (ricerca case-senstive esatta)
1257        			FlgAccreditatiInDomIO		IN OUT	PLS_INTEGER,					-- 7° filtro di ricerca (valori 1/0/NULL) Se 1 indica che vanno ricercati solo utenti attualmente accreditati nel dominio di lavoro a cui si è connessi, se 0 solo utenti non attualmente accreditati nel dominio medesimo
1258        			CodApplAccredIO			IN OUT	VARCHAR2,						-- 8° filtro di ricerca: Codice dell'applicazione in cui devono essere accreditati gli utenti da ricercare. Se valorizzata pari a #BY_CONN_TKN e si è connessi da un'applicazione esterna si ricercano solo utenti accreditati in quell'applicazione
1259        			CodIstApplAccredIO		IN OUT	VARCHAR2,						-- 9° filtro di ricerca: Codice dell'istanza di applicazione in cui devono essere accreditati gli utenti da ricercare. Se valorizzata pari a #BY_CONN_TKN e si è connessi da un'applicazione esterna si ricercano solo utenti accreditati nell'istanza di applicazione esterna da cui si è connessi
1260        			CodApplNoAccredIO			IN OUT	VARCHAR2,						-- 10° filtro di ricerca: Codice dell'applicazione in cui NON devono essere accreditati gli utenti da ricercare. Se valorizzata pari a #BY_CONN_TKN e si è connessi da un'applicazione esterna si ricercano solo utenti NON accreditati in quell'applicazione
1261        			CodIstApplNoAccredIO		IN OUT	VARCHAR2,						-- 11° filtro di ricerca: Codice dell'istanza di applicazione in cui NON devono essere accreditati gli utenti da ricercare. Se valorizzata pari a #BY_CONN_TKN e si è connessi da un'applicazione esterna si ricercano solo utenti NON accreditati nell'istanza di applicazione esterna da cui si è connessi
1262        			IdRuoloAmmIO			IN OUT	DMT_RUOLI_AMM.ID_RUOLO_AMM%type,		-- 12° filtro di ricerca: Id. di un ruolo amminisrativo che deve essere attualmente ricoperto dagli utenti da ricercare (anche non direttamente, ovvero ricomprendo ruoli in cui ricade quello indicato)
1263        																	-- Viene considerato e gestito solo se è valorizzato l'argomento successivo; se non congruente con questo l'id. viene ignorato
1264        			DesRuoloAmmIO			IN OUT	DMT_RUOLI_AMM.DES_RUOLO_AMM%type,		-- 13° filtro di ricerca: Descrizione di un ruolo amminisrativo che deve essere attualmente ricoperto dagli utenti da ricercare (anche non direttamente, ovvero ricomprendo ruoli in cui ricade quello indicato)
1265        			IdUOConRelVsUserIO		IN OUT	DMT_STRUTTURA_ORG.ID_UO%type,			-- 14° filtro di ricerca: Identificativo di una UO con cui gli utenti da trovare devono essere attualmente in relazione (di appartenenza e/o a lavorare per e/o di delega) (il ruolo deve essere individuato univoacmente attraverso una ricerca case insensitive in like che non forza il % finale)
1266        																	-- Viene considerato e gestito solo se è valorizzato uno dei 2 argomenti successivo; se non congruente con questi l'id. viene ignorato
1267        			LivelliUOConRelVsUserIO		IN OUT	VARCHAR2,						-- 15° filtro di ricerca: Stringa con i n.ri livello di una UO con cui gli utenti da trovare devono essere attualmente in relazione (di appartenenza e/o a lavorare per e/o di delega)
1268        																	-- 	(tutti o solo alcuni; però se si specifica un livello è obbligatorio indicare tutti i livelli superiori; vanno indicati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; vanno separati dal separatore dei livelli di UO valido per il soggetto produttore/AOO di appartenenza della UO)
1269        			DesUOConRelVsUserIO		IN OUT	VARCHAR2,						-- 16° filtro di ricerca: Denominazione di una UO con cui gli utenti da trovare devono essere attualmente in relazione (di appartenenza e/o a lavorare per e/o di delega) (ricerca case insensitive in like). Può essere quella semplice o la concatenazione con separatore "|" delle denominazioni delle UO superiori + quella della UO
1270        																	-- 	ATTENZIONE: mentre la ricerca sulla denominazione semplice intende sempre che il valore in input sia un possibile inizio (aggiunge in automatico un % finale al valore quando fa la ricerca in like), quella sulla concatenzione no (il % finale non viene aggiunto in automatico, altrimenti le UO con sotto-UO non sarebbero mai individuabili univocamente attraverso il solo filtro sulla denominazione)
1271        			FlgTipoRelConUOIO			IN OUT	VARCHAR2,						-- (valori possiili: A, L, D o una loro concatenazione con ; come separatore) Dettaglio sul tipo di realzione che gli utenti da trovare devono avere con la UO specificata negi argomenti precedenti (A = Appartenenza, L = a Lavorare per, D = Delega)
1272        			FlgInclSottoUOIO			IN OUT	PLS_INTEGER,					-- (valori 1/0/NULL) Se 1 indica che gli utenti da trovare possono appartenere anche a sotto-UO della UO specificata negi argomenti precedenti
1273        			IdGruppoAppIO			IN OUT	DMT_GRUPPI.ID_GRUPPO%type,			-- 17° filtro di ricerca: Id. di un gruppo a cui devono appartenere gli utenti da ricercare (anche non direttamente, ovvero perchè appartengono a gruppi ricompresi in quello indicato; però un utente non viene dato come appartenente al gruppo solo perchè nel gruppo ricade una UO o scrivania cui è collegato)
1274        																	-- Viene considerato e gestito solo se è valorizzato l'argomento successivo; se non congruente con questo l'id. viene ignorato
1275        			NomeGruppoAppIO			IN OUT	DMT_GRUPPI.NOME_GRUPPO%type,			-- 18° filtro di ricerca: Nome di un di un gruppo a cui devono appartenere gli utenti da ricercare (anche non direttamente, ovvero perchè appartengono a gruppi ricompresi in quello indicato; però un utente non viene dato come appartenente al gruppo solo perchè nel gruppo ricade una UO o scrivania cui è collegato) (il gruppo deve essere individuato univocamente attraverso una ricerca case insensitive in like che non forza il % finale)
1276        			FlgSoloVldIO 			IN OUT 	INTEGER, 						-- 19° filtro di ricerca (valori 1/0/NULL): Se 1 indica se si devono estrarre solo gli utenti validi alla data odierna
1277        			TsVldIO				IN OUT	VARCHAR2,						-- 20° filtro di ricerca: Stinga con il timestamp (nel formato GG/MM/AAAA HH24:MI:SS) a cui devono essere validi gli utenti da estrarre
1278        			FlgConAccessoAlSistemaIO	IN OUT	PLS_INTEGER,					-- 21° filtro di ricerca (valori 1/0/NULL): Se 1 si cercano solo utenti con diritto di accesso al sistema, se 0 solo quelli senza diritto di accesso
1279        			AltriCriteriIO			IN OUT 	NOCOPY CLOB,					-- Altri criteri di ricerca sugli attributi addizionali (XML conforme a schema LISTA_STD.xsd). Se più di uno vengono applicati in AND.
1280        																	-- Ogni criterio è un tag Riga che può contenere le seguenti colonne:
1281        																	--	1) Nome (ATTR_NAME) dell'attributo cui è relativo il criterio
1282        																	--	2) (obblig.) Operatore logico. Valori possibili:
1283        																	--		"uguale" (ricerca esatta)
1284        																	--		"simile a (case-sensitive)" (ricerca case-sensitive in like)
1285        																	--		"simile a (case-insensitive)" (ricerca case-insensitive in like e che ignora i caratteri quali spazi, ., ecc)
1286        																	--		"maggiore" (se attributo numerico o data)
1287        																	--		"maggiore o uguale" (se attributo numerico o data)
1288        																	--		"minore" (se attributo numerico o data)
1289        																	--		"minore o uguale" (se attributo numerico o data)
1290        																	--		"tra" (se attributo numerico o data)
1291        																	--		"non valorizzato"
1292        																	--		"valorizzato"
1293        																	--		"spuntato" (se attributo di tipo casella di spunta)
1294        																	--		"non spuntato" (se attributo di tipo casella di spunta)
1295        																	--	3) 1° valore di confronto (obblig. e gestito solo se l'operatore non ha uno dei seguenti valori: valorizzato, non valorizzato, spuntato, non spuntato) (se l'attributo è numerico deve avere la virgola come separatore dei decimali, se è di tipo data deve essere in uno dei formato dati dai parametri di conf. FMT_STD_DATA e FMT_STD_TIMESTAMP)
1296        																	--	4) 2° valore di confronto (obblig. e gestito solo se l'operatore è "tra") (se l'attributo è numerico deve avere la virgola come separatore dei decimali, se è di tipo data deve essere in uno dei formato dati dai parametri di conf. FMT_STD_DATA e FMT_STD_TIMESTAMP)
1297        																	--	5) Label dell''attributo cui è relativo il criterio (se sotto-attributo di complesso <label del complesso> - <label del sotto-attributo>
1298        
1299        			------------- inizio argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
1300        			ColOrderByIO			IN OUT	VARCHAR2,						-- Indica il/i numeri della/e colonna dell'XML (CLOB ListaXMLOut) di output per cui ordinare i record nell'XML stesso (si può ordinare solo per le colonne da 1 a 10). Se l'ordinamento è per più colonne queste vanno separate con "," (es: 2; 2,3)
1301        																	-- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul tipo di ordinamento una qualche preimpostazione di sistema/utente ecc.
1302        																	-- se non valorizzato (neppure in output) la lista di record restituita non è ordinata
1303        			FlgDescOrderByIO  		IN OUT	VARCHAR2,						-- E' una stringa di 1 o 0/NULL, tanti quanti le colonne di ordinamento, separati da ",": 1 significa che l'ordinamento per la data colonna deve essere discendente anzichè ascendente (es: 1; 1,0; 1, )
1304        																	-- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul verso di ordinamento una qualche preimpostazione di sistema/utente ecc.
1305        			FlgSenzaPaginazioneIn 		IN 		PLS_INTEGER DEFAULT NULL,            	-- (valori 1/0/NULL) Se 1 l'estrazione non è paginata, altrimenti sì
1306        			NroPaginaIO      			IN OUT	PLS_INTEGER,                  		-- E' il numero della pagina da estrarre; se NULL e l'estrazione è paginata viene estratta la prima pagina
1307           			BachSizeIO				IN OUT	PLS_INTEGER,					-- Indica il massimo n.ro di record da estrarre se l'estrazione non è paginata (FlgSenzaPaginazioneIn=1)
1308        																	-- Indica la dimensione (n.ro di record) della pagina se l'estrazione è paginata (FlgSenzaPaginazioneIn 0 o NULL) e in tal caso se non è valorizzato la dimensione della pagina è quella settata per l'utente di lavoro o è pari al valore del parametro STD_PAGE_NUM_ROW del dominio di lavoro
1309        			OverFlowLimitIn			IN		PLS_INTEGER DEFAULT NULL,			-- E' il n.ro di record soddisfacenti la ricerca superato il quale la funzione deve restituire errore di overflow
1310        			FlgSenzaTotIn			IN		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 significa che non è richiesto come output il totale dei record soddisfacenti la ricerca (se la ricerca è paginata per la prima pagina il totale viene calcolato comunque, per le successive no)
1311        			NroTotRecOut			OUT		PLS_INTEGER,					-- E' il n.ro di record complessivi trovati (valorizzato solo se FlgSenzaTotIn è 0 o NULL o se si estrae la prima pagina)
1312             			NroRecInPaginaOut 		OUT   	PLS_INTEGER,                     		-- E' il numero di record nella pagina (valorizzato solo se l'estrazione è paginata, ovvero se FlgSenzaPaginazioneIn 0 o NULL)
1313        			------------- fine argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
1314        			ListaXMLOut				OUT		NOCOPY CLOB,					-- Lista degli utenti trovati (XML conforme a schema LISTA_STD.xsd)
1315        																	-- Ogni utente è un tag Riga che contiene le seguenti colonne:
1316        																	-- 1: Id. univoco dell'utente (ID_USER)
1317        																	-- 2: Cognome e nome / descrizione (DES_USER)
1318        																	-- 3: Username (interna al sistema)
1319        																	-- 4: N° matricola
1320        																	-- 5: Qualifica
1321        																	-- 6: Titolo
1322        																	-- 7: e-Mail
1323        																	-- 8: Inizio validità (nel formato dato dal parametro di cof. FMT_STD_DATA).
1324        																	-- 9: Fine validità (nel formato dato dal parametro di cof. FMT_STD_DATA)
1325        																	-- 10: Id. del soggetto di rubrica corrispondente all''utente
1326        																	-- 11: (valori 1/0) Flag di utente senza accesso al sistema
1327        																	-- 12: (valori 1/0) Flag di utente valido e attualmente accreditato nel dominio da cui si è connessi
1328        																	-- 13: Domini in cui è/è stato accreditato
1329        																	-- 14: (valori 1/0) Flag di utente accreditato nell'eventuale applicazione esterna da cui si è connessi
1330        																	-- 15: Cod. identificativo dell'utente nell'applicazione CodApplAccredIO e sua eventuale istanza CodIstApplAccredIO
1331        																	-- 16: Username nell'applicazione CodApplAccredIO e sua eventuale istanza CodIstApplAccredIO
1332        																	-- 17: UO di appartenenza e ruoli in esse ricoperti
1333        																	-- 18: UO per cui può lavorare e ruoli ricoperti
1334        																	-- 19: UO verso cui ha delega
1335        																	-- 20: Utenti verso cui ha delega
1336        																	-- 21: Cod. identificativo dell'utente nel sistema di provenienza
1337        																	-- 22: Timestamp di creazione dell'utente (nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP)
1338        																	-- 23: Descrizione dell'utente di creazione dell'utente
1339        																	-- 24: Timestamp di ultima modifica dei dati dell'utente (nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP)
1340        																	-- 25: Descrizione dell'utente di ultima modifica dei dati dell'utente
1341        																	-- 26: (valori 1/0) Indicatore di utente riservato dal sistema e non modificabile da applicativo
1342        																	-- 27: (valori 1/0) Flag di utente valido
1343        																	-- 28: (valori 1/0) Flag di utente attualmente accreditato nel dominio da cui si è connessi
1344        																	-- 29: Profilo dell'utente nel dominio cui si è collegati(decodifica)
1345        																	-- 30: Indirizzo/i dell'utente
1346        																	-- 31: Id. destinatario documenti cui è associato l'utente
1347        																	-- 32: Nome destinatario documenti cui è associato l'utente
1348        																	-- 33: Codice rapido
1349        																	-- 34: Timestamp di ultimo accesso dell'utente (nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP)
1350        																	-- 35: Cod. / Livelli della UO di appartenenza attuale nel dominio
1351        																	-- 36: Denominazione della UO di appartenenza attuale nel dominio
1352        																	-- 37: (valori 1/0) Indica se utenza bloccata per superamento n.ro tentativi errati di login
1353        																	-- 38: Dettagli sul blocco utenza (valorizzato se colonna 37 = 1)
1354        			FlgAbilInsOut	 		OUT 		PLS_INTEGER ,            			-- (valori 1/0) Se 1 si ha abilitazione a inserimento di utenti
1355        			FlgAbilUpdOut 			OUT 		PLS_INTEGER ,            			-- (valori 1/0) Se 1 si ha abilitazione a modifica di utenti
1356        			FlgAbilDelOut 			OUT 		PLS_INTEGER,            			-- (valori 1/0) Se 1 si ha abilitazione a cancellazione di utenti
1357        			FlgMostraAltriAttrOut		OUT		PLS_INTEGER,					-- (valori 1/0) Se 1 nella GUI vanno mostrati gli attributi addizionali per un nuovo utente (ce ne sono di visibile all'utente), se 0 no
1358        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1359        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
1360        			ErrMsgOut				OUT 		VARCHAR2,						-- Messaggio d'errore
1361        			EmailIn					IN		VARCHAR2 DEFAULT NULL,				-- Filtro sull'indirizzo e-mail (ricerca case-insensitive senza forzare il % finale)
1362        			IdProfiloIn				IN		PLS_INTEGER DEFAULT NULL,			-- Filtro per profilo (id.) dell'utente
1363        			RigaTagNameIn			IN		VARCHAR2 DEFAULT NULL,				-- (opzionale) Come rinominare il tag Riga dell'XML ListaXMLOut di output
1364        			ColTagNameIn			IN		DMVA_STRING DEFAULT NULL)			-- (opzionale) Come rinominare i tag delle colonne in alternativa a Colonna Nro=.. nell'XML ListaXMLOut di output
1365        			return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine, altrimenti 0
1366        
1367        	/********* funzione per caricare i dati di dettaglio di un utente del sistema, tranne le sue abilitazioni su singoli oggetti di definizione contesto 	**********/
1368        	/********* carica anche i dati dei clienti associati all'utente DatiClientiOut																			**********/
1369        	function LoadDettUserEstesa(
1370        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
1371        																	-- (obblig). Codice identificativo del token di connessione
1372        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
1373        			IdUserIO				IN OUT	DMT_USERS.ID_USER%type,				-- (obblig se DesUserIO e UsernameIO non sono valorizzati in input) Id. dell'utente
1374        																	-- in output, salvo in caso di errore, è sempre valorizzato
1375        			DesUserIO				IN OUT	DMT_USERS.DES_USER%type,			-- (obblig se IdUserIO e UsernameIO non sono valorizzati in input) Cognome e nome /descrizione dell'utente
1376        																	-- in output, salvo in caso di errore, è sempre valorizzato
1377        			UsernameIO				IN OUT	DMT_USERS.USERNAME%type,			-- (obblig se IdUserIO e DesUserIO non sono valorizzati in input) Username (interna al sistema) dell'utente
1378        																	-- in output, salvo in caso di errore, è sempre valorizzato
1379        			DtInizioVldOut			OUT		VARCHAR2,						-- Data di inizio validità (nel formato dato dal parametro di conf. FMT_STD_DATA).
1380        			DtFineVldOut			OUT		VARCHAR2,						-- Data di fine validità (nel formato dato dal parametro di conf. FMT_STD_DATA).
1381        			DtInizioAccredInDomOut		OUT		VARCHAR2,						-- Data di inizio accreditamento nel dominio da cui si è connessi (nel formato dato dal parametro di conf. FMT_STD_DATA).
1382        			DtFineAccredInDomOut		OUT		VARCHAR2 ,						-- Data di fine accreditamento nel dominio da cui si è connessi (nel formato dato dal parametro di conf. FMT_STD_DATA).
1383        			IdProfiloOut			OUT		DMT_PROFILI.ID_PROFILO%type ,			-- Id. del profilo di DMT_PROFILI assegnato all'utente nel dominio da cui si è connessi
1384        			NomeProfiloOut			OUT		DMT_PROFILI.NOME_PROFILO%type,		-- Nome del profilo di DMT_PROFILI assegnato all'utente nel dominio da cui si è connessi
1385        			XMLDatiProfiloOut			OUT		NOCOPY CLOB,					-- XML (conforme a schema SezioneCache.xsd) che contiene tutti gli attributi del profilo (tranne i gruppi di provilegi)
1386        			XMLGruppiPrivOut			OUT		NOCOPY CLOB,					-- Lista con i gruppi di privilegi assegnati (ovvero non tramite profilo) all'utente (XML conforme a schema LISTA_STD.xsd)
1387        																				-- Ogni gruppo è un tag "Riga" che può contenere le seguenti colonne:
1388        																				-- 1: Identificativo del gruppo di privilegi
1389        																				-- 2: Nome del gruppo di privilegi
1390        																				-- 3: Valore fisso 1: indica gruppo di privilegi assegnato
1391        			IdSoggRubricaOut			OUT		DMT_USERS.ID_USER_IN_RUBRICA%type,		-- Id. del soggetto della rubrica soggetti (ID_SOGG_RUBRICA) che rappresenta l'utente
1392        			TitoloOut				OUT		DMT_USERS.TITOLO%type,				-- Titolo (dott., ing, ecc)
1393        			QualificaOut			OUT		DMT_USERS.QUALIFICA%type,			-- Qualifica
1394        			NroMatricolaOut			OUT		DMT_USERS.NRO_MATRICOLA%type ,		-- N.ro di matricola
1395        			EmailOut				OUT		DMT_USERS.E_MAIL%type,				-- Indirizzo e-Mail
1396        			FlgSenzaAccessoAlSistemaOut	OUT		PLS_INTEGER,					-- (valori 1/0) Se 1 è un utente che on può accedere al sistema
1397        			CIProvUserOut			OUT		DMT_USERS.PROV_CI_USER%TYPE,			-- Codice identificativo dell'utente nel sistema di provenienza
1398        			FlgLockedOut			OUT		PLS_INTEGER,					-- (valori 1/0) Indicatore di utente riservato dal sistema e non modificabile/cancellabile da GUI
1399        			RowidOut				OUT		VARCHAR2,						-- Rowid del record dell'Utente
1400        			XMLApplEstAccredOut		OUT		NOCOPY CLOB,					-- Lista con le applicazioni esterne o loro istanze in cui è accreditato l'utente (XML conforme a schema LISTA_STD.xsd)
1401        																	-- Ogni applicazione esterna o sua stanza è un tag "Riga" che contiene le seguenti colonne:
1402        																	-- 1: Cod. applicazione esterna
1403        																	-- 2: Codice istanza applicazione
1404        																	-- 3: Descrizione applicazione esterna
1405        																	-- 4: Codice identificativo dell'utente nell'applicazione esterna / sua istanza
1406        																	-- 5: Username dell'utente nell'applicazione esterna / sua istanza
1407        																	-- 7: Id. della UO da usare come UO di registrazione quand l'utente lavora dall'applicazione esterna
1408        																	-- 8: Nri livelli della UO da usare come UO di registrazione quand l'utente lavora dall'applicazione esterna
1409        																	-- 9: Denominazione della UO da usare come UO di registrazione quand l'utente lavora dall'applicazione esterna
1410        																	-- 10: (flag 1/0) Se 1 indica se è un applicazione che usa credenziali diverse da quelle usate da Auriga
1411        			XMLRelConUOOut			OUT		NOCOPY CLOB,			-- Lista delle relazioni con la struttura organizzativa (XML conforme a schema LISTA_STD.xsd)
1412        																	-- Ogni relazione è un tag "Riga" che contiene le seguenti colonne:
1413        																	-- 1: Rowid che indica il record di relazione utente-UO
1414        																	-- 2: Indicatore del tipo di relazione:
1415        																	-- Valoripossibili:
1416        																	--	A	=	Appartenenza
1417        																	-- 	L	=	a Lavorare per
1418        																	--  D	=	delega
1419        																	-- 3: Identificativo (ID_UO) della UO
1420        																	-- 4: Denominazione della UO
1421        																	-- 5: Stringa con i n.ri livello della UO (sono specificati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; sono separati dal separatore dei livelli valido per il soggetto produttore/AOO di appartenenza della UO)
1422        																	-- 6: Data di inizio validità della relazione (nel formato dato dal parametro di config. FMT_STD_DATA). Se NULL si intende valida dall'istituzione della UO
1423        																	-- 7: Data di fine validità della relazione (nel formato dato dal parametro di config. FMT_STD_DATA). Se NULL si intende valida illimitatamente.
1424        																	-- 8: Id. del ruolo ricoperto
1425        																	-- 9: Descrizione del ruolo ricoperto
1426        																	-- 10: (1/0) Indica se l'utente con il dato ruolo è il primario degli utenti con lo stesso ruolo (eventualmente nella UO)
1427        																	-- 11: Indicatore di relazione con scrivania (2) o senza scrivania (0 o NULL)
1428        																	-- 12: Id. della scrivania occupata dall'utente nella relazione
1429        																	-- 13: Descrizione della scrivania occupata dall'utente nella relazione
1430        																	-- 14: (valori 1/0): Se 1 significa che la relazione è anche con tutte le sotto-UO della UO indicata (possibile solo se è una relazione "a lavorare per")
1431        																	-- 15: (valori 1/0/NULL): Se 1 significa che la relazione è anche con tutte le scrivanie virtuali della UO indicata (e sue eventuali sotto-UO se incluse a loro volta) (possibile solo se è una relazione "a lavorare per")
1432        																	-- 17: Esclusioni delle UO collegate al Punto di Protocollo vs cui è definita la relazione: sono le UO collegate al punto di protocollo vs le quali l'utente non deve acquisire relazione di tipo L come altrimenti accade
1433        																	-- 	   E' una lista di ID_UO separati da ;
1434        																	-- 18: (valori 1/0): Se 1 significa che la relazione è vs una UO che è un punto di protocollo
1435        																	-- 19: Flag 1/0/NULL che indica se c'è almeno un documento o fascicolo assegnato alla scrivania (=1) o nessuno
1436        																	-- 20: (valori UO/SV) Tipo - UO o SV (=scrivania) - del destinatario a cui a cui spostare documenti e fascicoli assegnati alla scrivania
1437        																	-- 21: Id. della UO o scrivania a cui spostare documenti e fascicoli assegnati alla scrivania (in genere impostata in caso di cessazione della UO)
1438        																	-- 22: Livelli della UO a cui spostare documenti e fascicoli assegnati alla scrivania (in genere impostata in caso di cessazione della UO)
1439        																	-- 23: Denominazione della UO o scrivania a cui spostare documenti e fascicoli assegnati alla scrivania (in genere impostata in caso di cessazione della UO)
1440        																	-- 24: Indica lo stato dello spostamento di documenti e fascicoli dalla scrivania ad altra UO o scrivania indicata: da avviare, in corso, completato
1441        																	-- 25: Data e ora (prevista o effettiva) di inizio spostamento di documenti e fascicoli nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP
1442        																	-- 26: Data e ora di fine spostamento di documenti e fascicoli nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP
1443        																	-- 27:  N.ro di documenti ancora assegnati alla scrivania
1444        																	-- 28: Data e ora di rilevamento - nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP - del n.ro di documenti assegnati alla scrivania indicato in NroDocAssOut
1445        																	-- 29: N.ro di fascicoli ancora assegnati alla scrivania
1446        																	-- 30: Data e ora di rilevamento - nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP - del n.ro di fascicoli assegnati alla scrivania indicato in NroDocFascOut
1447        			VisDocAssInvAUOXmlOut	OUT		CLOB ,					-- Lista delle strutture dei cui documenti e fascicoli assegnati o inviati in conoscenza l'utente ha visibilità (XML conforme a schema LISTA_STD.xsd).
1448        																	-- Ogni riga della lista contiene:
1449        																	-- 1) ID_UO della UO
1450        																	-- 2) Nri livello della UO
1451        																	-- 3) Denominazione della UO
1452        																	-- 4) (valori 1/0) flag di visibilità estesa alle sotto-UO
1453        																	-- 5) (valori 1/0) flag di visibilità estesa alle postazioni utente (anche delle sotto-UO se colonna 4 è 1)
1454        																	-- 6) (valori 1/0) flag di visibilità estesa ai documenti e fascicoli riservati
1455        			ModDocAssAUOXmlOut		OUT		CLOB,					-- Lista delle strutture dei cui documenti e fascicoli assegnati l'utente ha permesso di modifica/gestione (XML conforme a schema LISTA_STD.xsd).
1456        																	-- Ogni riga della lista contiene:
1457        																	-- 1) ID_UO della UO
1458        																	-- 2) Nri livello della UO
1459        																	-- 3) Denominazione della UO
1460        																	-- 4) (valori 1/0) flag di gestione estesa alle sotto-UO
1461        																	-- 5) (valori 1/0) flag di gestione estesa alle postazioni utente (anche delle sotto-UO se colonna 4 è 1)
1462        																	-- 6) (valori 1/0) flag di gestione estesa ai documenti e fascicoli riservati
1463        			XMLUOCaselleEmailVisbOut OUT		NOCOPY CLOB,		-- Lista con le UO sulle cui caselle collegate l'utente ha visibilità di tutte le mail (XML conforme a schema LISTA_STD.xsd)
1464        																	-- Ogni UO è un tag "Riga" che contiene le seguenti colonne:
1465        																	-- 1: ID_UO
1466        																	-- 2: (valori 1/0): Se 1 significa che la relazione è anche con tutte le sotto-UO della UO indicata
1467        																	-- 3: Denominazione della UO
1468        																	-- 4: Stringa con i n.ri livello della UO (sono specificati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; sono separati dal separatore dei livelli valido per il soggetto produttore/AOO di appartenenza della UO)
1469        			XMLDelegheOut			OUT		NOCOPY CLOB,			-- Lista delle deleghe verso UO, scrivanie e utenti (XML conforme a schema LISTA_STD.xsd)
1470        																	-- Ogni delega è un tag "Riga" che contiene le seguenti colonne:
1471        																	-- 1: Rowid che indica il record di delega
1472        																	-- 2: Indicatore del tipo di oggetto verso cui si ha delega:
1473        																	-- Valori ammessi:
1474        																	--	UO	=	Unità operativa
1475        																	-- 	UT	=	Utente
1476        																	--	SV	=	Scrivania
1477        																	-- 3: Identificativo (ID_UO o ID_USER o ID_SCRIVANIA) della UO/Utente/scrivania
1478        																	-- 4: Denominazione/descrizione della UO/Utente/scrivania
1479        																	-- 5: Stringa con i n.ri livello della UO (sono specificati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; sono separati dal separatore dei livelli valido per il soggetto produttore/AOO di appartenenza della UO)
1480        																	--    o con la username dell'utente
1481        																	-- 6: Data di inizio validità della delega (nel formato dato dal parametro di config. FMT_STD_DATA). Se NULL si intende valida da tempo illimitato
1482        																	-- 7: Data di fine validità della delega (nel formato dato dal parametro di config. FMT_STD_DATA). Se NULL si intende valida illimitatamente.
1483        																	-- 8: (valori 1/0/NULL): Se 1 significa che la delega è anche verso tutte le sotto-UO della UO indicata (possibile solo per delega vs UO)
1484        																	-- 9: (valori 1/0/NULL): Se 1 significa che la delega è anche verso tutte le scrivanie virtuali della UO indicata (e sue eventuali sotto-UO se incluse a loro volta) (possibile solo per delega vs UO)
1485        																	-- 10: Natura/motivi della delega
1486        			XMLGruppiAppOut			OUT		NOCOPY CLOB,			-- Lista con i gruppi cui appartiene l'utente (relativi al dominio da cui si è connessi)
1487        																	-- Ogni gruppo di appartenenza è un tag "Riga" con le colonne:
1488        																	-- 1: Id. del gruppo
1489        																	-- 2: Nome del gruppo
1490        			IndirizziOut		OUT		NOCOPY CLOB,				-- Lista degli indirizzi dell'utente (XML conforme a schema LISTA_STD.xsd)
1491        																	-- Ogni indirizzo è un tag Riga che può contenere le seguenti colonne:
1492        																	-- 1: Identificativo dell'indirizzo/luogo (rowid)
1493        																	-- 2: Codice del tipo di indirizzo/luogo
1494        																	-- 3: Tipo di indirizzo/luogo
1495        																	-- 4: Dettaglio del tipo
1496        																	-- 5: Cardinalità del tipo di indirizzo (basata sulla rilevanza del tipo: residenza /sede legale sono i primi)
1497        																	-- 6: Descrizione completa dell'indirizzo/luogo
1498        																	-- 7: Data di inzio validità dell'indirizzo/luogo (nel formato dato dal parametro di conf. FMT_STD_DATA)
1499        																	-- 8: Data di fine validità dell'indirizzo/luogo (nel formato dato dal parametro di conf. FMT_STD_DATA)
1500        																	-- 9: Codice identificativo toponomastico (se indirizzo censito nella toponomastica del sistema; viene considerato solo se è valorizzata anche la colonna successiva)
1501        																	-- 10: Indirizzo (senza civico) (alternativo o ridondante rispetto al campo precedente) e senza tipo toponimo se questo è separato in colonna 24 (che quindi è valorizzata)
1502        																	-- 11: N.° civico (senza eventuali appendici)
1503        																	-- 12: Interno
1504        																	-- 13: Scala
1505        																	-- 14: Piano
1506        																	-- 15: CAP
1507        																	-- 16: Frazione
1508        																	-- 17: Codice ISTAT del comune italiano (viene considerato solo se è valorizzata anche la colonna successiva)
1509        																	-- 18: Nome del comune italiano o della città (se estera)
1510        																	-- 19: Codice ISTAT dello stato (viene considerato solo se è valorizzata anche la colonna successiva)
1511        																	-- 20: Nome dello stato
1512        																	-- 21: Targa provincia
1513        																	-- 22: Zona dell'indirizzo
1514        																	-- 23: Complemento dell'indirizzo
1515        																	-- 24: Tipo toponimo (i.e. via, piazza ecc) dell'indirizzo
1516        																	-- 25: Appendici (esponente, bis/ter, colore ecc) del N.ro civico
1517        			AttributiAddOut			OUT		NOCOPY CLOB,			-- Lista degli eventuali ulteriori attributi con cui caratterizzare l'utente(XML conforme a schema LISTA_STD.xsd)
1518        																	-- Ogni attributo è un tag "Riga" che contiene le seguenti colonne:
1519        																	-- 1: N.ro (valori da 1 a n) del riquadro (fieldset) in cui mostrare l'attributo
1520        																	-- 2: Nome identificativo dell'attributo (ATTR_NAME)
1521        																	-- 3: Label del campo con cui rappresentare l'attributo
1522        																	-- 4: Tipo di attributo. Valori: DATE, DATETIME, TEXT, TEXT-AREA, CHECK, INTEGER, EURO, DECIMAL, COMBO-BOX, LISTA
1523        																	-- 5: N.ro massimo di caratteri/cifre
1524        																	-- 6: Larghezza del campo con cui rappresentare l'attributo (size)
1525        																	-- 7: Valore dell'attributo
1526        																	-- 8: Label del riquadro (fieldset) in cui mostrare l'attributo
1527        																	-- 9: (valori 1/0) 1 indica che l'attributo è obbligatorio, 0 che è facoltativo
1528        																	-- 10: Altezza (in nro righe) del campo con cui rappresentare l'attributo (se TEXT-AREA)
1529        																	-- 11:(valori 1/0) 1 indica se l'attributo è modificabile, 0 che è in sola visualizzazione
1530        			DatiClientiOut			OUT		NOCOPY CLOB,			-- Lista con i dati dei clienti e BA associati all'utente
1531        																	-- Ogni relazione società-cliente e suo BA è un tag "Riga" con le colonne:
1532        																	-- 1: Denominazione società cui è legato il cliente
1533        																	-- 2: Denominazione cliente
1534        																	-- 3: CF o P. IVA del cliente
1535        																	-- 4: CID del cliente
1536        																	-- 5: Gruppo di riferimento
1537        																	-- 6: ID_CLIENTE
1538        			BachSizeOut				OUT		PLS_INTEGER,			-- Indica il massimo n.ro di record per ogni pagina da mostrare nelle liste del dettaglio
1539        			FlgMostraAltriAttrOut		OUT		PLS_INTEGER,		-- (valori 1/0) Se 1 nella GUI vanno mostrati gli attributi addizionali (ce ne sono di visibile all'utente), se 0 no
1540        			ErrContextOut			OUT		VARCHAR2,				-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1541        			ErrCodeOut				OUT		PLS_INTEGER,			-- N.ro errore di uscita
1542        			ErrMsgOut				OUT 		VARCHAR2,			-- Messaggio d'errore,
1543        			CodRapidoOut			OUT			VARCHAR2,			-- Codice rapido
1544        			CodFiscaleOut			OUT			VARCHAR2,			-- Codice fiscale
1545        			AccountDefLockedOut		OUT			PLS_INTEGER)		-- Se 1 indica che l'account è definitamente bloccato e può essere sbloccato solo da amministratore con operazioni di sblocco o reset password
1546        			return PLS_INTEGER;										-- Vale 1 se tutto è andato a buon fine, altrimenti 0
1547        
1548        	/********* funzione per caricare i dati di dettaglio di un utente del sistema, tranne le sue abilitazioni su singoli oggetti di definizione contesto 	**********/
1549        	function LoadDettUser(
1550        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
1551        																	-- (obblig). Codice identificativo del token di connessione
1552        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
1553        			IdUserIO				IN OUT	DMT_USERS.ID_USER%type,				-- (obblig se DesUserIO e UsernameIO non sono valorizzati in input) Id. dell'utente
1554        																	-- in output, salvo in caso di errore, è sempre valorizzato
1555        			DesUserIO				IN OUT	DMT_USERS.DES_USER%type,			-- (obblig se IdUserIO e UsernameIO non sono valorizzati in input) Cognome e nome /descrizione dell'utente
1556        																	-- in output, salvo in caso di errore, è sempre valorizzato
1557        			UsernameIO				IN OUT	DMT_USERS.USERNAME%type,			-- (obblig se IdUserIO e DesUserIO non sono valorizzati in input) Username (interna al sistema) dell'utente
1558        																	-- in output, salvo in caso di errore, è sempre valorizzato
1559        			DtInizioVldOut			OUT		VARCHAR2,						-- Data di inizio validità (nel formato dato dal parametro di conf. FMT_STD_DATA).
1560        			DtFineVldOut			OUT		VARCHAR2,						-- Data di fine validità (nel formato dato dal parametro di conf. FMT_STD_DATA).
1561        			DtInizioAccredInDomOut		OUT		VARCHAR2,						-- Data di inizio accreditamento nel dominio da cui si è connessi (nel formato dato dal parametro di conf. FMT_STD_DATA).
1562        			DtFineAccredInDomOut		OUT		VARCHAR2 ,						-- Data di fine accreditamento nel dominio da cui si è connessi (nel formato dato dal parametro di conf. FMT_STD_DATA).
1563        			IdProfiloOut			OUT		DMT_PROFILI.ID_PROFILO%type ,			-- Id. del profilo di DMT_PROFILI assegnato all'utente nel dominio da cui si è connessi
1564        			NomeProfiloOut			OUT		DMT_PROFILI.NOME_PROFILO%type,		-- Nome del profilo di DMT_PROFILI assegnato all'utente nel dominio da cui si è connessi
1565        			XMLDatiProfiloOut			OUT		NOCOPY CLOB,					-- XML (conforme a schema SezioneCache.xsd) che contiene tutti gli attributi del profilo (tranne i gruppi di provilegi)
1566        			XMLGruppiPrivOut			OUT		NOCOPY CLOB,					-- Lista con i gruppi di privilegi assegnati o assegnabili (ovvero non tramite profilo) all'utente (XML conforme a schema LISTA_STD.xsd)
1567        																				-- Ogni gruppo è un tag "Riga" che può contenere le seguenti colonne:
1568        																				-- 1: Identificativo del gruppo di privilegi
1569        																				-- 2: Nome del gruppo di privilegi
1570        																				-- 3: (flag 1/0) Se 1 indica gruppo di privilegi assegnato, se 0 "da assegnare"
1571        			IdSoggRubricaOut			OUT		DMT_USERS.ID_USER_IN_RUBRICA%type,		-- Id. del soggetto della rubrica soggetti (ID_SOGG_RUBRICA) che rappresenta l'utente
1572        			TitoloOut				OUT		DMT_USERS.TITOLO%type,				-- Titolo (dott., ing, ecc)
1573        			QualificaOut			OUT		DMT_USERS.QUALIFICA%type,			-- Qualifica
1574        			NroMatricolaOut			OUT		DMT_USERS.NRO_MATRICOLA%type ,		-- N.ro di matricola
1575        			EmailOut				OUT		DMT_USERS.E_MAIL%type,				-- Indirizzo e-Mail
1576        			FlgSenzaAccessoAlSistemaOut	OUT		PLS_INTEGER,					-- (valori 1/0) Se 1 è un utente che on può accedere al sistema
1577        			CIProvUserOut			OUT		DMT_USERS.PROV_CI_USER%TYPE,			-- Codice identificativo dell'utente nel sistema di provenienza
1578        			FlgLockedOut			OUT		PLS_INTEGER,					-- (valori 1/0) Indicatore di utente riservato dal sistema e non modificabile/cancellabile da GUI
1579        			RowidOut				OUT		VARCHAR2,						-- Rowid del record dell'Utente
1580        			XMLApplEstAccredOut		OUT		NOCOPY CLOB,					-- Lista con le applicazioni esterne o loro istanze in cui è accreditato l'utente (XML conforme a schema LISTA_STD.xsd)
1581        																	-- Ogni applicazione esterna o sua stanza è un tag "Riga" che contiene le seguenti colonne:
1582        																	-- 1: Cod. applicazione esterna
1583        																	-- 2: Codice istanza applicazione
1584        																	-- 3: Descrizione applicazione esterna
1585        																	-- 4: Codice identificativo dell'utente nell'applicazione esterna / sua istanza
1586        																	-- 5: Username dell'utente nell'applicazione esterna / sua istanza
1587        																	-- 7: Id. della UO da usare come UO di registrazione quand l'utente lavora dall'applicazione esterna
1588        																	-- 8: Nri livelli della UO da usare come UO di registrazione quand l'utente lavora dall'applicazione esterna
1589        																	-- 9: Denominazione della UO da usare come UO di registrazione quand l'utente lavora dall'applicazione esterna
1590        																	-- 10: (flag 1/0) Se 1 indica se è un applicazione che usa credenziali diverse da quelle usate da Auriga
1591        			XMLRelConUOOut			OUT		NOCOPY CLOB,			-- Lista delle relazioni con la struttura organizzativa (XML conforme a schema LISTA_STD.xsd)
1592        																	-- Ogni relazione è un tag "Riga" che contiene le seguenti colonne:
1593        																	-- 1: Rowid che indica il record di relazione utente-UO
1594        																	-- 2: Indicatore del tipo di relazione:
1595        																	-- Valoripossibili:
1596        																	--	A	=	Appartenenza
1597        																	-- 	L	=	a Lavorare per
1598        																	--  D	=	delega
1599        																	-- 3: Identificativo (ID_UO) della UO
1600        																	-- 4: Denominazione della UO
1601        																	-- 5: Stringa con i n.ri livello della UO (sono specificati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; sono separati dal separatore dei livelli valido per il soggetto produttore/AOO di appartenenza della UO)
1602        																	-- 6: Data di inizio validità della relazione (nel formato dato dal parametro di config. FMT_STD_DATA). Se NULL si intende valida dall'istituzione della UO
1603        																	-- 7: Data di fine validità della relazione (nel formato dato dal parametro di config. FMT_STD_DATA). Se NULL si intende valida illimitatamente.
1604        																	-- 8: Id. del ruolo ricoperto
1605        																	-- 9: Descrizione del ruolo ricoperto
1606        																	-- 10: (1/0) Indica se l'utente con il dato ruolo è il primario degli utenti con lo stesso ruolo (eventualmente nella UO)
1607        																	-- 11: Indicatore di relazione con scrivania (2) o senza scrivania (0 o NULL)
1608        																	-- 12: Id. della scrivania occupata dall'utente nella relazione
1609        																	-- 13: Descrizione della scrivania occupata dall'utente nella relazione
1610        																	-- 14: (valori 1/0): Se 1 significa che la relazione è anche con tutte le sotto-UO della UO indicata (possibile solo se è una relazione "a lavorare per")
1611        																	-- 15: (valori 1/0/NULL): Se 1 significa che la relazione è anche con tutte le scrivanie virtuali della UO indicata (e sue eventuali sotto-UO se incluse a loro volta) (possibile solo se è una relazione "a lavorare per")
1612        																	-- 17: Esclusioni delle UO collegate al Punto di Protocollo vs cui è definita la relazione: sono le UO collegate al punto di protocollo vs le quali l'utente non deve acquisire relazione di tipo L come altrimenti accade
1613        																	-- 	   E' una lista di ID_UO separati da ;
1614        																	-- 18: (valori 1/0): Se 1 significa che la relazione è vs una UO che è un punto di protocollo
1615        																	-- 19: Flag 1/0/NULL che indica se c'è almeno un documento o fascicolo assegnato alla scrivania (=1) o nessuno
1616        																	-- 20: (valori UO/SV) Tipo - UO o SV (=scrivania) - del destinatario a cui a cui spostare documenti e fascicoli assegnati alla scrivania
1617        																	-- 21: Id. della UO o scrivania a cui spostare documenti e fascicoli assegnati alla scrivania (in genere impostata in caso di cessazione della UO)
1618        																	-- 22: Livelli della UO a cui spostare documenti e fascicoli assegnati alla scrivania (in genere impostata in caso di cessazione della UO)
1619        																	-- 23: Denominazione della UO o scrivania a cui spostare documenti e fascicoli assegnati alla scrivania (in genere impostata in caso di cessazione della UO)
1620        																	-- 24: Indica lo stato dello spostamento di documenti e fascicoli dalla scrivania ad altra UO o scrivania indicata: da avviare, in corso, completato
1621        																	-- 25: Data e ora (prevista o effettiva) di inizio spostamento di documenti e fascicoli nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP
1622        																	-- 26: Data e ora di fine spostamento di documenti e fascicoli nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP
1623        																	-- 27:  N.ro di documenti ancora assegnati alla scrivania
1624        																	-- 28: Data e ora di rilevamento - nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP - del n.ro di documenti assegnati alla scrivania indicato in NroDocAssOut
1625        																	-- 29: N.ro di fascicoli ancora assegnati alla scrivania
1626        																	-- 30: Data e ora di rilevamento - nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP - del n.ro di fascicoli assegnati alla scrivania indicato in NroDocFascOut
1627        			VisDocAssInvAUOXmlOut	OUT		CLOB ,					-- Lista delle strutture dei cui documenti e fascicoli assegnati o inviati in conoscenza l'utente ha visibilità (XML conforme a schema LISTA_STD.xsd).
1628        																	-- Ogni riga della lista contiene:
1629        																	-- 1) ID_UO della UO
1630        																	-- 2) Nri livello della UO
1631        																	-- 3) Denominazione della UO
1632        																	-- 4) (valori 1/0) flag di visibilità estesa alle sotto-UO
1633        																	-- 5) (valori 1/0) flag di visibilità estesa alle postazioni utente (anche delle sotto-UO se colonna 4 è 1)
1634        																	-- 6) (valori 1/0) flag di visibilità estesa ai documenti e fascicoli riservati
1635        			ModDocAssAUOXmlOut		OUT		CLOB,					-- Lista delle strutture dei cui documenti e fascicoli assegnati l'utente ha permesso di modifica/gestione (XML conforme a schema LISTA_STD.xsd).
1636        																	-- Ogni riga della lista contiene:
1637        																	-- 1) ID_UO della UO
1638        																	-- 2) Nri livello della UO
1639        																	-- 3) Denominazione della UO
1640        																	-- 4) (valori 1/0) flag di gestione estesa alle sotto-UO
1641        																	-- 5) (valori 1/0) flag di gestione estesa alle postazioni utente (anche delle sotto-UO se colonna 4 è 1)
1642        																	-- 6) (valori 1/0) flag di gestione estesa ai documenti e fascicoli riservati
1643        			XMLUOCaselleEmailVisbOut OUT		NOCOPY CLOB,		-- Lista con le UO sulle cui caselle collegate l'utente ha visibilità di tutte le mail (XML conforme a schema LISTA_STD.xsd)
1644        																	-- Ogni UO è un tag "Riga" che contiene le seguenti colonne:
1645        																	-- 1: ID_UO
1646        																	-- 2: (valori 1/0): Se 1 significa che la relazione è anche con tutte le sotto-UO della UO indicata
1647        																	-- 3: Denominazione della UO
1648        																	-- 4: Stringa con i n.ri livello della UO (sono specificati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; sono separati dal separatore dei livelli valido per il soggetto produttore/AOO di appartenenza della UO)
1649        			XMLDelegheOut			OUT		NOCOPY CLOB,			-- Lista delle deleghe verso UO, scrivanie e utenti (XML conforme a schema LISTA_STD.xsd)
1650        																	-- Ogni delega è un tag "Riga" che contiene le seguenti colonne:
1651        																	-- 1: Rowid che indica il record di delega
1652        																	-- 2: Indicatore del tipo di oggetto verso cui si ha delega:
1653        																	-- Valori ammessi:
1654        																	--	UO	=	Unità operativa
1655        																	-- 	UT	=	Utente
1656        																	--	SV	=	Scrivania
1657        																	-- 3: Identificativo (ID_UO o ID_USER o ID_SCRIVANIA) della UO/Utente/scrivania
1658        																	-- 4: Denominazione/descrizione della UO/Utente/scrivania
1659        																	-- 5: Stringa con i n.ri livello della UO (sono specificati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; sono separati dal separatore dei livelli valido per il soggetto produttore/AOO di appartenenza della UO)
1660        																	--    o con la username dell'utente
1661        																	-- 6: Data di inizio validità della delega (nel formato dato dal parametro di config. FMT_STD_DATA). Se NULL si intende valida da tempo illimitato
1662        																	-- 7: Data di fine validità della delega (nel formato dato dal parametro di config. FMT_STD_DATA). Se NULL si intende valida illimitatamente.
1663        																	-- 8: (valori 1/0/NULL): Se 1 significa che la delega è anche verso tutte le sotto-UO della UO indicata (possibile solo per delega vs UO)
1664        																	-- 9: (valori 1/0/NULL): Se 1 significa che la delega è anche verso tutte le scrivanie virtuali della UO indicata (e sue eventuali sotto-UO se incluse a loro volta) (possibile solo per delega vs UO)
1665        																	-- 10: Natura/motivi della delega
1666        			XMLGruppiAppOut			OUT		NOCOPY CLOB,			-- Lista con i gruppi cui appartiene l'utente (relativi al dominio da cui si è connessi)
1667        																	-- Ogni gruppo di appartenenza è un tag "Riga" con le colonne:
1668        																	-- 1: Id. del gruppo
1669        																	-- 2: Nome del gruppo
1670        			IndirizziOut		OUT		NOCOPY CLOB,				-- Lista degli indirizzi dell'utente (XML conforme a schema LISTA_STD.xsd)
1671        																	-- Ogni indirizzo è un tag Riga che può contenere le seguenti colonne:
1672        																	-- 1: Identificativo dell'indirizzo/luogo (rowid)
1673        																	-- 2: Codice del tipo di indirizzo/luogo
1674        																	-- 3: Tipo di indirizzo/luogo
1675        																	-- 4: Dettaglio del tipo
1676        																	-- 5: Cardinalità del tipo di indirizzo (basata sulla rilevanza del tipo: residenza /sede legale sono i primi)
1677        																	-- 6: Descrizione completa dell'indirizzo/luogo
1678        																	-- 7: Data di inzio validità dell'indirizzo/luogo (nel formato dato dal parametro di conf. FMT_STD_DATA)
1679        																	-- 8: Data di fine validità dell'indirizzo/luogo (nel formato dato dal parametro di conf. FMT_STD_DATA)
1680        																	-- 9: Codice identificativo toponomastico (se indirizzo censito nella toponomastica del sistema; viene considerato solo se è valorizzata anche la colonna successiva)
1681        																	-- 10: Indirizzo (senza civico) (alternativo o ridondante rispetto al campo precedente) e senza tipo toponimo se questo è separato in colonna 24 (che quindi è valorizzata)
1682        																	-- 11: N.° civico (senza eventuali appendici)
1683        																	-- 12: Interno
1684        																	-- 13: Scala
1685        																	-- 14: Piano
1686        																	-- 15: CAP
1687        																	-- 16: Frazione
1688        																	-- 17: Codice ISTAT del comune italiano (viene considerato solo se è valorizzata anche la colonna successiva)
1689        																	-- 18: Nome del comune italiano o della città (se estera)
1690        																	-- 19: Codice ISTAT dello stato (viene considerato solo se è valorizzata anche la colonna successiva)
1691        																	-- 20: Nome dello stato
1692        																	-- 21: Targa provincia
1693        																	-- 22: Zona dell'indirizzo
1694        																	-- 23: Complemento dell'indirizzo
1695        																	-- 24: Tipo toponimo (i.e. via, piazza ecc) dell'indirizzo
1696        																	-- 25: Appendici (esponente, bis/ter, colore ecc) del N.ro civico
1697        			AttributiAddOut			OUT		NOCOPY CLOB,			-- Lista degli eventuali ulteriori attributi con cui caratterizzare l'utente(XML conforme a schema LISTA_STD.xsd)
1698        																	-- Ogni attributo è un tag "Riga" che contiene le seguenti colonne:
1699        																	-- 1: N.ro (valori da 1 a n) del riquadro (fieldset) in cui mostrare l'attributo
1700        																	-- 2: Nome identificativo dell'attributo (ATTR_NAME)
1701        																	-- 3: Label del campo con cui rappresentare l'attributo
1702        																	-- 4: Tipo di attributo. Valori: DATE, DATETIME, TEXT, TEXT-AREA, CHECK, INTEGER, EURO, DECIMAL, COMBO-BOX, LISTA
1703        																	-- 5: N.ro massimo di caratteri/cifre
1704        																	-- 6: Larghezza del campo con cui rappresentare l'attributo (size)
1705        																	-- 7: Valore dell'attributo
1706        																	-- 8: Label del riquadro (fieldset) in cui mostrare l'attributo
1707        																	-- 9: (valori 1/0) 1 indica che l'attributo è obbligatorio, 0 che è facoltativo
1708        																	-- 10: Altezza (in nro righe) del campo con cui rappresentare l'attributo (se TEXT-AREA)
1709        																	-- 11:(valori 1/0) 1 indica se l'attributo è modificabile, 0 che è in sola visualizzazione
1710        			BachSizeOut				OUT			PLS_INTEGER,		-- Indica il massimo n.ro di record per ogni pagina da mostrare nelle liste del dettaglio
1711        			FlgMostraAltriAttrOut	OUT			PLS_INTEGER,		-- (valori 1/0) Se 1 nella GUI vanno mostrati gli attributi addizionali (ce ne sono di visibile all'utente), se 0 no
1712        			ErrContextOut			OUT			VARCHAR2,			--Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1713        			ErrCodeOut				OUT			PLS_INTEGER,		-- N.ro errore di uscita
1714        			ErrMsgOut				OUT 		VARCHAR2,			-- Messaggio d'errore,
1715        			CodRapidoOut			OUT			VARCHAR2,			-- Codice rapido
1716        			CodFiscaleOut			OUT			VARCHAR2,			-- Codice fiscale
1717        			AccountDefLockedOut		OUT			PLS_INTEGER)		-- Se 1 indica che l'account è definitamente bloccato e può essere sbloccato solo da amministratore con operazioni di sblocco o reset password
1718        			return PLS_INTEGER;										-- Vale 1 se tutto è andato a buon fine, altrimenti 0
1719        
1720        	/*** Funzione di creazione/aggiornamento di un utente del sistema									***/
1721        	/*** prevede la gestione di: accreditamento e profilatura nel dominio da cui si è connessi				***/
1722        	/*** 				     applicazioni esterne in cui è accreditato								***/
1723        	/***				     sue relazioni con la struttura organizzativa; 							***/
1724        	/***				     deleghe verso altri utenti o scrivanie;								***/
1725        	/***				     gruppi di appartenenza											***/
1726        	/*** Non prevede la gestione dei privilegi su singoli oggetti di definizione del contesto					***/
1727        	function IUUser(
1728        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
1729        																	-- (obblig). Codice identificativo del token di connessione
1730        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
1731        			IdUserIO				IN OUT	DMT_USERS.ID_USER%type,				-- Id. dell'utente da modificare. Se NULL si intende che l'utente è da creare ex-novo
1732        																	-- in output, salvo in caso di errore, è sempre valorizzato
1733        			DesUserIn				IN 		DMT_USERS.DES_USER%type DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
1734        																	-- (obblig.) Cognome e nome dell'utente (prima cognome e poi nome, separati da |)
1735        			UsernameIn				IN		DMT_USERS.USERNAME%type DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
1736        																	-- (obblig.) Username (interna al sistema) dell'utente
1737        			PasswordIn				IN		DMT_USERS.PASSWORD%type DEFAULT NULL,	-- (viene gestita solo se l'utente è da creare) Password (interna al sistema) dell'utente
1738        			ConfermaPasswordIn		IN		DMT_USERS.PASSWORD%type DEFAULT NULL,	-- (viene gestita solo se l'utente è da creare) Conferma della password
1739        			DtInizioVldIn			IN		VARCHAR2 DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'DATE_VAL_NO_UPD'),
1740        																	-- Data di inizio validità (nel formato dato dal parametro di conf. FMT_STD_DATA).
1741        			DtFineVldIn				IN		VARCHAR2 DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'DATE_VAL_NO_UPD'),
1742        																	-- Data di fine validità (nel formato dato dal parametro di conf. FMT_STD_DATA).
1743        			DtInizioAccredInDomIn		IN		VARCHAR2 DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'DATE_VAL_NO_UPD'),
1744        																	-- Data di inizio accreditamento nel dominio da cui si è connessi (nel formato dato dal parametro di conf. FMT_STD_DATA).
1745        																	-- Se l'utente è da creare o comunque non è ancora accreditato nel dominio vi viene accreditato con decorrenza dalla data qui specificata
1746        			DtFineAccredInDomIn		IN		VARCHAR2 DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'DATE_VAL_NO_UPD'),
1747        																	-- Data di fine accreditamento nel dominio da cui si è connessi (nel formato dato dal parametro di conf. FMT_STD_DATA).
1748        																	-- Se l'utente è da creare o comunque non è ancora accreditato nel dominio vi viene accreditato con termine fino alla data qui specificata
1749        			IdProfiloIn				IN		DMT_PROFILI.ID_PROFILO%type DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
1750        																	-- Id. del profilo di DMT_PROFILI (uno di quelli che hanno un nome) da assegnare all'utente nel dominio da cui si è connessi
1751        			NomeProfiloIn			IN		DMT_PROFILI.NOME_PROFILO%type DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
1752        																	-- Nome del profilo di DMT_PROFILI da assegnare all'utente nel dominio da cui si è connessi (ricerca case-insensitive in like)
1753        			XMLDatiProfiloIn			IN		CLOB DEFAULT NULL,				-- XML (conforme a schema SezioneCache.xsd) che contiene tutti gli attributi del profilo (tranne i gruppi di provilegi) da settare/aggiornare
1754        																	-- ATTENZIONE: Si intende che gli attributi corrispondenti a tag non presenti restino invariati
1755        																	-- Nell'XML possono esserci tag corrispondenti ad attributi di profilatura solo se non si è specificato un profilo predefinito con i due argomenti IdProfiloIn e/o NomeProfiloIn
1756        			FlgModGruppiPrivIn		IN		VARCHAR2 DEFAULT 'I',				-- (valori I/C) Indica se i gruppi di privilegi indicati nell'argomento successivo sono forniti in modo incrementale (=I) (solo quelle da inserire/cancellare) oppure completo (=C), vale a dire che dovranno soppiantare tutti quelli già associati al soggetto di cui aggiornare la profilatura
1757        			XMLGruppiPrivIn			IN		CLOB DEFAULT NULL,				-- Lista con i gruppi di privilegi assegnati/da assegnare direttamente (ovvero non tramite profilo) all'utente (XML conforme a schema LISTA_STD.xsd)
1758        																	-- Ogni gruppo è un tag "Riga" che può contenere le seguenti colonne:
1759        																	-- 1: Identificativo del gruppo di privilegi
1760        																	-- 2: Nome del gruppo di privilegi (ricerca case insesnsitive in like)
1761        																	-- 3: (valori 1/0/NULL) Flag di gruppo da eliminare
1762        			IdSoggRubricaIn			IN		DMT_USERS.ID_USER_IN_RUBRICA%type DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
1763        																	-- Id. del soggetto della rubrica soggetti (ID_SOGG_RUBRICA) che rappresenta l'utente
1764        			TitoloIn				IN		DMT_USERS.TITOLO%type DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
1765        																	-- Titolo (dott., ing, ecc)
1766        			QualificaIn				IN		DMT_USERS.QUALIFICA%type DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
1767        																	-- Qualifica
1768        			NroMatricolaIn			IN		DMT_USERS.NRO_MATRICOLA%type DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
1769        																	-- N.ro di matricola
1770        			EmailIn				IN		DMT_USERS.E_MAIL%type DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
1771        																	-- Indirizzo e-Mail
1772        			FlgSenzaAccessoAlSistemaIn	IN		PLS_INTEGER DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
1773        																	-- (valori 1/0/NULL) Se 1 è un utente che on può accedere al sistema
1774        			CIProvUserIn			IN 		DMT_USERS.PROV_CI_USER%TYPE DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
1775        																	-- Codice identificativo dell'utente nel sistema di provenienza
1776        			FlgLockedIn				IN		PLS_INTEGER DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
1777        																	-- (valori 1/0/NULL) Indicatore di utente riservato dal sistema e non modificabile/cancellabile da GUI
1778        			FlgModApplEstAccredIn		IN		VARCHAR2 DEFAULT 'I',				-- (valori I/C) Indica se le applicazioni esterne o loro istanze in cui è accreditato l'utente e che sono indicate nell'argomento successivo sono fornite in modo incrementale (=I) (solo quelle da aggiungere o cancellare) oppure completo (=C), vale a dire che dovranno soppiantare tutti quelle già specificate (e relative al dominio da cui si è connessi) in caso di utente da aggiornare
1779        			XMLApplEstAccredIn		IN		CLOB DEFAULT NULL,				-- Lista con le applicazioni esterne o loro istanze in cui è accreditato l'utente (XML conforme a schema LISTA_STD.xsd)
1780        																	-- Ogni applicazione esterna o sua stanza è un tag "Riga" che contiene le seguenti colonne:
1781        																	-- 1: Cod. applicazione esterna
1782        																	-- 2: Codice istanza applicazione
1783        																	-- 3: Codice identificativo dell'utente nell'applicazione esterna / sua istanza
1784        																	-- 4: Username dell'utente nell'applicazione esterna / sua istanza
1785        																	-- 5: Password dell'utente nell'applicazione esterna / sua istanza
1786        																	-- 6: (valori 1/0) Flag di record da eliminare
1787        																	-- 7: Id. della UO da usare come UO di registrazione quand l'utente lavora dall'applicazione esterna
1788        																	-- ATTENZIONE: a prescindere dal contenuto della lista l'utente viene comunque accreditato nell'applicazione esterna e sua istanza da cui si è connessi qualora non lo sia già
1789        			FlgModRelConUOIn			IN		VARCHAR2 DEFAULT 'I',		-- (valori I/C) Indica se le relazioni (solo di appartenenza o a lavorare per) con la struttura organizzativa indicate nell'argomento successivo sono fornite in modo incrementale (=I) (solo quelle da aggiungere o cancellare) oppure completo (=C), vale a dire che dovranno soppiantare tutte quelle già specificate (e relativi alla struttura organizzativa del dominio di lavoro) in caso di utente da aggiornare
1790        			XMLRelConUOIn			IN		CLOB DEFAULT NULL,		-- Lista delle relazioni con la struttura organizzativa da aggiornare (XML conforme a schema LISTA_STD.xsd)
1791        																	-- Ogni relazione è un tag "Riga" che contiene le seguenti colonne:
1792        																	-- 1: Rowid che indica il record di relazione utente-UO da aggiornare/eliminare
1793        																	-- 2: Indicatore del tipo di relazione:
1794        																	-- Valori ammessi:
1795        																	-- 		A = appartenenza gerarchica
1796        																	-- 		D = funzionale, ovvero "delega"
1797        																	-- 		L = a gestire documentazione della UO anche se quest'ultima è cessata
1798        																	-- 3: Identificativo (ID_UO) della UO
1799        																	-- 4: Denominazione della UO (o suo inizio; ricerca case insensitive in like senza forzare il % finale). Può essere quella semplice o la concatenazione con separatore "|" delle denominazioni delle UO superiori + quella della UO
1800        																	-- 5: Stringa con i n.ri livello della UO (tutti o alcuni; però se si specifica un livello è obbligatorio indicare tutti i livelli superiori; vanno specificati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; sono separati dal separatore dei livelli valido per il soggetto produttore/AOO di appartenenza della UO)
1801        																	-- 6: Data di inizio validità della relazione (nel formato dato dal parametro di config. FMT_STD_DATA). Se NULL si intende valida dall'istituzione della UO
1802        																	-- 7: Data di fine validità della relazione (nel formato dato dal parametro di config. FMT_STD_DATA). Se NULL si intende valida illimitatamente.
1803        																	-- 8: Id. del ruolo ricoperto
1804        																	-- 9: Descrizione del ruolo ricoperto (ricerca case-insensitive in like senza forzare % finale)
1805        																	-- 10: (1/0/NULL) Indica se l'utente con il dato ruolo è il primario degli utenti con lo stesso ruolo (eventualmente nella UO)
1806        																	-- 11: Indicatore di relazione: con scrivania da creare ex-novo (1), con scrivania scelta tra una disponibile di quelle già esistenti (2), senza scrivania (0 o NULL)
1807        																	-- 12: Id. della scrivania già esistente occupata dall'utente nella relazione (viene considerato solo se la colonna precedente è 2 e la successiva è valorizzata)
1808        																	-- 13: Descrizione della scrivania occupata dall'utente nella relazione (se la colonna 10 vale 2 la ricerca della scrivania è case insensitive in like senza forzare % finale; se la colonna 10 vale 1 è la descrizione da dare alla nuova scrivania in luogo di quella che le verrebbe data in automatico)
1809        																	-- 14: (valori 1/0/NULL): Se 1 significa che la relazione è anche con tutte le sotto-UO della UO indicata (possibile solo se è una relazione "a lavorare per")
1810        																	-- 15: (valori 1/0/NULL): Se 1 significa che la relazione è anche con tutte le scrivanie virtuali della UO indicata (e sue eventuali sotto-UO se incluse a loro volta) (possibile solo se è una relazione "a lavorare per")
1811        																	-- 16: (valori 1/0/NULL) Flag di record da eliminare
1812        																	-- 17: Esclusioni delle UO collegate al Punto di Protocollo vs cui è definita la relazione: sono le UO collegate al punto di protocollo vs le quali l'utente non deve acquisire relazione di tipo L come altrimenti accade
1813        																	-- 	   E' una lista di ID_UO separati da ;
1814        																	-- 18: (valori UO/SV) Tipo - UO o SV (=scrivania) - del destinatario a cui a cui spostare documenti e fascicoli assegnati alla scrivania
1815        																	-- 19: Id. della UO o scrivania a cui spostare documenti e fascicoli assegnati alla scrivania (in genere impostata in caso di cessazione della scrivania)
1816        			FlgModUOVisDocAssInvIn	IN		VARCHAR2 DEFAULT 'I',	-- (valori I/C) Indica se le UO indicate nell'argomento successivo sono fornite in modo incrementale (=I) (solo quelle da aggiungere o cancellare) oppure completo (=C), vale a dire che dovranno soppiantare tutte quelle già specificate (e relative alla struttura organizzativa del dominio di lavoro) in caso di utente da aggiornare
1817        			VisDocAssInvAUOXmlIn	IN		CLOB DEFAULT NULL,		-- Lista delle strutture dei cui documenti e fascicoli assegnati o inviati in conoscenza l'utente ha visibilità (XML conforme a schema LISTA_STD.xsd).
1818        																	-- Devono essere stutture del dominio di lavoro, non necessariamente attive
1819        																	-- Ogni riga della lista contiene:
1820        																	-- 1) ID_UO della UO
1821        																	-- 2) Nri livello della UO
1822        																	-- 3) Denominazione della UO
1823        																	-- 4) (valori 1/0) flag di visibilità estesa alle sotto-UO
1824        																	-- 5) (valori 1/0) flag di visibilità estesa alle postazioni utente (anche delle sotto-UO se colonna 4 è 1)
1825        																	-- 6) (valori 1/0) flag di visibilità estesa ai documenti e fascicoli riservati
1826        																	-- 7) (valori 1/0) flag di UO da eliminare
1827        			FlgModUOModDocAssIn		IN		VARCHAR2 DEFAULT 'I',	-- (valori I/C) Indica se le UO indicate nell'argomento successivo sono fornite in modo incrementale (=I) (solo quelle da aggiungere o cancellare) oppure completo (=C), vale a dire che dovranno soppiantare tutte quelle già specificate (e relative alla struttura organizzativa del dominio di lavoro) in caso di utente da aggiornare
1828        			ModDocAssAUOXmlIn		IN		CLOB DEFAULT NULL,		-- Lista delle strutture dei cui documenti e fascicoli assegnati l'utente ha permesso di modifica/gestione (XML conforme a schema LISTA_STD.xsd).
1829        																	-- Devono essere stutture del dominio di lavoro, non necessariamente attive
1830        																	-- Ogni riga della lista contiene:
1831        																	-- 1) ID_UO della UO
1832        																	-- 2) Nri livello della UO
1833        																	-- 3) Denominazione della UO
1834        																	-- 4) (valori 1/0) flag di gestione estesa alle sotto-UO
1835        																	-- 5) (valori 1/0) flag di gestione estesa alle postazioni utente (anche delle sotto-UO se colonna 4 è 1)
1836        																	-- 6) (valori 1/0) flag di gestione estesa ai documenti e fascicoli riservati
1837        																	-- 7) (valori 1/0) flag di UO da eliminare
1838        			FlgModDelegheIn			IN		VARCHAR2 DEFAULT 'I',	-- (valori I/C) Indica se le deleghe (verso UO, scrivanie e utenti) indicate nell'argomento successivo sono fornite in modo incrementale (=I) (solo quelle da aggiungere o cancellare) oppure completo (=C), vale a dire che dovranno soppiantare tutte quelle già specificate (e relative alla struttura organizzativa del dominio di lavoro) in caso di utente da aggiornare
1839        			XMLDelegheIn			IN		CLOB DEFAULT NULL,		-- Lista delle deleghe (verso scrivanie e utenti) da aggiornare (XML conforme a schema LISTA_STD.xsd)
1840        																	-- AD OGGI NON E' GESTITA ANCORA
1841        																	-- Ogni delega è un tag "Riga" che contiene le seguenti colonne:
1842        																	-- 1: Rowid che indica il record di delega da aggiornare/eliminare
1843        																	-- 2: Indicatore del tipo di oggetto verso cui si ha delega:
1844        																	-- Valori ammessi:
1845        																	-- 	UT	=	Utente
1846        																	--	SV	=	Scrivania
1847        																	-- 3: Identificativo (ID_UO o ID_USER o ID_SCRIVANIA) della UO/Utente/scrivania (viene considerato solo se una delle 2 colonne successive e valorizzata e se non è congruente con quelle viene ignorato)
1848        																	-- 4: Denominazione/descrizione della UO/Utente/scrivania  (o suo inizio; ricerca case insensitive in like senza forzare il % finale). Nel caso di UO può essere quella semplice o la concatenazione con separatore "|" delle denominazioni delle UO superiori + quella della UO
1849        																	-- 5: Stringa con i n.ri livello della UO (tutti o alcuni; però se si specifica un livello è obbligatorio indicare tutti i livelli superiori; vanno specificati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; sono separati dal separatore dei livelli valido per il soggetto produttore/AOO di appartenenza della UO)
1850        																	-- 6: Data di inizio validità della delega (nel formato dato dal parametro di config. FMT_STD_DATA). Se NULL si intende valida da tempo illimitato
1851        																	-- 7: Data di fine validità della delega (nel formato dato dal parametro di config. FMT_STD_DATA). Se NULL si intende valida illimitatamente.
1852        																	-- 8: (valori 1/0/NULL): Se 1 significa che la delega è anche verso tutte le sotto-UO della UO indicata (possibile solo per delega vs UO)
1853        																	-- 9: (valori 1/0/NULL): Se 1 significa che la delega è anche verso tutte le scrivanie virtuali della UO indicata (e sue eventuali sotto-UO se incluse a loro volta) (possibile solo per delega vs UO)
1854        																	-- 10: (valori 1/0/NULL) Flag di record da eliminare
1855        			FlgModGruppiAppIn			IN		VARCHAR2 DEFAULT 'I',				-- (valori I/C) Indica i gruppi cui appartiene l'utente (relativi al dominio da cui si è connessi) indicati nell'argomento successivo sono forniti in modo incrementale (=I) (solo quelle da aggiungere o cancellare) oppure completo (=C), vale a dire che dovranno soppiantare tutte quelle già specificati (e relativi al dominio di lavoro) in caso di utente da aggiornare
1856        			XMLGruppiAppIn			IN		CLOB DEFAULT NULL,				-- Lista con i gruppi cui appartiene l'utente (relativi al dominio da cui si è connessi)
1857        																	-- Ogni gruppo di appartenenza è un tag "Riga" con le colonne:
1858        																	-- 1: Id. del gruppo (viene considerato solo se la colonna successiva è valorizzata)
1859        																	-- 2: Nome del gruppo
1860        																	-- 3: (valori 1/0) Flag di appartenenza a gruppo da eliminare
1861        			RowidOut				OUT		VARCHAR2,				-- Rowid del record dell'Utente
1862        			AttributiAddIn			IN		CLOB DEFAULT NULL,		-- XML contenente nomi e valori degli attributi dinamici da aggiornare (conforme allo schema SezioneCache.xsd)
1863        																	-- Gli attributi già presenti in DB e per i quali non c'è corrispondente nell'XML restano invariati
1864        																	-- Per tutti gli attributi vale quanto segue:
1865        																	-- Un attributo da settare è un tag "Variabile" dell'XML il cui tag "Nome" contiene il nome identificativo dell'attributo (ATTR_NAME di DMT_ATTRIBUTES_DEF)
1866        																	-- Un attributo da settare è una variabile con tag "ValoreSemplice" se è un attributo a singolo valore e non strutturato (cioè con tipo diverso da COMPLEX)
1867        																	-- altrimenti è una variabile con tag "Lista" che ha un'unica colonna con "Nro" pari a 1 se l'attributo non è strutturato, che ha invece tante colonne quanti gli attributi componenti (ordinate in base al loro NRO_ORD_IN_SUP) se l'attributo è complesso
1868        																	-- Nel caso di variabili con tag "Lista" i valori specificati nell'XML si aggiungono o sostituiscono quelli già presenti in DB a seconda che nell'XML sia presente o meno una variabile con tag "Nome" pari a #Append_<Nome attributo> e tag "ValoreSemplice" pari a 1
1869        																	-- In particolare se non sono specificati valori nell'XML (tag Lista vuoto) e se i valori non sono da aggiungere significa che tutti i valori dell'attributo già presenti in DB vanno rimossi
1870        			FlgIgnoreWarningIn 		IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 0 o NULL significa che in presenza di WARNING la stored si comporta come in caso di errore; se 1 gli WARNING vengono ignorati
1871        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
1872        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
1873        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
1874        			WarningMsgOut			OUT		VARCHAR2,						-- Messaggio di warning (valorizzato solo se non c'è errore)
1875        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1876        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
1877        			ErrMsgOut				OUT 		VARCHAR2,						-- Messaggio d'errore
1878        			CodRapidoIn				IN		DMT_USERS.COD_RAPIDO%type DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),		-- Codice rapido dell'utente
1879        			CodFiscaleIn			IN		DMT_RUBRICA_SOGGETTI.CF%type DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),				-- Codice fiscale (viene registrato in rubrica soggetti)
1880        			FlgModIndirizziIn		IN		VARCHAR2 DEFAULT 'I',			-- (valori I/C) Indica se gli indirizzi indicate nell'argomento successivo sono forniti in modo incrementale (=I) (solo quelle da inserire/modificare/cancellare) oppure completo (=C), vale a dire che dovranno soppiantare tutti gli indirizzi NON storici già specificati in caso di soggetto da aggiornare
1881        			XMLIndirizziIn			IN		CLOB DEFAULT NULL				-- Lista degli indirizzi (tranne quelli cessati) del soggetto (XML conforme a schema LISTA_STD.xsd)
1882        																			-- Ogni indirizzo è un tag Riga che può contenere le seguenti colonne:
1883        																			-- 1: Identificativo dell'indirizzo/luogo (rowid)
1884        																			-- 2: Codice del tipo di indirizzo/luogo
1885        																			-- 3: Tipo di indirizzo/luogo
1886        																			-- 4: Dettaglio del tipo
1887        																			-- 5: <non utilizzata>
1888        																			-- 6: <non utilizzata>
1889        																			-- 7: Data di inzio validità dell'indirizzo/luogo (nel formato dato dal parametro di conf. FMT_STD_DATA)
1890        																			-- 8: Data di fine validità dell'indirizzo/luogo (nel formato dato dal parametro di conf. FMT_STD_DATA)
1891        																			-- 9: Codice identificativo toponomastico (se indirizzo censito nella toponomastica del sistema; viene considerato solo se è valorizzata anche la colonna successiva)
1892        																			-- 10: Indirizzo (senza civico) (alternativo o ridondante rispetto al campo precedente) e senza tipo toponimo se questo è separato in colonna 24 (che quindi è valorizzata)
1893        																			-- 11: N.° civico (senza eventuali appendici)
1894        																			-- 12: Interno
1895        																			-- 13: Scala
1896        																			-- 14: Piano
1897        																			-- 15: CAP
1898        																			-- 16: Frazione
1899        																			-- 17: Codice ISTAT del comune italiano (viene considerato solo se è valorizzata anche la colonna successiva)
1900        																			-- 18: Nome del comune italiano o della città (se estera)
1901        																			-- 19: Codice ISTAT dello stato (viene considerato solo se è valorizzata anche la colonna successiva)
1902        																			-- 20: Nome dello stato
1903        																			-- 21: Targa provincia
1904        																			-- 22: Zona dell'indirizzo
1905        																			-- 23: Complemento dell'indirizzo
1906        																			-- 24: Tipo toponimo (i.e. via, piazza ecc) dell'indirizzo
1907        																			-- 25: Appendici (esponente, bis/ter, colore ecc) del N.ro civico
1908        																			-- 26: (valori 1/0/NULL) Flag di indirizzo da eliminare
1909        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine (senza warning), altrimenti 0 (in caso di errore o warning)
1910        
1911        	/****** funzione per accreditare un utente nel dominio a cui si è connessi 												*******/
1912        	/****** Se l'utente è già accreditato non viene dato errore ed eventualmente vengono aggiornati gli estremi del periodo di accreditamento 	*******/
1913        	function AccreditaUserInDominioLogon(
1914        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
1915        																	-- (obblig). Codice identificativo del token di connessione
1916        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
1917        			IdUserIn				IN 		DMT_USERS.ID_USER%type DEFAULT NULL,	-- (obblig. se UsernameIn e DesUserIn non sono valorizzati) Id. dell'utente da accreditare.
1918        			UsernameIn				IN		DMT_USERS.USERNAME%type DEFAULT NULL,	-- (obblig. se IdUserIn e DesUserIn non sono valorizzati) Username (interna al sistema) dell'utente da accreditare
1919        			DesUserIn				IN 		DMT_USERS.DES_USER%type DEFAULT NULL,	-- (obblig. se IdUserIn e UsernameIn non sono valorizzati) Cognome e nome/descrizione dell'utente (ricerca case insensitive in like senza forzare il % finale)
1920        			DtInizioAccredInDomIn		IN		VARCHAR2 DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'DATE_VAL_NO_UPD'),
1921        																	-- Data di inizio accreditamento nel dominio da cui si è connessi (nel formato dato dal parametro di conf. FMT_STD_DATA).
1922        			DtFineAccredInDomIn		IN		VARCHAR2 DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'DATE_VAL_NO_UPD'),
1923        																	-- Data di fine accreditamento nel dominio da cui si è connessi (nel formato dato dal parametro di conf. FMT_STD_DATA).
1924        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
1925        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
1926        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
1927        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1928        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
1929        			ErrMsgOut				OUT 		VARCHAR2						-- Messaggio d'errore
1930        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine, altrimenti 0 (in caso di errore o warning)
1931        
1932        	/****** funzione per accreditare un utente in una data applicazione esterna o sua istanza (se non specificata quella da cui si è connessi) 						******/
1933        	/****** Se l'utente è già accreditato non viene dato errore ed eventualmente vengono aggiornati credenziali e cod. id. dell'utente nell'applicazione esterna o sua istanza 	******/
1934        	function AccreditaUserInApplEst(
1935        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
1936        																	-- (obblig). Codice identificativo del token di connessione
1937        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
1938        			IdUserIn				IN 		DMT_USERS.ID_USER%type DEFAULT NULL,	-- (obblig. se UsernameIn e DesUserIn non sono valorizzati) Id. dell'utente da accreditare.
1939        			UsernameIn				IN		DMT_USERS.USERNAME%type DEFAULT NULL,	-- (obblig. se IdUserIn e DesUserIn non sono valorizzati) Username (interna al sistema) dell'utente da accreditare
1940        			DesUserIn				IN 		DMT_USERS.DES_USER%type DEFAULT NULL,	-- (obblig. se IdUserIn e UsernameIn non sono valorizzati) Cognome e nome/descrizione dell'utente (ricerca case insensitive in like senza forzare il % finale)
1941        			CodApplicazioneEsternaIn	IN		DMT_APPLICAZIONI_ESTERNE.CI_APPLICAZIONE%type DEFAULT NULL,
1942        																	-- Codice dell'applicazione esterna in cui accreditare
1943        																	-- Se non valorizzato è quella da cui si è connessi
1944        			CodIstApplicazioneEsternaIn	IN		DMT_APPLICAZIONI_ESTERNE.CI_ISTANZA_APPLICAZIONE%type DEFAULT NULL,
1945        																	-- Codice dell'istanza di applicazione esterna in cui accreditare
1946        																	-- Se CodApplicazioneEsternaIn non è valorizzato è l'istanza di applicazione esterna da cui si è connessi
1947        			UsernameInApplEstIn		IN		VARCHAR2 DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
1948        																	-- Username dell'utente nell'applicazione esterna (o sua istanza) in cui accreditare
1949        			PasswordInApplEstIn		IN		VARCHAR2 DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
1950        																	-- Password dell'utente nell'applicazione esterna (o sua istanza) in cui accreditare
1951        			CIUserInApplEstIn			IN		VARCHAR2 DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
1952        																	-- Cod. identificativo dell'utente nell'applicazione esterna (o sua istanza) in cui accreditare
1953        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
1954        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
1955        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
1956        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1957        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
1958        			ErrMsgOut				OUT 		VARCHAR2,						-- Messaggio d'errore
1959        			IdUORegDefaultIn		IN		INTEGER	DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD')
1960        																			-- Id. della UO da usare come UO di registrazione quando l'utente effettua una registrazione a protocollo o altra numerazione dall'applicazione esterna
1961        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine, altrimenti 0 (in caso di errore o warning)
1962        
1963        	/****** funzione per togliere l'accreditamento in una data applicazione esterna o sua istanza (se non specificata quella da cui si è connessi) ad una lista di utenti 	******/
1964        	/****** Se un utente della lista non è già accreditato non viene dato errore 																******/
1965        	function TogliAccredUsersInApplEst(
1966        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
1967        																	-- (obblig). Codice identificativo del token di connessione
1968        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
1969        			CodApplicazioneEsternaIn	IN		DMT_APPLICAZIONI_ESTERNE.CI_APPLICAZIONE%type DEFAULT NULL,
1970        																	-- Codice dell'applicazione esterna da cui togliere l'accreditamento
1971        																	-- Se non valorizzato è quella da cui si è connessi
1972        			CodIstApplicazioneEsternaIn	IN		DMT_APPLICAZIONI_ESTERNE.CI_ISTANZA_APPLICAZIONE%type DEFAULT NULL,
1973        																	-- Codice dell'istanza di applicazione esterna da cui togliere l'accreditamento
1974        																	-- Se CodApplicazioneEsternaIn non è valorizzato è l'istanza di applicazione esterna da cui si è connessi
1975        			ListaUtentiXmlIn			IN		CLOB,							-- Lista con gli estremi degli utenti a cui togliere l'accreditamento (XML conforme a schema LISTA_STD.xsd)
1976        																	-- Ogni utente è un tag riga che può contenere le colonne:
1977        																	-- 1: Id. dell'utente (quello interno ad AURIGA)
1978        																	-- 2: Descrizione dell'utente
1979        																	-- 3: Username dell'utente (quello di AURIGA)
1980        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
1981        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
1982        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
1983        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1984        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
1985        			ErrMsgOut				OUT 		VARCHAR2						-- Messaggio d'errore
1986        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine, altrimenti 0 (in caso di errore o warning)
1987        
1988        	/*** Funzione di eliminazione (fisica) di un utente del sistema	***/
1989        	function DUser(
1990        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
1991        																	-- (obblig). Codice identificativo del token di connessione
1992        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
1993        			IdUserIn				IN 		DMT_USERS.ID_USER%type DEFAULT NULL,	-- (obblig. se UsernameIn e DesUserIn non sono valorizzati) Id. dell'utente da eliminare.
1994        			UsernameIn				IN		DMT_USERS.USERNAME%type DEFAULT NULL,	-- (obblig. se IdUserIn e DesUserIn non sono valorizzati) Username (interna al sistema) dell'utente da eliminare
1995        			DesUserIn				IN 		DMT_USERS.DES_USER%type DEFAULT NULL,	-- (obblig. se IdUserIn e UsernameIn non sono valorizzati) Cognome e nome/descrizione dell'utente (ricerca case insensitive in like senza forzare il % finale)
1996        			MotiviIn				IN		DMT_PROCESS_TYPES.MOTIVI_ANN%type,		-- Motivi della cancellazione
1997        			FlgIgnoreWarningIn 		IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 0 o NULL significa che in presenza di WARNING la stored si comporta come in caso di errore; se 1 gli WARNING vengono ignorati
1998        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
1999        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
2000        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
2001        			WarningMsgOut			OUT		VARCHAR2,						-- Messaggio di warning (valorizzato solo se non c'è errore)
2002        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
2003        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
2004        			ErrMsgOut				OUT 		VARCHAR2						-- Messaggio d'errore
2005        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine (senza warning), altrimenti 0 (in caso di errore o warning)
2006        
2007        	/*** Funzione con cui modificare la password di un utente (anche senza specificare la vecchia password se l'utente di lavoro è abilitato alla gestione degli utenti) ***/
2008        	function CambioPassword(
2009        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
2010        																	-- (obblig). Codice identificativo del token di connessione
2011        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
2012        			IdUserIn				IN 		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente di cui cambiare la password
2013        			UsernameIn				IN		DMT_USERS.USERNAME%type DEFAULT NULL,	-- Username (interna al sistema) dell'utente di cui cambiare la password
2014        			DesUserIn				IN 		DMT_USERS.DES_USER%type DEFAULT NULL,	-- Cognome e nome/descrizione dell'utente (ricerca case insensitive in like senza forzare il % finale) di cui cambiare la password
2015        																	-- ATTENZIONE: Se nessuno dei 3 argomenti precedenti è valorizzato si intende che l'utente di cui modificare al password sia quello connesso
2016        			FlgNoVerifyOldPwdIn		IN		PLS_INTEGER DEFAULT NULL,			-- (1/0/NULL) Se 1 la vecchia password non viene verificata per consentire la modifica.
2017        																	-- Può essere valorizzato a 1 solo se l'utente di lavoro è abilitato alla modifica utenti
2018        			OldPasswordIn			IN		DMT_USERS.PASSWORD%type,			-- Vecchia password
2019        			NewPasswordIn			IN		DMT_USERS.PASSWORD%type,			-- Nuova password
2020        			ConfNewPasswordIn			IN		DMT_USERS.PASSWORD%type,			-- Conferma nuova password
2021        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
2022        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
2023        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
2024        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore; se NULL è la funzione stessa
2025        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
2026        			ErrMsgOut				OUT 		VARCHAR2)						-- Messaggio d'errore
2027        			return PLS_INTEGER;											-- vale 1 in caso di successo, altrimenti 0
2028        
2029        	/*** Funzione per sbloccare utenza loccata a causa di troppi tentativi di login falliti ***/
2030        	function UnlockUser(
2031        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
2032        																	-- (obblig). Codice identificativo del token di connessione
2033        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
2034        			IdUserIn				IN 		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente da sbloccare
2035        			UsernameIn				IN		DMT_USERS.USERNAME%type DEFAULT NULL,	-- Username (interna al sistema) dell'utente da sbloccare
2036        			DesUserIn				IN 		DMT_USERS.DES_USER%type DEFAULT NULL,	-- Cognome e nome/descrizione dell'utente (ricerca case insensitive in like senza forzare il % finale) di cui cambiare la password
2037        																					-- ATTENZIONE: Almeno uno dei tre argomenti sopra deve essere valorizzato
2038        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
2039        																					-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
2040        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,				-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
2041        			ErrContextOut			OUT		VARCHAR2,								-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore; se NULL è la funzione stessa
2042        			ErrCodeOut				OUT		PLS_INTEGER,							-- N.ro errore di uscita
2043        			ErrMsgOut				OUT 		VARCHAR2)							-- Messaggio d'errore
2044        			return PLS_INTEGER;														-- vale 1 in caso di successo, altrimenti 0
2045        
2046        	/************* Funzione attraverso cui registrarsi come utente della community di AURIGA **************/
2047        	function RegistrazioneUtenteCommunity(
2048        			DesUserIn				IN		VARCHAR2,						-- (obblig.) Descrizione/cognome e nome dell'utente
2049        			eMailIn				IN		VARCHAR2 DEFAULT NULL,				-- Indirizzo e-mail dell'utente
2050        			UsernameIn				IN		VARCHAR2,						-- (obblig.) Username di autenticazione alla community
2051        			PasswordIn				IN		VARCHAR2,						-- (obblig.) Password di autenticazione alla community
2052        			ConfermaPasswordIn		IN		VARCHAR2,						-- (obblig.) Conferma della password di autenticazione alla community
2053        			IdUserOut				OUT		DMT_USERS.ID_USER%type,				-- Id. dell'utenza creata
2054        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
2055        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
2056        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
2057        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
2058        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
2059        			ErrMsgOut				OUT 		VARCHAR2						-- Messaggio d'errore
2060        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine, altrimenti 0 (in caso di errore o warning)
2061        
2062        	/************* funzione per onvertire i NRI_LIVELLI di una UO dalla forma in cui appaiono in tabella a quella con cui vanno renderizzati nella GUI *************/
2063        	function ConvertNriLivelliUOXGUI(
2064        			NriLivelliUOInTableIn		IN		DMT_STRUTTURA_ORG.NRI_LIVELLI%type,		-- (obblig.) Campo NRI_LIVELLI della UO come compare in atbella
2065        			DefLivelliSOTabIn			IN		DMTO_LIV_GERARCHIA_ESTESA,			-- (obblig.)Definizione di quali sono i livelli della struttura organizzativa cui appartiene la UO
2066        			SepLivelliIn			IN		VARCHAR2,						-- (obblig.)Separatore dei livelli da usare nell GUI
2067        			FlgPaddingLivUOIn			IN		PLS_INTEGER,					-- (valori 1/0/NULL) Se 1 significa che per il livelli numerici va fatto il riempimento con 0 fino alla max lunghezza di un n.ro livello (LengthNroLivelloIn)
2068        			LengthNroLivelloIn		IN		PLS_INTEGER						-- (obblig.)Max lunghezza (come n.ro di cifre o caratterri) di ciascun n.ro livello
2069        			) return VARCHAR2;											-- N.ri livello della UO come devono essere renderizzati nella GUI
2070        
2071        	------- funzione per testare se un UD cartacea (creata o in creazione, nel caso con IdUdIn NULL) può essere assegnata da un determinato utente ad una determinata UO assegnataria
2072        	function TestAssUDConRestrCartaceo(
2073        			IdDominioIn			IN		INTEGER,								-- Id. dominio di lavoro
2074        			IdUserLavoroIn		IN		DMT_USERS.ID_USER%type,					-- Id. dell'utente che assegna
2075        			IdUDIn				IN		VARCHAR2,								-- Id dell'unità doc. da assegnare. Se IdUDIn NULL è un'UD in creazione
2076        			IdUOAssIn			IN		INTEGER,								-- Id. della  UO di nuova assegnatazione da verificare
2077        			FlgUOAssPPIn		IN		PLS_INTEGER,							-- Se 1 indica che la UO di assegnazione è un punto di protocollo
2078        			IdPPUserTabIn		IN		DMTO_ID,								-- Tabella con ID_UO dei punti di protocollo cui è associato utente di lavoro
2079        			IdPPUOUserTabIn		IN		DMTO_ID,								-- Tabella con ID_UO dei punti di protocollo delle UO cui è associato utente di lavoro
2080        			IdPPUDTabIn			IN		DMTO_ID									-- Tabella con ID_UO dei punti di protocollo associati all'assegnatario preesistente dell'unità documentaria
2081        			) return PLS_INTEGER;												-- restituise:
2082        																				-- 1 se l'assegnazione è consentita
2083        																				-- 0 se l'assegnazione NON è consentita
2084        																				-- valori negativi in caso di verifica impossibile a causa di errori
2085        
2086        	/******* funzione per ricercare unità operative e/o scrivanie virtuali/utenti ad essa collegati  ********/
2087        	function TrovaStruttOrgObj(
2088        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
2089        																	-- (obblig). Codice identificativo del token di connessione
2090        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
2091        			FlgPreimpostaFiltroIn		IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1 i filtri e l'ordinamento vengono settati secondo le impostazioni dell'utente di lavoro, altrimenti restano come passati in input
2092        			MatchByIndexerIn			IN		CLOB DEFAULT NULL,				-- Lista delle unità operative, scrivanie viruali e utenti associati alla struttura organizzativa che sono stati trovati dal searcher di Lucene (XML conforme a schema LISTA_STD.xsd)
2093        																	-- Ogni oggetto di Lucene trovato è un tag Riga che contiene le seguenti colonne:
2094        																	-- 1: identificativo dell¿oggetto
2095        																	-- 2: non utilizzata
2096        																	-- 3: flag 1/0 che indica se il match dell'oggetto richiede attributi "protetti", ovvero che possono contenere dati riservati
2097        																	-- 4: score restituito da Lucene
2098        			FlgIndexerOverflowIn		IN		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 significa che il searcher di Lucene ha trovato un numero di oggetti superiore ad un limite massimo consentito.
2099        																	-- Nel caso il flag valga 1 l¿argomento precedente può essere vuoto o se non lo è il suo contenuto viene comunque ignorato
2100        			Flg2ndCallIn			IN		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 indica che si tratta della seconda chiamata alla stored che viene fatta a seguito di una ricerca sottomessa.
2101        																	-- Può essere 1 solo se MatchByIndexerIn contiene degli oggetti.
2102        																	-- E' un flag che serve per velocizzare la ricerca: infatti quando è 1 i filtri vengono ignorati in quanto si considera che il set restituito dall'indicizzatore sia già fatto di oggetti soddisfacenti tutti i filtri; la chiamata alla stored serve solo per verificare l'accesso agli oggetti restituiti dall'indicizzatore, ordinare ed eventualmente paginare il risultato e calcolare tutti i dati degli oggetti da restituire.
2103        			FlgObjTypeIO			IN OUT	VARCHAR2,						-- 1° filtro di ricerca: indica se la ricerca va ristretta alle sole unità operative (UO) o solo utenti con scrivania virtuale (SV) o utenti senza scrivania collegati alla struttura organizzativa(UT)
2104        																	-- Può essere una concatenazione dei valori ammessi separti da ";".
2105        																	-- Se non valorizzato si intende che la ricerca sia su UO e utenti con o senza scrivania
2106        			CercaInUOIO				IN OUT	DMT_STRUTTURA_ORG.ID_UO%type,			-- 2° filtro di ricerca: id. della U.O. in cui effettuare la ricerca. Se non specificato si cerca in tutta la struttura organizzativa
2107        			FlgCercaInSubUOIO			IN OUT	PLS_INTEGER,					-- 3° filtro di ricerca (valori 1/0/NULL): 1 indica che la ricerca va estesa alle sotto-UO della UO CercaInUOIO
2108        																	-- ATTENZIONE: non può essere 1 se CercaInUOIO non è valorizzato
2109        																	--		   Se CercaInUOIO non è valorizzato (ricerca in tutta la struttura organizzativa) solo se il flag è 0 si intende che non si debba ricercare nelle sotto-UO e si mostrano solo le UO di 1° livello gerarchico
2110        			TsRifIn				IN		VARCHAR2 DEFAULT NULL,				-- (nel formato DD/MM/RRRR HH24:MI:SS) Definisce l'istante in cui va presa la "fotografia" della struttura organizzativa in cui si vuole ricercare.
2111        																	-- Se non valorizzato si intende che si vuole ricercare nell'attuale struttura organizzativa
2112        			CriteriAvanzatiIO			IN OUT	NOCOPY CLOB,					-- XML contenente nomi e valori dei filtri su unità operative, scrivanie e utenti (conforme allo schema SezioneCache.xsd).
2113        																	-- Ogni filtro è un tag "Variabile" dell'XML
2114        																	-- I filtri che sono liste hanno nomi (tag Variabile/Nome) che iniziano con @.
2115        																	-- I nomi dei filtri possibili sono:
2116        																	-- IdOrganigramma			Id. dell'organigramma in cui restringere la ricerca
2117        																	--							Se non valorizzato e non ricavabile dalla CercaInUOIO si intende di dover cercare nell'organigramma in vigore - attualmente o alla data specificata in TsRifIn - per l'Ente/AOO collegato: se non si riesce a determinare l'organigramma in cui cercare viene dato errore
2118        																	--  FlgCercaInUOSup			Se 1 e se CercaInUOIO è valorizzato considera/cerca anche nelle UO superiori della UO indicata in CercaInUOIO
2119        																	--  Descrizione				Stringa contenuta nella descrizione delle UO/scrivanie o nel cognome e nome degli utenti da cercare (ricerca case-insensitive in like senza forzare % finale)
2120        																	--	DescrizioneRFT			Parola/e contenuta/e nella descrizione delle UO/scrivanie o nel cognome e nome degli utenti da cercare (ricerca di tipo contains con indici context)
2121        																	--	FlgCercaAnchePerDesUO	Se 1 la ricerca per descrizione, sulle relazioni utente UO cerca anche sulla denominazione delle UO, per cui quanto ricercato può essere sia nel Cognome e Nome/Nome scrivania che nel nome della UO
2122        																	--							Se 1, anche se non spceificato filtro per descrizione, per le relazioni utente- UO le colonne 3 e 8 contengono sia la denominazione UO che quella della relazione utente-UO
2123        																	--	CodTipoUO				Codice che indica il tipo di UO da ricercare (ricerca case-sensitive esatta)
2124        																	--  DesTipoUO				Descrizione del tipo di UO da ricercare (ricerca case-insensitive in like senza forzare % finale)
2125        																	--  LivelloGerarchicoUO		N.ro di livello gerarchico delle UO da ricercare
2126        																	-- 	@CodLivelloUO			Codici che identificano i livelli della UO. Ciscuna riga della lista può contenere una sola colonna:
2127        																	--							1: Codice che identifica la struttura di livello gerarchico i-esimo (dove i è il n.ro di riga) tra quelle che ricadono nella stessa struttura padre (va espresso come si vede nella GUI, ovvero romano se previsto, 0 o -- per indicare che è assente la struttura superiore di livello i-esimo)
2128        																	--	UsernameUtenteCollegatoUO Username a cui devono essere collegate le UO da estrarre
2129        																	--  FlgSoloPuntiProtocollo (valori 1/0) Se 1 l'estrazione estare solo le UO che sono Punti di Protocollo
2130        																	--  FlgSoloUOAttive			(valori 1/0) Se 1 si devono ricercare solo le UO attive al timestamp TsRifIn, se 0 solo quelle cessate al timestamp indicato
2131        																	--	FlgSoloRelUserUOAttive		(valori 1/0) Se 1 si devono ricercare solo le relazioni utente-UO attive al timestamp TsRifIn, se 0 solo quelle cessate al timestamp indicato
2132        																	--	TipoRelUtentiConUO		Indica il/i tipi di relazione che gli utenti da ricercare devono avere all'istante TsRifIn con le UO:
2133        																	--							E' una concatenazione con ; come separatore dei valori:
2134        																	--							A = Appartenenza gerarchica; D = Funzionale, P = Protocollista, L = gestione documentazione assegnata/inviata (NON protocollista)
2135        																	--	IdRuoli					Id. del ruolo/i ricoperti dagli utenti nelle relazioni utente-UO da ricercare
2136        																	--							Possono essere indicati più Id Ruolo separati da , o ;
2137        																	--	IdGruppoAppartenenza		Id. di un gruppo cui devono appartenere (anche non direttamente) le UO/utenti/scrivanie da ricercare
2138        																	-- 	NomeGruppoAppartenenza		Nome di un gruppo cui devono appartenere (anche non direttamente) le UO/utenti/scrivanie da ricercare (ricerca case-insensitive in like senza forzare % finale; il gruppo deve essere individuabile univocamente)
2139        																	--	DataIstituzioneUODa		Inizio intervallo di ricerca sulla data di istituzione delle UO (nel formato del parametro di config. FMT_STD_DATA)
2140        																	--	DataIstituzioneUOA		Fine intervallo di ricerca sulla data di istituzione delle UO (nel formato del parametro di config. FMT_STD_DATA)
2141        																	--	DataSoppressioneUODa		Inizio intervallo di ricerca sulla data di soppressione delle UO (nel formato del parametro di config. FMT_STD_DATA)
2142        																	--	DataSoppressioneUOA		Fine intervallo di ricerca sulla data di soppressione delle UO (nel formato del parametro di config. FMT_STD_DATA)
2143        																	--	Email					Indirizzo email delle UO/utenti da ricercare (ricerca case-insensitive in like)
2144        																	--  ProvCIUo				Ricerca per codice di provenienza (da sistema esterno) della UO (ricerca case-sensitive in like)
2145        																	--  FlgSoloUODichIPA			(valori 1/0) Se 1 si devono ricercare solo le UO che al timestamp TsRifIn risultano dichiarate all'Indice PA
2146        																	--	IdObjToForce			Va valorizzato con Flag UO/SV + id. di una UO/scrivania che deve essere messo comunque nella lista di output
2147        																	--							Può essere una lista di UO/scrivanie separate da , o ;
2148        																	--  IdUOPP					Id. del Punto di Protocollo cui devono essere collegate le UO da estrarre
2149        			CriteriPersonalizzatiIO		IN OUT 	NOCOPY CLOB,		-- Criteri di ricerca sugli attributi custom di unità operative, utenti e scrivanie (XML conforme a schema LISTA_STD.xsd). Se più di uno vengono applicati in AND.
2150        																	-- Ogni criterio è un tag Riga che può contenere le seguenti colonne:
2151        																	--	1) Nome (ATTR_NAME) dell'attributo cui è relativo il criterio
2152        																	--	2) (obblig.) Operatore logico. Valori possibili:
2153        																	--		"uguale" (ricerca esatta)
2154        																	--		"simile a (case-sensitive)" (ricerca case-sensitive in like)
2155        																	--		"simile a (case-insensitive)" (ricerca case-insensitive in like e che ignora i caratteri quali spazi, ., ecc)
2156        																	--		"maggiore" (se attributo numerico o data)
2157        																	--		"maggiore o uguale" (se attributo numerico o data)
2158        																	--		"minore" (se attributo numerico o data)
2159        																	--		"minore o uguale" (se attributo numerico o data)
2160        																	--		"tra" (se attributo numerico o data)
2161        																	--		"non valorizzato"
2162        																	--		"valorizzato"
2163        																	--		"spuntato" (se attributo di tipo casella di spunta)
2164        																	--		"non spuntato" (se attributo di tipo casella di spunta)
2165        																	--	3) 1° valore di confronto (obblig. e gestito solo se l'operatore non ha uno dei seguenti valori: valorizzato, non valorizzato, spuntato, non spuntato) (se l'attributo è numerico deve avere la virgola come separatore dei decimali, se è di tipo data deve essere in uno dei formato dati dai parametri di conf. FMT_STD_DATA e FMT_STD_TIMESTAMP)
2166        																	--	4) 2° valore di confronto (obblig. e gestito solo se l'operatore è "tra") (se l'attributo è numerico deve avere la virgola come separatore dei decimali, se è di tipo data deve essere in uno dei formato dati dai parametri di conf. FMT_STD_DATA e FMT_STD_TIMESTAMP)
2167        																	--	5) Label dell''attributo cui è relativo il criterio (se sotto-attributo di complesso <label del complesso> - <label del sotto-attributo>
2168        			------------- inizio argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
2169        			ColOrderByIO			IN OUT	VARCHAR2,						-- Indica il/i numeri della/e colonna dell'XML (CLOB ResultOut) di output per cui ordinare i record nell'XML stesso (si può ordinare solo per le colonne da 1 a 24 + 39 + 40 +41). Se l'ordinamento è per più colonne queste vanno separate con "," (es: 2; 2,3)
2170        																	-- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul tipo di ordinamento una qualche preimpostazione di sistema/utente ecc.
2171        																	-- se non valorizzato (neppure in output) la lista di record restituita non è ordinata
2172        			FlgDescOrderByIO  		IN OUT	VARCHAR2,						-- E' una stringa di 1 o 0/NULL, tanti quanti le colonne di ordinamento, separati da ",": 1 significa che l'ordinamento per la data colonna deve essere discendente anzichè ascendente (es: 1; 1,0; 1, )
2173        																	-- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul verso di ordinamento una qualche preimpostazione di sistema/utente ecc.
2174        			FlgSenzaPaginazioneIn 		IN 		PLS_INTEGER DEFAULT NULL,            	-- (valori 1/0/NULL) Se 1 l'estrazione non è paginata, altrimenti sì
2175        			NroPaginaIO      			IN OUT	PLS_INTEGER,                  		-- E' il numero della pagina da estrarre; se NULL e l'estrazione è paginata viene estratta la prima pagina
2176           			BachSizeIO				IN OUT	PLS_INTEGER,					-- Indica il massimo n.ro di record da estrarre se l'estrazione non è paginata (FlgSenzaPaginazioneIn=1)
2177        																	-- Indica la dimensione (n.ro di record) della pagina se l'estrazione è paginata (FlgSenzaPaginazioneIn 0 o NULL) e in tal caso se non è valorizzato la dimensione della pagina è quella settata per l'utente di lavoro o è pari al valore del parametro STD_PAGE_NUM_ROW del dominio di lavoro
2178        			OverFlowLimitIn			IN		PLS_INTEGER DEFAULT NULL,			-- E' il n.ro di record soddisfacenti la ricerca superato il quale la funzione deve restituire errore di overflow
2179        			FlgSenzaTotIn			IN		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 significa che non è richiesto come output il totale dei record soddisfacenti la ricerca (se la ricerca è paginata per la prima pagina il totale viene calcolato comunque, per le successive no)
2180        			NroTotRecOut			OUT		PLS_INTEGER,					-- E' il n.ro di record complessivi trovati (valorizzato solo se FlgSenzaTotIn è 0 o NULL o se si estrae la prima pagina)
2181             		NroRecInPaginaOut 		OUT   	PLS_INTEGER,                     		-- E' il numero di record nella pagina (valorizzato solo se l'estrazione è paginata, ovvero se FlgSenzaPaginazioneIn 0 o NULL)
2182        			------------- fine argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
2183        			FlgBatchSearchIn			IN		PLS_INTEGER DEFAULT NULL,					-- (valori 1/0/NULL) Se 1 significa che la stored è utilizzata da un processo batch, altrimenti da un processo online.
2184        																	-- Serve affinchè in caso l'input OverFlowLimitIn non sia valorizzato vengano applicati i limiti di overflow per processo batch o online che sono parametri di configurazione del sistema.
2185        			ColToReturnIn			IN		VARCHAR2 DEFAULT NULL,				-- Stringa con i n.ri delle colonne dell'XML di output ResultOut che si vuole siano presenti.
2186        																	-- Se la stringa è vuota saranno presenti tutte le colonne.
2187        																	-- Le colonne 1 e 7 saranno presenti comunque.
2188        																	-- I n.ri delle varie colonne vanno separati con , o ; e se si vuole indicare un intervallo di colonne gli estremi dell'intervallo vanno separati con - (es: "1-5;7;10" significa colonne da 1 a 5 più le colonne 7 e 10)
2189        			ResultOut				OUT		NOCOPY CLOB, 					-- Lista delle UO/scrivanie/utenti trovati (XML conforme a schema LISTA_STD.xsd)
2190        																	-- Ogni soggetto trovato è un tag Riga che può contenere le seguenti colonne:
2191        																	-- 1:  Flag UO/UT/SV che indica se si tratta di unità operativa (UO), utente senza scrivania (UT), scrivania occupata da utente (SV)
2192        																	-- 2:  Flag UO/UT che indica se si tratta di unità operativa (UO) o utente (UT) con o senza scrivania
2193        																	-- 3:  Denominazione della UO (se colonna 1=UO) o intestazione della scrivania virtuale + descrizione dell'utente e ruolo ricoperto (se colonna 1 = SV) o descrizione dell'utente e ruolo ricoperto (se colonna 1 = UT)
2194        																	-- 4: (valorizzata se colonna 1 = UO) N.ro che indica il livello gerarchico della UO
2195        																	-- 5: (valorizzata se colonna 1 = UO) Codice che indica il tipo della UO o, se il tipo non è valorizzato, n.ro che indica il livello gerarchico della UO
2196        																	-- 6: (valorizzata se colonna 1 = UO) Descrizione del tipo della UO o, se il tipo non è valorizzato, descrizione del livello gerarchico
2197        																	-- 7:  Identificativo della UO (se colonna 1=UO) o della scrivania virtuale (se colonna 1 = SV) o dell'utente (se colonna 1 = UT)
2198        																	-- 8:  Denominazione estesa (cioè incluse le denominazioni delle UO superiori) dell'unità operativa (nel caso di utente o scrivania quella della UO cui è legato l'utente/scrivania seguita da nome della scrivania/utente)
2199        																	-- 9:  Identificativo dell¿unità operativa (nel caso di utente o scrivania è quella cui è legato l'utente/scrivania)
2200        																	-- 10: Identificativo dell'utente (se colonna 1 = UT o SV)
2201        																	-- 11: Data di istituzione della UO (se colonna 1 = UO) o di inizio associazione dell'utente alla UO (nel formato dato dal parametro di config. FMT_STD_DATA)
2202        																	-- 12: Data di soppressione della UO (se colonna 1 = UO) o di fine associazione dell'utente alla UO (nel formato dato dal parametro di config. FMT_STD_DATA)
2203        																	-- 13: Cod. che identifica la UO (se colonna 1 = UO) o l'utente (se colonna 1 = UT o SV) in un sistema esterno di provenienza
2204        																	-- 14: N.ri livello della UO (nel caso di utente o scrivania quelli della UO cui è legato l'utente/scrivania)
2205        																	-- 15: Descrizione della UO (quella cui è collegto l'utente/scrivania se il nodo rappresenta un utente con o senza scrivania)
2206        																	-- 16: Descrizione dell'utente (se utente con o senza scrivania)
2207        																	-- 17: Descrizione della scrivania (solo se trattasi di scrivania)
2208        																	-- 18: Identificativo del ruolo ricoperto dall'utente nella UO (se colonna 1 = UT o SV)
2209        																	-- 19: Descrizione del ruolo ricoperto dall'utente nella UO (se colonna 1 = UT o SV)
2210        																	-- 20: (se colonna 1 = UT o SV) Username dell'utente
2211        																	-- 21: (se colonna 1 = UT o SV) Titolo dell'utente
2212        																	-- 22: (se colonna 1 = UT o SV) Qualifica dell'utente
2213        																	-- 23: (valorizzata se colonna 1 = UO) Competenze della UO
2214        																	-- 24: (valorizzata se colonna 1 = UO) Storia della UO
2215        																	-- 25: (valorizzata se colonna 1 = UO) (1/0) Se 1 indica che la UO è dichiarata all'indice PA
2216        																	-- 26: (valorizzata se colonna 1 = UO)  Data in cui la UO è stata dichiarata all'indice PA (nel formato dato dal parametro di config. FMT_STD_DATA)
2217        																	-- 27: (valorizzata se colonna 1 = UO) Indirizzo della UO
2218        																	-- 28: Riferimenti telefonici della UO/utente
2219        																	-- 29: Indirizzo/i email della UO/utente
2220        																	-- 30: N.ro/i fax della UO/utente
2221        																	-- 31: Tipo di relazione dell'utente con la UO (se colonna 1 = UT o SV). Valori possibili: A = Appartenenza, L = a Lavorare per, D = Delega
2222        																	-- 32: (valori 1/0) Indica se la relazione dell'utente è anche verso le sotto-UO (se colonna 1 = UT o SV)
2223        																	-- 33: (valori 1/0) Indica se la relazione dell'utente è anche verso le altre scrivanie virtuali della UO (se colonna 1 = UT o SV)
2224        																	-- 34: (valori 1/0) Indica se l'utente è il primario tra quelli che ricoprono il suo ruolo nella UO
2225        																	-- 35: (1/0) Se 1 indica che il record è selezionabile per la finalità indicata in FinalitaIn, se 0 che non è selezionabile
2226        																	-- 36: Id. della UO padre (x le UO) o della UO di afferenza (per gli utenti/scrivanie)
2227        																	-- 37: Azioni possibili sulla UO / relazione utente-UO. E' una stringa di 1(=consentita) o 0(=non consentita) in cui ogni posizione corrisponde ad un'azione:
2228        																	--	 1:  Creazione di un nuova sotto-uo
2229        																	--	 2:  Creazione di nuova associazione UO-utente
2230        																	--	 3:  Spostamento in altra UO
2231        																	--	 4:  Incolla di una sotto-UO già esistente
2232        																	--	 5:  Incolla di una associazione UO-utente già esistente
2233        																	--	 6:  Modifica
2234        																	--	 7:  Cancellazione
2235        																	--	 8: Selezione (per la finalità FinalitaIn)
2236        																	-- 38: Denominazione della UO padre (x le UO)  o della UO di afferenza (per gli utenti/scrivanie)
2237        																	-- 39: Score del record restituito dall'indicizzatore (valori interi da 1 a 5) (valorizzato solo se effettuata ricerca full-text)
2238        																	-- 40: Codice rapido dell'utente (se utente con o senza scrivania)
2239        																	-- 41: N.ri livello della UO in modo da ordinare per gerarchia
2240        																	-- 42: Cod. fiscale dell'utente
2241        																	-- 43: Id. della UO o utente in rubrica (se presente)
2242        																	-- 44: Flag 1/0 che indica (se 1) se è consentita l'assegnazione alla UO
2243        																	-- 45: Flag 1/0 che indica (se 1) se è consentito l'invio per conoscenza/notifica alla UO
2244        																	-- 46: Profilo dell'utente (se utente con o senza scrivania)
2245        																	-- 47: Flag 1/0 che indica se il record rappresenta una UO che è un punto di protocollo
2246        																	-- 48: Codice della UO (ultima parte, ovvero campo NRO_LIVELLO)
2247        																	-- 49: N.ro posizione della UO tra le UO sotto lo stesso padre
2248        																	-- 50: Vecchia denominazione della postazione
2249        																	-- 51: (flag 1/0) Indica se la UO/scrivania/utente è un destinatario preferito dell'utente di lavoro
2250        																	-- 52: (flag 1/0) Indica se UO/scrivania/utente che può essere anche assegnataria di cartaceo
2251        																	--				  La colonna viene calcolata solo se FinalitaIn in (MITT_DEST_CARTACEO, MITT_DEST_NO_CARTACEO, MITT_DEST)
2252        																	-- 53: Cognome dell'utente
2253        																	-- 54: Nome dell'utente
2254        																	-- 55: (flag 1/0) Se 1 significa che l'utente è legato alla U.O. anche o solo in quanto protocollista di punto di protocollo cui la UO afferisce
2255        																	-- 56: Livelli e denominazione del/i Punto/i di Protocollo associati alla UO
2256        																	-- 57: Flag 1/0 che indica (se 1) se è consentita l'assegnazione di e-mail alla UO
2257        																	-- 58: Flag 1/0 che indica se il record rappresenta una UO che è un punto di raccolta e-mail
2258        																	-- ATTENZIONE: Se FlgIndexerOverflowIn è pari a 1, qualora la stored non vada a sua volta in overflow, dato che il resultset trovato dalla stored dovrà essere ripassato al searcher di Lucene esso non è paginato indipendentemente dal fatto che l¿apposito input lo richieda.
2259        																	--		   Inoltre nel caso di FlgIndexerOverflowIn pari a 1 dato che dopo il nuovo passaggio per il searcher di Lucene si renderà necessaria una nuova chiamata alla stored solo le colonne 1 e 7 del clob sono valorizzate sicuramente
2260        			PercorsoRicercaXMLOut		OUT	NOCOPY CLOB,						-- Lista con nomi e id. (da quella di livello più alto in giù) delle UO che compongono il percorso in cui si cerca ora (ovvero CercaInUOIO).
2261        																	-- Ogni UO nel percorso corrisponde ad un tag "Riga" con le seguenti colonne:
2262        																	-- 1: Id. della UO
2263        																	-- 2: Denominazione della UO
2264        			DettagliCercaInUOOut	OUT		NOCOPY CLOB,						-- XML contenente attributi e dati della UO CercaInUOIO (XML conforme a schema LISTA_STD.xsd).
2265        																	-- Ogni attributo-dato è una colonna dell'unico tag Riga presente. Gli attributi-colonne sono:
2266        																	-- 1:	Valore fisso 1
2267        																	-- 2:	Identificativo univoco del nodo dell'allbero della struttura organizzativa che rappresenta la UO:
2268        																	--    / se è l'intera AOO o soggetto produttore
2269        																	--	ID_UO se è una UO
2270        																	-- 3:	Descrizione del nodo dell'allbero della struttura organizzativa che rappresenta la UO
2271        																	-- 4: Codice che indica il tipo di nodo dell'allbero della struttura organizzativa che rappresenta la UO (da utilizzare per l'imagine del nodo):
2272        																		-- SP															se è l'intero Ente/Sogg. produttore;
2273        																		-- AOO 														se è un'AOO
2274        																		-- UO_<codice del tipo di UO> 										se è una U.O.;
2275        																	-- 5: Dettagli sul nodo dell'albero della struttura organizzativa che rappresenta la UO (da mostrare come alt dell'immagine del nodo)
2276        																	-- 6: non utilizzata
2277        																	-- 7: Id. della UO
2278        																	-- 8:(valori 1/0) Se 1 indica che la UO root è selezionabile (quando la lista della struttura organizzativa viene richiamato come lista di scelta), se 0 no
2279        																	-- 9: Id. della UO
2280        																	-- 10: non utilizzata
2281        																	-- 11: N.ro di sotto-UO direttamente contenute
2282        																	-- 12: N.ro di utenti direttamente appartenenti
2283        																	-- 13: N.ro di utenti che hanno scrivanie direttamente agganciate
2284        																	-- 14: N.ri livello della UO
2285        																	-- 15: Descrizione della UO
2286        																	-- 16: non utilizzata
2287        																	-- 17: non utilizzata
2288        																	-- 18: Flag SP/AOO/UO che indica se si tratta di intero ente/sogg. produttore (SP), intera AOO (AOO), unità operativa (UO)
2289        																	-- 19: N.ro di livello gerarchico della UO
2290        																	-- 20: Data di istituzione (se UO)
2291        																	-- 21: Data di soppressione (se UO)
2292        																	-- 22: Id. della UO padre
2293        																	-- 23: Azioni possibili sulla UO. E' una stringa di 1(=consentita) o 0(=non consentita) in cui ogni posizione corrisponde ad un'azione:
2294        																	--	 1:  Creazione di un nuova sotto-uo
2295        																	--	 2:  Creazione di nuova associazione UO-utente
2296        																	--	 3:  Spostamento in altra UO
2297        																	--	 4:  Incolla di una sotto-UO già esistente
2298        																	--	 5:  Incolla di una associazione UO-utente già esistente
2299        																	--	 6:  Modifica
2300        																	--	 7:  Cancellazione
2301        																	--	 8: Selezione (per la finalità FinalitaIn)
2302        																	-- 25: Flag 1/0/NULL che (se 1) indica che il numero di oggetti contenuti supera il massimo consentito per esplodere la UO come nodo dell'albero della struttura organizzativa
2303        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
2304        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
2305        			ErrMsgOut				OUT 		VARCHAR2,						-- Messaggio d'errore
2306        			FinalitaIn				IN		VARCHAR2 DEFAULT NULL,				-- Motivo per cui viene chiamata la pagina con l'albero popolato attraverso questa funzione. Valori ammessi:
2307        																				-- ASSEGNAZIONE = Per selezionare la UO/utente/scrivania cui assegnare un documento/folder
2308        																				-- ASS_CARTACEO = Per selezionare la UO/utente/scrivania cui assegnare documantazione cartacea
2309        																				-- ASS_NO_CARTACEO = Per selezionare la UO/utente/scrivania cui assegnare documantazione senza restrizioni del cartaceo
2310        																				-- ASS_EMAIL = Assegnazione di una mail
2311        																				-- MITT_DEST_CARTACEO = Per selezionare la UO/utente/scrivania mittente o destinatario di documantazione cartacea
2312        																				-- MITT_DEST_NO_CARTACEO = Per selezionare la UO/utente/scrivania mittente o destinatario di documantazione NON cartacea
2313        																				-- MITT_DEST = Per selezionare la UO/utente/scrivania mittente o destinatario di documantazione
2314        																				-- INVIO_CC_NOTIFICA = Per selezionare la UO/utente cui inviare per conoscenza/con cui condividere/mandare osservazione su un documento/folder
2315        																				-- ACL = Per selezionare UO/utenti/scrivanie da mettere in un'ACL
2316        																				-- SEL_SV = Selezione di una scrivania per assegnarla ad altro utente/UO
2317        																				-- SEL_UP = Selezione di unità di personale (utenti con o senza scrivania)
2318        																				-- SEL_PUNTI_PROT = selezione di punti di protocollo
2319        																				-- MITTENTE_REG = Mittente di registrazione (a protocollo, repertorio ecc) interna o in uscita: filtra solo i mittenti possibili
2320        																				-- ALTRO = Qualsiasi altra finalità (ad esempio per selezionare UO/utenti da mettere in un gruppo)
2321        			TyObjxFinalitaIn		IN		VARCHAR2 DEFAULT NULL,				-- Dettaglia il tipo di oggetto (F = Folder, U = Unita doc, P = Processo) cui si riferisce la finalità
2322        			IdObjxFinalitaIn		IN		VARCHAR2 DEFAULT NULL,				-- Id dell'oggetto (ID_FOLDER, ID_UD, ID_PROCESS) cui si riferisce la finalità
2323        			RigaTagNameIn			IN		VARCHAR2 DEFAULT NULL,				-- (opzionale) Come rinominare il tag Riga dell'XML ResultOut di output
2324        			ColTagNameIn			IN		DMVA_STRING DEFAULT NULL)			-- (opzionale) Come rinominare i tag delle colonne in alternativa a Colonna Nro=.. nell'XML ResultOut di output
2325        			return PLS_INTEGER;													-- Vale 1 se tutto è andato a buon fine, altrimenti 0
2326        
2327            /******* RETROCOMPATIBILE CON ALBO ************/
2328            /******* funzione per renderizzare la struttura organizzativa o una sua porzione in una struttura ad albero     *******/
2329            /******* Ogni UO e utente collegato ad UO  è un nodo dell'albero.                                 *******/
2330            /******* Ogni nodo ha un identificativo univoco in tutta l'albero                                    *******/
2331            /******* Infatti l'identificativo di un nodo non contiene solo indicazione dell'oggetto che                 *******/
2332            /******* rappresenta ma anche del percorso di navigazione con cui vi si è arrivati                        *******/
2333            /******* La parte dell'identificativo successiva all'ultimo / è l'id. della UO/utente                     *******/
2334            /******* rappresentata dal nodo (preceduto da UT nel caso di utente)                                *******/
2335            /******* Il root node è quello di cui si rappresenta l'alberatura sottostante:                         *******/
2336            /********        se pari a / si intende l'intera struttura organizzativa dell'AOO/Soggetto produttore         *******/
2337            function NavigaStrutturaOrgTree(
2338                    CodIdConnectionTokenIn        IN        DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%type,
2339                                                                            -- (obblig). Codice identificativo del token di connessione
2340                    IdUserLavoroIn            IN        DMT_USERS.ID_USER%type DEFAULT NULL,    -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
2341                    FlgIncludiUtentiIn        IN        PLS_INTEGER DEFAULT NULL,            -- (valori 2/1/0/NULL): se 2 indica che nell'albero vanno mostrare sia le UO e tutti gli utenti collegati (con o senza scrivania), se 1 che vanno mostrate le UO e gli utenti con scrivania, se 0 o NULL solo le UO
2342                    TipoRelUtentiConUOIn        IN        VARCHAR2 DEFAULT NULL,                -- (viene considerato solo se FlgIncludiUtentiIn>0) Indica il/i tipi di relazione che gli utenti da mostrare devono avere all'istante TsRifIn con le UO:
2343                                                                            --  Valori ammessi:
2344                                                                            --  A = Appartenenza;
2345                                                                            --  L = a Lavorare per;
2346                                                                            --  D = Delega
2347                                                                            -- o una loro cancatenazione con ";" come separatore
2348                                                                            -- Se non valorizzato è come se contenesse tutti i valori previsti
2349                    TsRifIn                IN        VARCHAR2 DEFAULT NULL,                -- (nel formato DD/MM/RRRR HH24:MI:SS) Definisce l'istante in cui va presa la "fotografia" della struttura organizzativa da rappresentare tramite l'albero.
2350                                                                            -- Se non valorizzato si intende che si vuole la fotografia attuale della struttura organizzativa
2351                    FlgSoloAttiveIn            IN        PLS_INTEGER DEFAULT 1,                -- (valori 1/0/NULL) Se 1 vengono estratte solo le UO e relazioni utente-UO valide al timestamp TsRifIn
2352                    IdRootNodeIO            IN OUT    VARCHAR2,                        -- Identificativo del nodo root.
2353                                                                            -- Se in input non è valorizzato si intende pari al nodo root definito nelle impostazioni personali dell'utente e se anche questo non è valorizzato si intende pari all'intera struttura organizzativa (ovvero /).
2354                                                                            -- Valori particolari sono:
2355                                                                            -- /         = Intera struttura organizzativa
2356                    IdNodeToExplImplIn        IN         VARCHAR2 DEFAULT NULL,                -- Identificativo del nodo (sottostante il root) da esplodere o chiudere
2357                    FlgExplodeNodeIn             IN        PLS_INTEGER DEFAULT 1,                --(valori 1/0/NULL) se 1 significa che il nodo IdNodeToExplImplIn va esploso, se 0 o NULL il nodo IdNodeToExplImplIn va chiuso
2358                    TreeXMLOut                OUT        NOCOPY CLOB,                    -- Lista con i nodi dell'albero che rappresenta la struttura-organizzativa o una sua porzione-ramo (XML conforme a schema LISTA_STD.xsd)
2359                                                                            -- Ogni folder o unità documentarie è un nodo è un tag Riga che contiene le seguenti colonne:
2360                                                                            -- 1:    Indica il livello del nodo (valori da 1 a n)
2361                                                                            -- 2:    Identificativo univoco del nodo:
2362                                                                            --    / se è l'intera AOO o soggetto produttore
2363                                                                            --    ID_UO se è una UO
2364                                                                            --    <ID_UO>.<ID_USER>.<flag del tipo di relazione (A/L/D)>.<inizio validità relazione nel formato DD/MM/RRRR>.<ID_RUOLO_AMM> se relazione UO-UTENTE
2365                                                                            -- 3:    Descrizione del nodo
2366                                                                            -- 4: Codice che indica il tipo di nodo (da utilizzare per l'imagine del nodo):
2367                                                                                -- SP                                                            se è l'intero Ente/Sogg. produttore;
2368                                                                                -- AOO                                                         se è un'AOO
2369                                                                                -- UO_<codice del tipo di UO>                                         se è una U.O.;
2370                                                                                -- SV_<flag (A/L/D) che indica il tipo di relazione dell'utente con la UO>             se è un utente con scrivania
2371                                                                                -- UT_<flag (L/D) che indica il tipo di relazione dell'utente con la UO>            se è un utente senza scrivania;
2372                                                                            -- 5: Dettagli sul nodo da mostrare come alt della descrizione del nodo
2373                                                                            -- 6:(valori 2/1/-1/0) Indica se il nodo va mostrato esploso (=2), se è esplodibile (ha "figli" in n.ro inferiore ad un limite stabilito) ma non va esploso (=1), se ha "figli" ma non è esplodibile in quanto questi superano il limite stabilito (=-1), se non è esplodibile (=0)
2374                                                                            -- 7: ID_UO o ID_SCRIVANIA o ID_USER della UO, scrivania o utente senza scrivania rappresentato dal nodo
2375                                                                            -- 8:(valori 1/0) Se 1 indica che il nodo è selezionabile (quando l'albero viene richiamato come lista di scelta), se 0 no
2376                                                                            -- 9: ID_UO della UO (quella cui è collegto l'utente/scrivania se il nodo rappresenta un utente con o senza scrivania)
2377                                                                            -- 10: ID_USER dell'utente (se il nodo rappresenta un utente con o senza scrivania)
2378                                                                            -- 11: N.ro di sotto-UO direttamente contenute nel nodo-UO
2379                                                                            -- 12: N.ro di utenti direttamente appartenenti al nodo-UO
2380                                                                            -- 13: N.ro di utenti che hanno scrivanie direttamente agganciate al nodo-UO
2381                                                                            -- 14: N.ri livello della UO (quella cui è collegto l'utente/scrivania se il nodo rappresenta un utente con o senza scrivania)
2382                                                                            -- 15: Descrizione della UO (quella cui è collegto l'utente/scrivania se il nodo rappresenta un utente con o senza scrivania)
2383                                                                            -- 16: Descrizione dell'utente (se utente con o senza scrivania)
2384                                                                            -- 17: Descrizione della scrivania (solo se trattasi di scrivania)
2385                                                                            -- 18:  Flag SP/AOO/UO/UT/SV che indica se si tratta di intero ente/sogg. produttore (SP), intera AOO (AOO), unità operativa (UO), utente senza scrivania (UT), scrivania occupata da utente (SV)
2386                                                                            -- 19: N.ro di livello gerarchico della UO
2387                                                                            -- 20: Data di istituzione (se UO) o di inizio validità relazione utente-UO(se utente con o senza scrivania)
2388                                                                            -- 21: Data di soppressione (se UO) o di fine validità relazione utente-UO(se utente con o senza scrivania)
2389                                                                            -- 22: Id. della UO padre
2390                                                                            -- 23: Azioni possibili sul nodo. E' una stringa di 1(=consentita) o 0(=non consentita) in cui ogni posizione corrisponde ad un'azione:
2391                                                                            --     1:  Creazione di un nuova sotto-uo
2392                                                                            --     2:  Creazione di nuova associazione UO-utente
2393                                                                            --     3:  Spostamento in altra UO
2394                                                                            --     4:  Incolla di una sotto-UO già esistente
2395                                                                            --     5:  Incolla di una associazione UO-utente già esistente
2396                                                                            --     6:  Modifica
2397                                                                            --     7:  Cancellazione
2398                                                                            --     8: Selezione (per la finalità FinalitaIn)
2399                                                                            -- 24: Descrizione del tipo di nodo (da usare x l'alt dell'immagine)
2400        																	-- 25: Cod. rapido dell'utente (se il nodo rappresenta un utente con o senza scrivania)
2401        																	-- 26: Cod. fiscale del utente
2402        																	-- 27: Id. dell'utente o UO in rubrica soggetti (se presente)
2403        																	-- 28: Flag 1/0 che indica (se 1) se è consentita l'assegnazione  documantazione alla UO
2404        																	-- 29: Flag 1/0 che indica (se 1) se è consentito l'invio per conoscenza/notifica alla UO
2405        																	-- 30: Flag 1/0 che indica se il nodo rappresenta una UO che è un punto di protocollo
2406        																	-- 31: Username dell'utente (se il nodo rappresenta un utente con o senza scrivania)
2407        																	-- 32: (flag 1/0) Indica se è un destinatario preferito dell'utente di lavoro
2408        																	-- 33: (flag 1/0) Indica se UO/scrivania/utente che può essere anche assegnataria di cartaceo
2409        																	--				La colonna viene calcolata solo se FinalitaIn in (MITT_DEST_CARTACEO, MITT_DEST_NO_CARTACEO, MITT_DEST)
2410        																	-- 34: (flag 1/0) Se 1 significa che l'utente è legato alla U.O. anche o solo in quanto protocollista di punto di protocollo cui la UO afferisce
2411        																	-- 35: (flag 1/0) Se 1 è una UO che è un punto di raccolta mail
2412        																	-- 36: Flag 1/0 che indica (se 1) se è consentita l'assegnazione di email alla UO
2413                    PercorsoRootNodeXMLOut        OUT        NOCOPY CLOB,                    -- Lista con nomi e id. (da quella di livello più alto in giù) dei nodi che portano all'attuale root-node (lui incluso).
2414                                                                            -- Ogni nodo corrisponde ad un tag "Riga" con le seguenti colonne:
2415                                                                            -- 1: Id. del nodo
2416                                                                            -- 2: Descrizione del nodo
2417                                                                            -- 3: (valori 1/0) Se 1 è un nodo non esplodibile perchè ha troppi nodi figli
2418                    DettagliRootNodeOut        OUT        NOCOPY CLOB,                    -- XML contenente attributi e dati del root node da mostrare nel dettaglio sopra l'albero (XML conforme a schema LISTA_STD.xsd).
2419                                                                            -- Ogni attributo-dato è una colonna dell'unico tag Riga presente. Gli attributi-colonne sono:
2420                                                                            -- 1:    Valore fisso 1
2421                                                                            -- 2:    Identificativo univoco del nodo:
2422                                                                            --    / se è l'intera AOO o soggetto produttore
2423                                                                            --    ID_UO se è una UO
2424                                                                            --    ID_UO/rowid del record di realzione utente-UO se utente con o senza scrivania
2425                                                                            -- 3:    Descrizione del nodo
2426                                                                            -- 4: Codice che indica il tipo di nodo (da utilizzare per l'imagine del nodo):
2427                                                                                -- SP                                                            se è l'intero Ente/Sogg. produttore;
2428                                                                                -- AOO                                                         se è un'AOO
2429                                                                                -- UO_<codice del tipo di UO>                                         se è una U.O.;
2430                                                                                -- SV_<flag (A/L/D) che indica il tipo di relazione dell'utente con la UO>             se è un utente con scrivania
2431                                                                                -- UT_<flag (L/D) che indica il tipo di relazione dell'utente con la UO>            se è un utente senza scrivania;
2432                                                                            -- 5: Dettagli sul nodo da mostrare come alt della descrizione del nodo
2433                                                                            -- 6:(valori 2/1/-1/0) Indica se il nodo va mostrato esploso (=2), se è esplodibile (ha "figli" in n.ro inferiore ad un limite stabilito) ma non va esploso (=1), se ha "figli" ma non è esplodibile in quanto questi superano il limite stabilito (=-1), se non è esplodibile (=0)
2434                                                                            -- 7: ID_UO o ID_SCRIVANIA o ID_USER della UO, scrivania o utente senza scrivania rappresentato dal nodo
2435                                                                            -- 8:(valori 1/0) Se 1 indica che il nodo è selezionabile (quando l'albero viene richiamato come lista di scelta), se 0 no
2436                                                                            -- 9: ID_UO della UO (quella cui è collegto l'utente/scrivania se il nodo rappresenta un utente con o senza scrivania)
2437                                                                            -- 10: ID_USER dell'utente (se il nodo rappresenta un utente con o senza scrivania)
2438                                                                            -- 11: N.ro di sotto-UO direttamente contenute nel nodo-UO
2439                                                                            -- 12: N.ro di utenti direttamente appartenenti al nodo-UO
2440                                                                            -- 13: N.ro di utenti che hanno scrivanie direttamente agganciate al nodo-UO
2441                                                                            -- 14: N.ri livello della UO (quella cui è collegto l'utente/scrivania se il nodo rappresenta un utente con o senza scrivania)
2442                                                                            -- 15: Descrizione della UO (quella cui è collegto l'utente/scrivania se il nodo rappresenta un utente con o senza scrivania)
2443                                                                            -- 16: Descrizione dell'utente (se utente con o senza scrivania)
2444                                                                            -- 17: Descrizione della scrivania (solo se trattasi di scrivania)
2445                                                                            -- 18: Flag SP/AOO/UO/UT/SV che indica se si tratta di intero ente/sogg. produttore (SP), intera AOO (AOO), unità operativa (UO), utente senza scrivania (UT), scrivania occupata da utente (SV)
2446                                                                            -- 19: N.ro di livello gerarchico della UO
2447                                                                            -- 20: Data di istituzione (se UO) o di inizio validità relazione utente-UO(se utente con o senza scrivania)
2448                                                                            -- 21: Data di soppressione (se UO) o di fine validità relazione utente-UO(se utente con o senza scrivania)
2449                                                                            -- 22: Id. della UO padre
2450                                                                            -- 23: Azioni possibili sul nodo. E' una stringa di 1(=consentita) o 0(=non consentita) in cui ogni posizione corrisponde ad un'azione:
2451                                                                            --     1:  Creazione di un nuova sotto-uo
2452                                                                            --     2:  Creazione di nuova associazione UO-utente
2453                                                                            --     3:  Spostamento in altra UO
2454                                                                            --     4:  Incolla di una sotto-UO già esistente
2455                                                                            --     5:  Incolla di una associazione UO-utente già esistente
2456                                                                            --     6:  Modifica
2457                                                                            --     7:  Cancellazione
2458                                                                            --     8: Selezione (per la finalità FinalitaIn)
2459                                                                            -- 24: Descrizione del tipo di nodo (da usare x l'alt dell'immagine)
2460                                                                            -- 25: Flag 1/0 che (se 1) indica che il numero di oggetti contenuti supera il massimo consentito per esplodere il nodo
2461                    ErrContextOut            OUT        VARCHAR2,                        -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
2462                    ErrCodeOut                OUT        PLS_INTEGER,                    -- N.ro errore di uscita
2463                    ErrMsgOut                OUT         VARCHAR2,                        -- Messaggio d'errore
2464                    FinalitaIn                IN        VARCHAR2 DEFAULT NULL)                -- Motivo per cui viene chiamata la pagina con l'albero popolato attraverso questa funzione. Valori ammessi:
2465                                                                            -- ASSEGNAZIONE = Per selezionare la UO/utente cui assegnare un documento/folder (in questo caso l'albero mostra solo UO attive)
2466                                                                            -- ACL = Per selezionare UO/utenti da mettere in un'ACL
2467                                                                            -- SEL_SV = Selezione di una scrivania per assegnarla ad altro utente/UO
2468                                                                            -- ALTRO = Qualsiasi altra finalità (ad esempio per selezionare UO/utenti da mettere in un gruppo)
2469                    return PLS_INTEGER;                                            -- Vale 1 se tutto è andato a buon fine, altrimenti 0
2470        
2471        
2472        	/******* funzione per renderizzare un'organigramma o una sua porzione in una struttura ad albero 	*******/
2473        	/******* Ogni UO e utente collegato ad UO  è un nodo dell'albero. 								*******/
2474        	/******* Ogni nodo ha un identificativo univoco in tutto l'albero								*******/
2475        	/******* L'identificativo di un nodo non contiene solo indicazione dell'oggetto che 			*******/
2476        	/******* rappresenta ma anche del percorso di navigazione con cui vi si è arrivati				*******/
2477        	/******* La parte dell'identificativo successiva all'ultimo / è l'id. della UO/utente 			*******/
2478        	/******* rappresentata dal nodo (preceduto da UT nel caso di utente)							*******/
2479        	/******* Il root node è quello di cui si rappresenta l'alberatura sottostante: 					*******/
2480        	/********		se pari a / si intende l'intero organigramma dell'AOO/Soggetto produttore 		*******/
2481        	function NavigaStrutturaOrgTree(
2482        			CodIdConnectionTokenIn		IN		DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%type,
2483        																	-- (obblig). Codice identificativo del token di connessione
2484        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
2485        			FlgIncludiUtentiIn		IN		PLS_INTEGER DEFAULT NULL,			-- (valori 2/1/0/NULL): se 2 indica che nell'albero vanno mostrare sia le UO e tutti gli utenti collegati (con o senza scrivania), se 1 che vanno mostrate le UO e gli utenti con scrivania, se 0 o NULL solo le UO
2486        			TipoRelUtentiConUOIn		IN		VARCHAR2 DEFAULT NULL,				-- (viene considerato solo se FlgIncludiUtentiIn>0) Indica il/i tipi di relazione che gli utenti da mostrare devono avere all'istante TsRifIn con le UO:
2487        																	--  Valori ammessi:
2488        																	--  A = Appartenenza gerarchica;
2489        																	--  D = Funzionale,
2490        																	--  P = Protocollista,
2491        																	--  L = gestione documentazione assegnata/inviata (NON protocollista)
2492        																	-- o una loro cancatenazione con ";" come separatore
2493        																	-- Se non valorizzato è come se contenesse tutti i valori previsti
2494        			TsRifIn				IN		VARCHAR2 DEFAULT NULL,				-- (nel formato DD/MM/RRRR HH24:MI:SS) Definisce l'istante in cui va presa la "fotografia" della struttura organizzativa da rappresentare tramite l'albero.
2495        																	-- Se non valorizzato si intende che si vuole la fotografia attuale della struttura organizzativa
2496        			FlgSoloAttiveIn			IN		PLS_INTEGER DEFAULT 1,				-- (valori 1/0/NULL) Se 1 vengono estratte solo le UO e relazioni utente-UO valide al timestamp TsRifIn
2497        			IdRootNodeIO			IN OUT	VARCHAR2,				-- Identificativo del nodo root.
2498        																	-- Se in input non è valorizzato si intende pari al nodo root definito nelle impostazioni personali dell'utente e se anche questo non è valorizzato si intende pari all'intera struttura organizzativa (ovvero /).
2499        																	-- Valori particolari sono:
2500        																	-- / 		= Intero organigramma
2501        			IdOrganigrammaIO		IN OUT	DMT_ORGANIGRAMMI.ID_ORGANIGRAMMA%type,
2502        																	-- IN INPUT: Id. dell'organigramma di cui mostrare i nodi
2503        																	-- può non essere specificato se IdRootNodeIO è valorizzato in input e diverso da /
2504        																	-- Se non specificato e non ricavabile da IdRootNodeIO l'organigramma che si carica è quello in vigore - attualmente o alla data specificata in TsRifIn - per l'Ente/AOO cui si è collegati (e se questo non è determinabile viene dato errore)
2505        																	-- IN OUTPUT è l'ID dell'organigramma rapparesentato dall'albero
2506        			IdNodeToExplImplIn		IN 		VARCHAR2 DEFAULT NULL,				-- Identificativo del nodo (sottostante il root) da esplodere o chiudere
2507        			FlgExplodeNodeIn 			IN		PLS_INTEGER DEFAULT 1,				--(valori 1/0/NULL) se 1 significa che il nodo IdNodeToExplImplIn va esploso, se 0 o NULL il nodo IdNodeToExplImplIn va chiuso
2508        			TreeXMLOut				OUT		NOCOPY CLOB,					-- Lista con i nodi dell'albero che rappresenta la struttura-organizzativa o una sua porzione-ramo (XML conforme a schema LISTA_STD.xsd)
2509        																	-- Ogni nodo è un tag Riga che contiene le seguenti colonne:
2510        																	-- 1:	Indica il livello del nodo (valori da 1 a n)
2511        																	-- 2:	Identificativo univoco del nodo:
2512        																	--  / se è l'intero organigramma dell'AOO o del soggetto produttore
2513        																	--	se è una UO: ID_UO preceduto dagli ID_UO delle UO gerarchicamente superiori (tutti gli ID_UO precedeuti da /)
2514        																	--	se è una scrivania/utente: <ID_NODO della UO>.<ID_USER>.<flag del tipo di relazione (A/L/D)>.<inizio validità relazione nel formato DD/MM/RRRR>.<ID_RUOLO_AMM> se relazione UO-UTENTE
2515        																	-- 3:	Descrizione del nodo
2516        																	-- 4: Codice che indica il tipo di nodo (da utilizzare per l'imagine del nodo):
2517        																		-- SP															se è l'intero Ente/Sogg. produttore;
2518        																		-- AOO 														se è un'AOO
2519        																		-- UO_<codice del tipo di UO> 										se è una U.O.;
2520        																		-- SV_<flag (A/L/D) che indica il tipo di relazione dell'utente con la UO> 			se è un utente con scrivania
2521        																		-- UT_<flag (L/D) che indica il tipo di relazione dell'utente con la UO>			se è un utente senza scrivania;
2522        																	-- 5: Dettagli sul nodo da mostrare come alt della descrizione del nodo
2523        																	-- 6:(valori 2/1/-1/0) Indica se il nodo va mostrato esploso (=2), se è esplodibile (ha "figli" in n.ro inferiore ad un limite stabilito) ma non va esploso (=1), se ha "figli" ma non è esplodibile in quanto questi superano il limite stabilito (=-1), se non è esplodibile (=0)
2524        																	-- 7: ID_UO o ID_SCRIVANIA o ID_USER della UO, scrivania o utente senza scrivania rappresentato dal nodo
2525        																	-- 8:(valori 1/0) Se 1 indica che il nodo è selezionabile (quando l'albero viene richiamato come lista di scelta), se 0 no
2526        																	-- 9: ID_UO della UO (quella cui è collegto l'utente/scrivania se il nodo rappresenta un utente con o senza scrivania)
2527        																	-- 10: ID_USER dell'utente (se il nodo rappresenta un utente con o senza scrivania)
2528        																	-- 11: N.ro di sotto-UO direttamente contenute nel nodo-UO
2529        																	-- 12: N.ro di utenti direttamente appartenenti al nodo-UO
2530        																	-- 13: N.ro di utenti che hanno scrivanie direttamente agganciate al nodo-UO
2531        																	-- 14: N.ri livello della UO (quella cui è collegto l'utente/scrivania se il nodo rappresenta un utente con o senza scrivania)
2532        																	-- 15: Descrizione della UO (quella cui è collegto l'utente/scrivania se il nodo rappresenta un utente con o senza scrivania)
2533        																	-- 16: Descrizione dell'utente (se utente con o senza scrivania)
2534        																	-- 17: Descrizione della scrivania (solo se trattasi di scrivania)
2535        																	-- 18:  Flag SP/AOO/UO/UT/SV che indica se si tratta di intero ente/sogg. produttore (SP), intera AOO (AOO), unità operativa (UO), utente senza scrivania (UT), scrivania occupata da utente (SV)
2536        																	-- 19: N.ro di livello gerarchico della UO
2537        																	-- 20: Data di istituzione (se UO) o di inizio validità relazione utente-UO(se utente con o senza scrivania)
2538        																	-- 21: Data di soppressione (se UO) o di fine validità relazione utente-UO(se utente con o senza scrivania)
2539        																	-- 22: Id. della UO padre
2540        																	-- 23: Azioni possibili sul nodo. E' una stringa di 1(=consentita) o 0(=non consentita) in cui ogni posizione corrisponde ad un'azione:
2541        																	--	 1:  Creazione di un nuova sotto-uo
2542        																	--	 2:  Creazione di nuova associazione UO-utente
2543        																	--	 3:  Spostamento in altra UO
2544        																	--	 4:  Incolla di una sotto-UO già esistente
2545        																	--	 5:  Incolla di una associazione UO-utente già esistente
2546        																	--	 6:  Modifica
2547        																	--	 7:  Cancellazione
2548        																	--	 8: Selezione (per la finalità FinalitaIn)
2549        																	-- 24: Descrizione del tipo di nodo (da usare x l'alt dell'immagine)
2550        																	-- 25: Cod. rapido dell'utente (se il nodo rappresenta un utente con o senza scrivania)
2551        																	-- 26: Cod. fiscale del utente
2552        																	-- 27: Id. dell'utente o UO in rubrica soggetti (se presente)
2553        																	-- 28: Flag 1/0 che indica (se 1) se è consentita l'assegnazione di documantazione alla UO
2554        																	-- 29: Flag 1/0 che indica (se 1) se è consentito l'invio per conoscenza/notifica alla UO
2555        																	-- 30: Flag 1/0 che indica se il nodo rappresenta una UO che è un punto di protocollo
2556        																	-- 31: Username dell'utente (se il nodo rappresenta un utente con o senza scrivania)
2557        																	-- 32: (flag 1/0) Indica se è un destinatario preferito dell'utente di lavoro
2558        																	-- 33: (flag 1/0) Indica se UO/scrivania/utente che può essere anche assegnataria di cartaceo
2559        																	--				La colonna viene calcolata solo se FinalitaIn in (MITT_DEST_CARTACEO, MITT_DEST_NO_CARTACEO, MITT_DEST)
2560        																	-- 34: (flag 1/0) Se 1 significa che l'utente è legato alla U.O. anche o solo in quanto protocollista di punto di protocollo cui la UO afferisce
2561        																	-- 35: (flag 1/0) Se 1 è una UO che è un punto di raccolta mail
2562        																	-- 36: Flag 1/0 che indica (se 1) se è consentita l'assegnazione di email alla UO
2563        			PercorsoRootNodeXMLOut		OUT		NOCOPY CLOB,		-- Lista con nomi e id. (da quella di livello più alto in giù) dei nodi che portano all'attuale root-node (lui incluso).
2564        																	-- Ogni nodo corrisponde ad un tag "Riga" con le seguenti colonne:
2565        																	-- 1: Id. del nodo
2566        																	-- 2: Nome del nodo
2567        																	-- 3: Id. della UO che il nodo rappresenta
2568        																	-- 4: (valori 1/0) Se 1 è un nodo non esplodibile perchè ha troppi nodi figli
2569        			                                                        -- 5: N.ri livello della UO (quella cui è collegto l'utente/scrivania se il nodo rappresenta un utente con o senza scrivania)
2570        			DettagliRootNodeOut		OUT		NOCOPY CLOB,			-- XML contenente attributi e dati del root node da mostrare nel dettaglio sopra l'albero (XML conforme a schema LISTA_STD.xsd).
2571        																	-- viene restituito SOLO se il parametro compatibilty_level<=2
2572        																	-- Ogni attributo-dato è una colonna dell'unico tag Riga presente. Gli attributi-colonne sono:
2573        																	-- 1:	Valore fisso 1
2574        																	-- 2:	Identificativo univoco del nodo:
2575        																	--    / se è l'intera AOO o soggetto produttore
2576        																	--	ID_UO se è una UO
2577        																	--	ID_UO/rowid del record di realzione utente-UO se utente con o senza scrivania
2578        																	-- 3:	Descrizione del nodo
2579        																	-- 4: Codice che indica il tipo di nodo (da utilizzare per l'imagine del nodo):
2580        																		-- SP															se è l'intero Ente/Sogg. produttore;
2581        																		-- AOO 														se è un'AOO
2582        																		-- UO_<codice del tipo di UO> 										se è una U.O.;
2583        																		-- SV_<flag (A/L/D) che indica il tipo di relazione dell'utente con la UO> 			se è un utente con scrivania
2584        																		-- UT_<flag (L/D) che indica il tipo di relazione dell'utente con la UO>			se è un utente senza scrivania;
2585        																	-- 5: Dettagli sul nodo da mostrare come alt della descrizione del nodo
2586        																	-- 6:(valori 2/1/-1/0) Indica se il nodo va mostrato esploso (=2), se è esplodibile (ha "figli" in n.ro inferiore ad un limite stabilito) ma non va esploso (=1), se ha "figli" ma non è esplodibile in quanto questi superano il limite stabilito (=-1), se non è esplodibile (=0)
2587        																	-- 7: ID_UO o ID_SCRIVANIA o ID_USER della UO, scrivania o utente senza scrivania rappresentato dal nodo
2588        																	-- 8:(valori 1/0) Se 1 indica che il nodo è selezionabile (quando l'albero viene richiamato come lista di scelta), se 0 no
2589        																	-- 9: ID_UO della UO (quella cui è collegto l'utente/scrivania se il nodo rappresenta un utente con o senza scrivania)
2590        																	-- 10: ID_USER dell'utente (se il nodo rappresenta un utente con o senza scrivania)
2591        																	-- 11: N.ro di sotto-UO direttamente contenute nel nodo-UO
2592        																	-- 12: N.ro di utenti direttamente appartenenti al nodo-UO
2593        																	-- 13: N.ro di utenti che hanno scrivanie direttamente agganciate al nodo-UO
2594        																	-- 14: N.ri livello della UO (quella cui è collegto l'utente/scrivania se il nodo rappresenta un utente con o senza scrivania)
2595        																	-- 15: Descrizione della UO (quella cui è collegto l'utente/scrivania se il nodo rappresenta un utente con o senza scrivania)
2596        																	-- 16: Descrizione dell'utente (se utente con o senza scrivania)
2597        																	-- 17: Descrizione della scrivania (solo se trattasi di scrivania)
2598        																	-- 18: Flag SP/AOO/UO/UT/SV che indica se si tratta di intero ente/sogg. produttore (SP), intera AOO (AOO), unità operativa (UO), utente senza scrivania (UT), scrivania occupata da utente (SV)
2599        																	-- 19: N.ro di livello gerarchico della UO
2600        																	-- 20: Data di istituzione (se UO) o di inizio validità relazione utente-UO(se utente con o senza scrivania)
2601        																	-- 21: Data di soppressione (se UO) o di fine validità relazione utente-UO(se utente con o senza scrivania)
2602        																	-- 22: Id. della UO padre
2603        																	-- 23: Azioni possibili sul nodo. E' una stringa di 1(=consentita) o 0(=non consentita) in cui ogni posizione corrisponde ad un'azione:
2604        																	--	 1:  Creazione di un nuova sotto-uo
2605        																	--	 2:  Creazione di nuova associazione UO-utente
2606        																	--	 3:  Spostamento in altra UO
2607        																	--	 4:  Incolla di una sotto-UO già esistente
2608        																	--	 5:  Incolla di una associazione UO-utente già esistente
2609        																	--	 6:  Modifica
2610        																	--	 7:  Cancellazione
2611        																	--	 8: Selezione (per la finalità FinalitaIn)
2612        																	-- 24: Descrizione del tipo di nodo (da usare x l'alt dell'immagine)
2613        																	-- 25: Flag 1/0 che (se 1) indica che il numero di oggetti contenuti supera il massimo consentito per esplodere il nodo
2614        			ErrContextOut			OUT		VARCHAR2,				-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
2615        			ErrCodeOut				OUT		PLS_INTEGER,			-- N.ro errore di uscita
2616        			ErrMsgOut				OUT 		VARCHAR2,			-- Messaggio d'errore
2617        			FinalitaIn				IN		VARCHAR2 DEFAULT NULL,	-- Motivo per cui viene chiamata la pagina con l'albero popolato attraverso questa funzione. Valori ammessi:
2618        																	-- ASSEGNAZIONE = Per selezionare la UO/utente cui assegnare un documento/folder (in questo caso l'albero mostra solo UO attive)
2619        																	-- ASS_CARTACEO = Per selezionare la UO/utente/scrivania cui assegnare documantazione cartacea
2620        																	-- ASS_NO_CARTACEO = Per selezionare la UO/utente/scrivania cui assegnare documantazione senza restrizioni del cartaceo
2621        																	-- ASS_EMAIL = Assegnazione di una mail
2622        																	-- MITT_DEST_CARTACEO = Per selezionare la UO/utente/scrivania mittente o destinatario di documantazione cartacea
2623        																	-- MITT_DEST_NO_CARTACEO = Per selezionare la UO/utente/scrivania mittente o destinatario di documantazione NON cartacea
2624        																	-- MITT_DEST = Per selezionare la UO/utente/scrivania mittente o destinatario di documantazione
2625        																	-- INVIO_CC_NOTIFICA = Per selezionare la UO/utente cui inviare per conoscenza/con cui condividere/mandare osservazione su un documento/folder (in questo caso l'albero mostra solo UO attive)
2626        																	-- ACL = Per selezionare UO/utenti da mettere in un'ACL
2627        																	-- SEL_SV = Selezione di una scrivania per assegnarla ad altro utente/UO
2628        																	-- SEL_UP = Selezione di unità di personale (utenti con o senza scrivania)
2629        																	-- SEL_PUNTI_PROT = selezione di punti di protocollo
2630        																	-- ALTRO = Qualsiasi altra finalità (ad esempio per selezionare UO/utenti da mettere in un gruppo)
2631        			FlgNoDatiRootNodeIn			IN	PLS_INTEGER DEFAULT NULL,
2632        																	-- (valori 1/0/NULL) Se 1 indica che non serve che siano calcolati e restituiti in output PercorsoRootNodeXMLOut e DettagliRootNodeOut
2633        			TyObjxFinalitaIn		IN		VARCHAR2 DEFAULT NULL,	-- Dettaglia il tipo di oggetto (F = Folder, U = Unita doc, P = Processo) cui si riferisce la finalità
2634        			IdObjxFinalitaIn		IN		VARCHAR2 DEFAULT NULL	-- Id dell'oggetto (ID_FOLDER, ID_UD, ID_PROCESS) cui si riferisce la finalità
2635        			)
2636        			return PLS_INTEGER;										-- Vale 1 se tutto è andato a buon fine, altrimenti 0
2637        
2638        	/******* funzione per renderizzare i nodi figli di un nodo dell'albero del organigramma che abbia figli (i.e. una UO/struttura)	*******/
2639        	function ExplodeTreeNode(
2640        			CodIdConnectionTokenIn	IN		DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%type,
2641        																	-- (obblig). Codice identificativo del token di connessione
2642        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,
2643        																	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
2644        			FlgIncludiUtentiIn		IN		PLS_INTEGER DEFAULT NULL,			-- (valori 2/1/0/NULL): se 2 indica che nell'albero vanno mostrare sia le UO e tutti gli utenti collegati (con o senza scrivania), se 1 che vanno mostrate le UO e gli utenti con scrivania, se 0 o NULL solo le UO
2645        			TipoRelUtentiConUOIn		IN		VARCHAR2 DEFAULT NULL,				-- (viene considerato solo se FlgIncludiUtentiIn>0) Indica il/i tipi di relazione che gli utenti da mostrare devono avere all'istante TsRifIn con le UO:
2646        																	--  Valori ammessi:
2647        																	--  A = Appartenenza gerarchica;
2648        																	--  D = Funzionale,
2649        																	--  P = Protocollista,
2650        																	--  L = gestione documentazione assegnata/inviata (NON protocollista)
2651        																	-- o una loro cancatenazione con ";" come separatore
2652        																	-- Se non valorizzato è come se contenesse tutti i valori previsti
2653        			TsRifIn				IN		VARCHAR2 DEFAULT NULL,		-- (nel formato DD/MM/RRRR HH24:MI:SS) Definisce l'istante in cui va presa la "fotografia" della struttura organizzativa da rappresentare tramite l'albero.
2654        																	-- Se non valorizzato si intende che si vuole la fotografia attuale della struttura organizzativa
2655        			FlgSoloAttiveIn			IN		PLS_INTEGER DEFAULT 1,	-- (valori 1/0/NULL) Se 1 vengono estratte solo le UO e relazioni utente-UO valide al timestamp TsRifIn
2656        			IdOrganigrammaIn		IN		DMT_ORGANIGRAMMI.ID_ORGANIGRAMMA%type,
2657        																	-- (obblig.) Identificativo dell'organigramma di cui esplodere il nodo
2658        			IdNodeToExplodeIn		IN 		VARCHAR2 DEFAULT NULL,	-- (obblig.) Identificativo del nodo da esplodere
2659        			TreeXMLOut				OUT		NOCOPY CLOB,			-- Lista con i nodi figli del nodo da esplodere (XML conforme a schema LISTA_STD.xsd)
2660        																	-- Ogni nodo è un tag Riga che contiene le seguenti colonne:
2661        																	-- 1:	Indica il livello del nodo (valori da 1 a n)
2662        																	-- 2:	Identificativo univoco del nodo:
2663        																	--  / se è l'intero organigramma dell'AOO o del soggetto produttore
2664        																	--	se è una UO: ID_UO preceduto dagli ID_UO delle UO gerarchicamente superiori (tutti gli ID_UO precedeuti da /)
2665        																	--	se è una scrivania/utente: <ID_NODO della UO>.<ID_USER>.<flag del tipo di relazione (A/L/D)>.<inizio validità relazione nel formato DD/MM/RRRR>.<ID_RUOLO_AMM> se relazione UO-UTENTE
2666        																	-- 3:	Descrizione del nodo
2667        																	-- 4: Codice che indica il tipo di nodo (da utilizzare per l'imagine del nodo):
2668        																		-- UO_<codice del tipo di UO> 										se è una U.O.;
2669        																		-- SV_<flag (A/L/D) che indica il tipo di relazione dell'utente con la UO> 			se è un utente con scrivania
2670        																		-- UT_<flag (L/D) che indica il tipo di relazione dell'utente con la UO>			se è un utente senza scrivania;
2671        																	-- 5: Dettagli sul nodo da mostrare come alt della descrizione del nodo
2672        																	-- 6:(valori 2/1/-1/0) Indica se il nodo va mostrato esploso (=2), se è esplodibile (ha "figli" in n.ro inferiore ad un limite stabilito) ma non va esploso (=1), se ha "figli" ma non è esplodibile in quanto questi superano il limite stabilito (=-1), se non è esplodibile (=0)
2673        																	-- 7: ID_UO o ID_SCRIVANIA o ID_USER della UO, scrivania o utente senza scrivania rappresentato dal nodo
2674        																	-- 8:(valori 1/0) Se 1 indica che il nodo è selezionabile (quando l'albero viene richiamato come lista di scelta), se 0 no
2675        																	-- 9: ID_UO della UO (quella cui è collegto l'utente/scrivania se il nodo rappresenta un utente con o senza scrivania)
2676        																	-- 10: ID_USER dell'utente (se il nodo rappresenta un utente con o senza scrivania)
2677        																	-- 11: N.ro di sotto-UO direttamente contenute nel nodo-UO
2678        																	-- 12: N.ro di utenti direttamente appartenenti al nodo-UO
2679        																	-- 13: N.ro di utenti che hanno scrivanie direttamente agganciate al nodo-UO
2680        																	-- 14: N.ri livello della UO (quella cui è collegto l'utente/scrivania se il nodo rappresenta un utente con o senza scrivania)
2681        																	-- 15: Descrizione della UO (quella cui è collegto l'utente/scrivania se il nodo rappresenta un utente con o senza scrivania)
2682        																	-- 16: Descrizione dell'utente (se utente con o senza scrivania)
2683        																	-- 17: Descrizione della scrivania (solo se trattasi di scrivania)
2684        																	-- 18:  Flag SP/AOO/UO/UT/SV che indica se si tratta di intero ente/sogg. produttore (SP), intera AOO (AOO), unità operativa (UO), utente senza scrivania (UT), scrivania occupata da utente (SV)
2685        																	-- 19: N.ro di livello gerarchico della UO
2686        																	-- 20: Data di istituzione (se UO) o di inizio validità relazione utente-UO(se utente con o senza scrivania)
2687        																	-- 21: Data di soppressione (se UO) o di fine validità relazione utente-UO(se utente con o senza scrivania)
2688        																	-- 22: Id. della UO padre
2689        																	-- 23: Azioni possibili sul nodo. E' una stringa di 1(=consentita) o 0(=non consentita) in cui ogni posizione corrisponde ad un'azione:
2690        																	--	 1:  Creazione di un nuova sotto-uo
2691        																	--	 2:  Creazione di nuova associazione UO-utente
2692        																	--	 3:  Spostamento in altra UO
2693        																	--	 4:  Incolla di una sotto-UO già esistente
2694        																	--	 5:  Incolla di una associazione UO-utente già esistente
2695        																	--	 6:  Modifica
2696        																	--	 7:  Cancellazione
2697        																	--	 8: Selezione (per la finalità FinalitaIn)
2698        																	-- 24: Descrizione del tipo di nodo (da usare x l'alt dell'immagine)
2699        																	-- 25: Cod. rapido dell'utente (se il nodo rappresenta un utente con o senza scrivania)
2700        																	-- 26: Cod. fiscale del utente
2701        																	-- 27: Id. dell'utente o UO in rubrica soggetti (se presente)
2702        																	-- 28: Flag 1/0 che indica (se 1) se è consentita l'assegnazione di documantazione alla UO
2703        																	-- 29: Flag 1/0 che indica (se 1) se è consentito l'invio per conoscenza/notifica alla UO
2704        																	-- 30: Flag 1/0 che indica se il nodo rappresenta una UO che è un punto di protocollo
2705        																	-- 31: Username dell'utente (se il nodo rappresenta un utente con o senza scrivania)
2706        																	-- 32: (flag 1/0) Indica se è un destinatario preferito dell'utente di lavoro
2707        																	-- 33: (flag 1/0) Indica se UO/scrivania/utente che può essere anche assegnataria di cartaceo
2708        																	--				La colonna viene calcolata solo se FinalitaIn in (MITT_DEST_CARTACEO, MITT_DEST_NO_CARTACEO, MITT_DEST)
2709        																	-- 34: (flag 1/0) Se 1 significa che l'utente è legato alla U.O. anche o solo in quanto protocollista di punto di protocollo cui la UO afferisce
2710        																	-- 35: (flag 1/0) Se 1 è una UO che è un punto di raccolta mail
2711        																	-- 36: Flag 1/0 che indica (se 1) se è consentita l'assegnazione di email alla UO
2712        			ErrContextOut			OUT		VARCHAR2,				-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
2713        			ErrCodeOut				OUT		PLS_INTEGER,			-- N.ro errore di uscita
2714        			ErrMsgOut				OUT 		VARCHAR2,			-- Messaggio d'errore
2715        			FinalitaIn				IN		VARCHAR2 DEFAULT NULL,	-- Motivo per cui viene chiamata la pagina con l'albero dell'organigramma. Valori ammessi:
2716        																	-- ASSEGNAZIONE = Per selezionare la UO/utente cui assegnare un documento/folder (in questo caso l'albero mostra solo UO attive)
2717        																	-- ASS_CARTACEO = Per selezionare la UO/utente/scrivania cui assegnare documantazione cartacea
2718        																	-- ASS_NO_CARTACEO = Per selezionare la UO/utente/scrivania cui assegnare documantazione senza restrizioni del cartaceo
2719        																	-- ASS_EMAIL = Assegnazione di una mail
2720        																	-- MITT_DEST_CARTACEO = Per selezionare la UO/utente/scrivania mittente o destinatario di documantazione cartacea
2721        																	-- MITT_DEST_NO_CARTACEO = Per selezionare la UO/utente/scrivania mittente o destinatario di documantazione NON cartacea
2722        																	-- MITT_DEST = Per selezionare la UO/utente/scrivania mittente o destinatario di documantazione
2723        																	-- INVIO_CC_NOTIFICA = Per selezionare la UO/utente cui inviare per conoscenza/con cui condividere/mandare osservazione su un documento/folder (in questo caso l'albero mostra solo UO attive)
2724        																	-- ACL = Per selezionare UO/utenti da mettere in un'ACL
2725        																	-- SEL_SV = Selezione di una scrivania per assegnarla ad altro utente/UO
2726        																	-- SEL_UP = Selezione di unità di personale (utenti con o senza scrivania)
2727        																	-- SEL_PUNTI_PROT = selezione di punti di protocollo
2728        																	-- ALTRO = Qualsiasi altra finalità (ad esempio per selezionare UO/utenti da mettere in un gruppo)
2729        			TyObjxFinalitaIn		IN		VARCHAR2 DEFAULT NULL,	-- Dettaglia il tipo di oggetto (F = Folder, U = Unita doc, P = Processo) cui si riferisce la finalità
2730        			IdObjxFinalitaIn		IN		VARCHAR2 DEFAULT NULL	-- Id dell'oggetto (ID_FOLDER, ID_UD, ID_PROCESS) cui si riferisce la finalità
2731        			) return PLS_INTEGER;									-- Vale 1 se tutto è andato a buon fine, altrimenti 0
2732        
2733        	/****** funzione per ottenere l'ID_NODO del nodo che rappresenta una certa struttura/UO nell'albero che rappresenta l'organigramma cui la UO/struttura appartiene	****/
2734        	function GetIdNodo (
2735        			CodIdConnectionTokenIn	IN		DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%type,
2736        																			-- (obblig). Codice identificativo del token di connessione
2737        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,
2738        																			-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
2739        			IdUOIn 					IN		DMT_STRUTTURA_ORG.ID_UO%type,	-- Id. della UO/struttura
2740        			IdOrganigrammaIn		IN		DMT_ORGANIGRAMMI.ID_ORGANIGRAMMA%type,
2741        																			-- (obblig.) Id. dell'organigramma
2742        			IdNodoOut				OUT		VARCHAR2,						-- Id. nodo corrispondente alla UO/struttura
2743        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
2744        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
2745        			ErrMsgOut				OUT 	VARCHAR2						-- Messaggio d'errore
2746        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine, altrimenti 0
2747        
2748        	/******	funzione per sapere se i contenuti di un certo folder-UO (quelli "direttamente" innestati nel folder) si possono listare tutti, 			*****/
2749        	/*****	senza effettuare prima una ricerca, nella lista a destra della finestra di "esplora risorse" con cui si esplora il titolario				*****/
2750        	/****** folder particolari: IdUOIn = NULL => "folder" dell'intero organigramma il cui ID è IdPOrganigrammaIn in input								*****/
2751        	function TestShowFolderContentAllowed(
2752        			CodIdConnectionTokenIn	IN		DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%type,
2753        																			-- (obblig). Codice identificativo del token di connessione
2754        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,
2755        																			-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
2756        			IdOrganigrammaIn		IN 		DMT_ORGANIGRAMMI.ID_ORGANIGRAMMA%type DEFAULT NULL,
2757        																			-- (obblig.) Id. dell'organigrmma in cui effettuare la verifica
2758        			IdUOIn 					IN		DMT_STRUTTURA_ORG.ID_UO%type,	-- ID_UO del folder-UO
2759        																			-- se NON è valorizzato si intende l'intero organigramma che ha come Id. il valore specificato in IdOrganigrammaIn
2760        			FlgShowContentAllowedOut OUT	PLS_INTEGER,					-- (valori 1/0) Se 1 significa che per il folder-UO IdUOIn si possono mostrare come lista i contenuti
2761        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
2762        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
2763        			ErrMsgOut				OUT 	VARCHAR2,						-- Messaggio d'errore
2764        			FlgIncludiUtentiIn		IN		PLS_INTEGER DEFAULT NULL,		-- (valori 2/1/0/NULL): se 2 indica che per la verifica vengono conteggiate sia le UO che tutti gli utenti collegati (con o senza scrivania), se 1 che vanno conteggiate le UO e gli utenti con scrivania, se 0 o NULL solo le UO
2765        			TipoRelUtentiConUOIn		IN		VARCHAR2 DEFAULT NULL,		-- (viene considerato solo se FlgIncludiUtentiIn>0) Indica il/i tipi di relazione da conteggiare per la verifica:
2766        																			--  Valori ammessi:
2767        																			--  A = Appartenenza;
2768        																			--  L = a Lavorare per;
2769        																			--  D = Delega
2770        																			-- o una loro cancatenazione con ";" come separatore
2771        																			-- Se non valorizzato è come se contenesse tutti i valori previsti
2772        			TsRifIn					IN		VARCHAR2 DEFAULT NULL,			-- (nel formato DD/MM/RRRR HH24:MI:SS) Definisce l'istante in cui va presa la "fotografia" dell'organigramma su cui effettuare la verifica
2773        																			-- Se non valorizzato si intende la situazione attuale dell'organigramma
2774        			FlgSoloAttiveIn			IN		PLS_INTEGER DEFAULT 1,			-- (valori 1/0/NULL) Se 1 per la verifica vengono conteggiate solo le UO e relazioni utente-UO valide al timestamp TsRifIn
2775        			FinalitaIn				IN		VARCHAR2 DEFAULT NULL			-- Motivo per cui si sta navigando/ricercando nella pagina con l'albero dell'organigramma. Valori ammessi:
2776        																			-- ASSEGNAZIONE = Per selezionare la UO/utente cui assegnare un documento/folder (in questo caso l'albero mostra solo UO attive)
2777        																			-- ASS_CARTACEO = Per selezionare la UO/utente/scrivania cui assegnare documantazione cartacea
2778        																			-- ASS_NO_CARTACEO = Per selezionare la UO/utente/scrivania cui assegnare documantazione senza restrizioni del cartaceo
2779        																			-- ASS_EMAIL = Assegnazione di una mail
2780        																			-- INVIO_CC_NOTIFICA = Per selezionare la UO/utente cui inviare per conoscenza/con cui condividere/mandare osservazione su un documento/folder
2781        																			-- ACL = Per selezionare UO/utenti da mettere in un'ACL
2782        																			-- SEL_SV = Selezione di una scrivania per assegnarla ad altro utente/UO
2783        																			-- SEL_UP = Selezione di unità di personale (utenti con o senza scrivania)
2784        																			-- ALTRO = Qualsiasi altra finalità (ad esempio per selezionare UO/utenti da mettere in un gruppo)
2785        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine, altrimenti 0
2786        
2787        	/****** funzione per ottenere i dati - come xml- dei livelli di un percorso che corrisponde ad una certa UO (il cui ID è fornito in input)			*****/
2788        	/****** se l'ID in input, IdUOIn, è NULL si intende l'intero piano di classificazione il cui ID è IdOrganigrammaIn in input							*****/
2789        	function GetLivPathExUO(
2790        			CodIdConnectionTokenIn	IN		DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%type,
2791        																			-- (obblig). Codice identificativo del token di connessione
2792        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,
2793        																			-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
2794        			IdOrganigrammaIn		IN 		DMT_ORGANIGRAMMI.ID_ORGANIGRAMMA%type DEFAULT NULL,
2795        																			-- (obblig.) Id. dell'organigramma cui appartiene il folder-UO
2796        			IdUOIn 					IN		DMT_STRUTTURA_ORG.ID_UO%type,	-- ID_UO della UO/struttura di cui determinare i livelli del percorso corrispondente
2797        																			-- se NULL si intende l'intero organigramma
2798        			PercorsoXMLOut			OUT	NOCOPY CLOB,						-- Lista con i dati dei livelli del percorso corrispondente alla UO
2799        																			-- Ogni cartella/UO nel percorso corrisponde ad un tag "Riga" con le seguenti colonne:
2800        																			-- 1: Id. della UO (se il livello è l'organigramma è NULL)
2801        																			-- 2: Nome
2802        																			-- 3: (valori 1/0) Se 1 nell'albero dell'archivio la UO è un nodo di cui NON si possono mostrare tutti contenuti
2803        			                                                                -- 4: NULL
2804                                                                                    -- 5: N.ri livello della UO (quella cui è collegto l'utente/scrivania se il nodo rappresenta un utente con o senza scrivania)
2805        			FlgShowContentAllowedOut OUT	PLS_INTEGER,					-- (valori 1/0) Se 1 significa che per il folder IdUOIn si possono mostrare come lista i contenuti
2806        																			-- concide sempre con la colonna 3 dell'ultima riga di PercorsoXMLOut
2807        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
2808        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
2809        			ErrMsgOut				OUT 	VARCHAR2,						-- Messaggio d'errore
2810        			FlgIncludiUtentiIn		IN		PLS_INTEGER DEFAULT NULL,		-- (valori 2/1/0/NULL): se 2 indica che per determinare la colonna 3 dei livelli del percorso restituiti in PercorsoXMLOut vengono conteggiate sia le UO che tutti gli utenti collegati (con o senza scrivania), se 1 che vanno conteggiate le UO e gli utenti con scrivania, se 0 o NULL solo le UO
2811        			TipoRelUtentiConUOIn		IN		VARCHAR2 DEFAULT NULL,		-- (viene considerato solo se FlgIncludiUtentiIn>0) Indica il/i tipi di relazione da conteggiare per determinare la colonna 3 dei livelli del percorso restituiti in PercorsoXMLOut
2812        																			--  Valori ammessi:
2813        																			--  A = Appartenenza;
2814        																			--  L = a Lavorare per;
2815        																			--  D = Delega
2816        																			-- o una loro cancatenazione con ";" come separatore
2817        																			-- Se non valorizzato è come se contenesse tutti i valori previsti
2818        			TsRifIn					IN		VARCHAR2 DEFAULT NULL,			-- (nel formato DD/MM/RRRR HH24:MI:SS) Definisce l'istante in cui va presa la "fotografia" dell'organigramma
2819        																			-- Se non valorizzato si intende la situazione attuale dell'organigramma
2820        																			-- serve per determinare la colonna 3 dei livelli del percorso restituiti in PercorsoXMLOut
2821        			FlgSoloAttiveIn			IN		PLS_INTEGER DEFAULT 1,			-- (valori 1/0/NULL) Se 1 per determinare la colonna 3 dei livelli del percorso restituiti in PercorsoXMLOut vengono conteggiate solo le UO e relazioni utente-UO valide al timestamp TsRifIn
2822        			FinalitaIn				IN		VARCHAR2 DEFAULT NULL			-- Motivo per cui si stanno navigando/ricercando le classifiche. Valori ammessi:
2823        																			-- ASSEGNAZIONE = Per selezionare la classificazione da assegnare ad un documento
2824        																			-- ASS_CARTACEO = Per selezionare la UO/utente/scrivania cui assegnare documantazione cartacea
2825        																			-- ASS_NO_CARTACEO = Per selezionare la UO/utente/scrivania cui assegnare documantazione senza restrizioni del cartaceo
2826        																			-- ASS_EMAIL = Assegnazione di una mail
2827        																			-- INVIO_CC_NOTIFICA = Per selezionare la UO/utente cui inviare per conoscenza/con cui condividere/mandare osservazione su un documento/folder
2828        																			-- APERTURA_FASC = Per selezionare la classifica in cui aprire un fascicolo
2829        																			-- RICERCA = Per selezionare le classifiche cui si è abilitati (per la trattazione)
2830        																			-- serve per determinare la colonna 3 dei livelli del percorso restituiti in PercorsoXMLOut
2831        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine, altrimenti 0
2832        
2833        
2834        	/*** Funzione di creazione/aggiornamento di una unità operativa							***/
2835        	/*** prevede la gestione di: profilatura 												***/
2836        	/***				     gruppi di appartenenza											***/
2837        	/*** Non prevede la gestione dei privilegi su singoli oggetti di definizione del contesto					***/
2838        	function IUUO(
2839        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
2840        																	-- (obblig). Codice identificativo del token di connessione
2841        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
2842        			IdUOIO				IN OUT	DMT_STRUTTURA_ORG.ID_UO%type ,		-- Id. della UO da modificare. Se NULL si intende che la UO è da creare ex-novo
2843        																	-- in output, salvo in caso di errore, è sempre valorizzato
2844        			IdUOSupIn				IN		DMT_STRUTTURA_ORG.ID_UO%type DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
2845        																	-- Id.della UO superiore. Se non valorizzato (e non lo è neppure NriLivelliUOSupIn) significa che è una U.O. di primo livello
2846        			NriLivelliUOSupIn			IN		VARCHAR2 DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
2847        																	-- N.ri livelli della UO superiore. Se non valorizzato (e non lo è neppure IdUOSupIn) significa che è una U.O. di primo livello
2848        																	-- I nri vanno indicati così come appaiono nella GUI e con il saparatore previsto nella GUI per i livelli UO
2849        			CodTipoIn				IN		DMT_STRUTTURA_ORG.COD_TIPO%type DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
2850        																	-- Codice del tipo di UO.
2851        																	-- E' obbligatorio se ci sono più tipi di UO che possono occupare i livelli gerarchicamente inferiori a quello di IdUOSupIn
2852        																	--	o se IdUOSupIn non è valorizzato e se ci sono più tipi di UO legati al primo livello gerarchico
2853        			NroLivelloIn			IN 		VARCHAR2 DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
2854        																	-- (obblig.) N.ro livello (come appare nella GUI, ovvero romano se previsto) che identifica la UO tra quelle dello stesso livello gerarchico (sottostanti la stessa IdUOSupIn se specificata)
2855        			DenominazioneIn			IN		DMT_STRUTTURA_ORG.DENOMINAZIONE%type DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
2856        																	-- (obblig.) Denominazione della UO
2857        			DtIstituzioneIn			IN		VARCHAR2 DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'DATE_VAL_NO_UPD'),
2858        																	-- (obblig.) Data di istituzione (nel formato dato dal parametro di conf. FMT_STD_DATA).
2859        			DtSoppressioneIn			IN		VARCHAR2 DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'DATE_VAL_NO_UPD'),
2860        																	-- Data di soppressione / cessazione (nel formato dato dal parametro di conf. FMT_STD_DATA).
2861        			NroPosizioneIn			IN		DMT_STRUTTURA_ORG.NRO_POSIZIONE%type DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
2862        																	-- N.ro che indica la posizione della UO all'interno della struttura organizzativa (per avere un ordinamento alternativo rispetto a quello con i livelli)
2863        			CompetenzeIn			IN		DMT_STRUTTURA_ORG.COMPETENZE%type DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
2864        																	-- Competenze della UO
2865        			StoriaIn				IN		DMT_STRUTTURA_ORG.STORIA%type DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
2866        																	-- Storia della UO
2867        			IdProfiloIn				IN		DMT_PROFILI.ID_PROFILO%type DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
2868        																	-- Id. del profilo di DMT_PROFILI (uno di quelli che hanno un nome) da assegnare alla UO
2869        			NomeProfiloIn			IN		DMT_PROFILI.NOME_PROFILO%type DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
2870        																	-- Nome del profilo di DMT_PROFILI da assegnare alla UO (ricerca case-insensitive in like)
2871        			XMLDatiProfiloIn			IN		CLOB DEFAULT NULL,				-- XML (conforme a schema SezioneCache.xsd) che contiene tutti gli attributi del profilo (tranne i gruppi di privilegi) da settare/aggiornare
2872        																	-- ATTENZIONE: Si intende che gli attributi corrispondenti a tag non presenti restino invariati
2873        																	-- Nell'XML possono esserci tag corrispondenti ad attributi di profilatura solo se non si è specificato un profilo predefinito con i due argomenti IdProfiloIn e/o NomeProfiloIn
2874        			FlgModGruppiPrivIn		IN		VARCHAR2 DEFAULT 'I',				-- (valori I/C) Indica se i gruppi di privilegi indicati nell'argomento successivo sono forniti in modo incrementale (=I) (solo quelle da inserire/cancellare) oppure completo (=C), vale a dire che dovranno soppiantare tutti quelli già associati alla UO
2875        			XMLGruppiPrivIn			IN		CLOB DEFAULT NULL,				-- Lista con i gruppi di privilegi assegnati/da assegnare direttamente (ovvero non tramite profilo) alla UO (XML conforme a schema LISTA_STD.xsd)
2876        																	-- Ogni gruppo è un tag "Riga" che può contenere le seguenti colonne:
2877        																	-- 1: Identificativo del gruppo di privilegi
2878        																	-- 2: Nome del gruppo di privilegi (ricerca case insesnsitive in like)
2879        																	-- 3: (valori 1/0/NULL) Flag di gruppo da eliminare
2880        			FlgDichIPAIn			IN		PLS_INTEGER DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
2881        																	-- (valori 1/0/NULL) Se 1 è una UO dichiarata all'Indice PA
2882        			DtDichIPAIn				IN		VARCHAR2 DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'DATE_VAL_NO_UPD'),
2883        																	-- Data di dichiarazione della UO all'indice PA (nel formato dato dal parametro di conf. FMT_STD_DATA).
2884        			CIProvUOIn				IN 		DMT_STRUTTURA_ORG.PROV_CI_UO%TYPE DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
2885        																	-- Codice identificativo della UO nel sistema di provenienza
2886        			FlgLockedIn				IN		PLS_INTEGER DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
2887        																	-- (valori 1/0/NULL) Indicatore di UO riservata dal sistema e non modificabile/cancellabile da GUI
2888        			FlgModGruppiAppIn			IN		VARCHAR2 DEFAULT 'I',				-- (valori I/C) Indica i gruppi cui appartiene l'utente (relativi al dominio da cui si è connessi) indicati nell'argomento successivo sono forniti in modo incrementale (=I) (solo quelle da aggiungere o cancellare) oppure completo (=C), vale a dire che dovranno soppiantare tutte quelle già specificati (e relativi al dominio di lavoro) in caso di utente da aggiornare
2889        			XMLGruppiAppIn			IN		CLOB DEFAULT NULL,				-- Lista con i gruppi cui appartiene la UO
2890        																	-- Ogni gruppo di appartenenza è un tag "Riga" con le colonne:
2891        																	-- 1: Id. del gruppo
2892        																	-- 2: Nome del gruppo
2893        																	-- 3: flag 1/0 che indica se nel gruppo sono incluse le sotto-UO
2894        																	-- 4: flag 1/0 che indica se nel gruppo sono incluse le scrivanie
2895        																	-- 5: (valori 1/0) Flag di appartenenza a gruppo da eliminare
2896        			FlgModContattiIn			IN		VARCHAR2 DEFAULT 'I',				-- (valori I/C) Indica se i contatti (rif. telefonici, fax, e-mail) del soggetto indicati nell'argomento successivo sono forniti in modo incrementale (=I) (solo quelli da inserire/modificare/cancellare) oppure completo (=C), vale a dire che dovranno soppiantare tutti quelli già specificati in caso di soggetto da aggiornare
2897        			XMLContattiIn			IN		CLOB DEFAULT NULL,				-- Lista con i contatti (rif. telefonici, fax, e-mail) della UO (XML conforme a schema LISTA_STD.xsd)
2898        																	-- Ogni contatto è tag "Riga" che può contenere le seguenti colonne:
2899        																	-- 1: Identificativo (ROWID preceduto da Tipo - T/F/E) con cui il contatto è già stata registrato in banca dati
2900        																	-- 2: (obblig.) Flag che indica il tipo di contatto. Valori possibili: T=Telefono; F=Fax; E=e-Mail
2901        																	-- 3: N.ro di telefono/fax o indirizzo e-mail
2902        																	-- 4: Tipo di numero di telefono (abitazione, ufficio, cell. ecc.) Valori da apposita dictionary entry
2903        																	-- 5: (valori 1/0/NULL) Flag di indirizzo e-mail di Posta Elettronica Certificata
2904        																	-- 6: (valori 1/0/NULL) Flag di indirizzo e-mail dichiarato all'Indice PA
2905        																	-- 7: (valori 1/0/NULL) Flag di indirizzo e-mail che è Casella Istituzionale di una PA
2906        																	-- 8: Estremi del gestore della casella se è di Posta Elettronica Certificata
2907        																	-- 9: (valori 1/0/NULL) Flag di contatto da eliminare
2908        			RowidOut				OUT		VARCHAR2,						-- Rowid del record della UO
2909        			AttributiAddIn			IN		CLOB DEFAULT NULL,				-- XML contenente nomi e valori degli attributi dinamici da aggiornare (conforme allo schema SezioneCache.xsd)
2910        																	-- Gli attributi già presenti in DB e per i quali non c'è corrispondente nell'XML restano invariati
2911        																	-- Per tutti gli attributi vale quanto segue:
2912        																	-- Un attributo da settare è un tag "Variabile" dell'XML il cui tag "Nome" contiene il nome identificativo dell'attributo (ATTR_NAME di DMT_ATTRIBUTES_DEF)
2913        																	-- Un attributo da settare è una variabile con tag "ValoreSemplice" se è un attributo a singolo valore e non strutturato (cioè con tipo diverso da COMPLEX)
2914        																	-- altrimenti è una variabile con tag "Lista" che ha un'unica colonna con "Nro" pari a 1 se l'attributo non è strutturato, che ha invece tante colonne quanti gli attributi componenti (ordinate in base al loro NRO_ORD_IN_SUP) se l'attributo è complesso
2915        																	-- Nel caso di variabili con tag "Lista" i valori specificati nell'XML si aggiungono o sostituiscono quelli già presenti in DB a seconda che nell'XML sia presente o meno una variabile con tag "Nome" pari a #Append_<Nome attributo> e tag "ValoreSemplice" pari a 1
2916        																	-- In particolare se non sono specificati valori nell'XML (tag Lista vuoto) e se i valori non sono da aggiungere significa che tutti i valori dell'attributo già presenti in DB vanno rimossi
2917        			FlgStoricizzaDatiIn		IN		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 i dati variati veranno storicizzati
2918        			TsVariazioneDatiIn		IN		VARCHAR2 DEFAULT NULL,				-- (gestito solo se FlgStoricizzaDatiIn=1) Timestamp a cui risale la variazione dei dati (nel formato dato dal parametro di configurazione FMT_STD_TIMESTAMP).
2919        																	-- Se non valorizzato e se FlgStoricizzaDatiIn si intende che la variazione decorra da data e ora corrente
2920        			MotiviVariazioneIn		IN		VARCHAR2 DEFAULT NULL,				-- Motivo della variazione dei dati
2921        			CodCategAttoVariazioneIn	IN		VARCHAR2 DEFAULT NULL,				-- (gestito solo se FlgStoricizzaDatiIn=1) Codice della categoria di registrazione/numerazione (valori da dizionario) dell'atto che ha sancito il cambiamento dei dati da storicizzare
2922        			SiglaAttoVariazioneIn		IN		VARCHAR2 DEFAULT NULL,				-- (gestito solo se FlgStoricizzaDatiIn=1) Sigla che indica il registro in cui è stato registrato l'atto che ha sancito il cambiamento dei dati da storicizzare
2923        			AnnoAttoVariazioneIn		IN		PLS_INTEGER DEFAULT NULL,			-- (gestito solo se FlgStoricizzaDatiIn=1) Anno di registrazione/numerazione dell'atto che ha sancito il cambiamento dei dati da storicizzare
2924        			NroAttoVariazioneIn		IN		PLS_INTEGER DEFAULT NULL,			-- (gestito solo se FlgStoricizzaDatiIn=1) N.ro di registrazione/numerazione dell'atto che ha sancito il cambiamento dei dati da storicizzare
2925        			TsAttoVariazioneIn		IN		VARCHAR2 DEFAULT NULL,				-- (gestito solo se FlgStoricizzaDatiIn=1) Data e ora di registrazione/numerazione dell'atto che ha sancito il cambiamento dei dati da storicizzare (nel formato dato dal parametro di configurazione FMT_STD_TIMESTAMP).
2926        			FlgIgnoreWarningIn 		IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 0 o NULL significa che in presenza di WARNING la stored si comporta come in caso di errore; se 1 gli WARNING vengono ignorati
2927        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
2928        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
2929        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
2930        			WarningMsgOut			OUT		VARCHAR2,						-- Messaggio di warning (valorizzato solo se non c'è errore)
2931        			FlgDatiDaStoricizzareOut	OUT		PLS_INTEGER,					-- (valori 1/NULL) Se FlgStoricizzaDatiIn non è valorizzato e se si sono modificati dati che è previsto storicizzare viene restituito pari a 1
2932        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
2933        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
2934        			ErrMsgOut				OUT 		VARCHAR2,						-- Messaggio d'errore
2935        			IdOrganigrammaIn		IN			DMT_ORGANIGRAMMI.ID_ORGANIGRAMMA%type DEFAULT NULL,
2936        																			-- Id. dell'organigramma in cui creare/modificare la UO. Se non specificato è l'ID dell'unico organigramma in cui compare la UO (se individuabile e se si sta modificando una UO), altrimenti è l'ID dell'organigramma in vigore
2937        			DesBreveAcronimoIn		IN		VARCHAR2 DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
2938        																			-- Denominazione breve o acronimo della UO
2939        			XMLPuntiProtocolloIn	IN		CLOB DEFAULT NULL,				-- Lista con i dati dei punti di protocollo associati (attributo custom lista)
2940        																			-- Considera solo la colonna 2 con l'ID_UO del punto di protocollo
2941        			XMLPrececessoriIn		IN		CLOB DEFAULT NULL, 				-- Lista XML con i dati delle UO predecessori
2942        																			-- Ogni riga è una UO predecessore e contiene le colonne
2943        																			-- 1) Tipo di azione che lega al predecessore: accorpamento, split
2944        																			-- 2) Id. UO del precedessore
2945        			XMLSuccessoriIn			IN		CLOB DEFAULT NULL, 				-- Lista XML con i dati delle UO successori
2946        																			-- Ogni riga è una UO successore e contiene le colonne
2947        																			-- 1) Tipo di azione che lega al successore: accorpamento, split
2948        																			-- 2) Id. UO del successore
2949        			IdUODestMailIn			IN		INTEGER DEFAULT NULL,			-- Id. della UO a cui spostare le mail assegnate alla UO (in genere impostata in caso di cessazione della UO)
2950        			IdUODestDocIn			IN		INTEGER DEFAULT NULL			-- Id. della UO a cui spostare documenti e fascicoli assegnati alla UO (in genere impostata in caso di cessazione della UO)
2951        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine (senza warning), altrimenti 0 (in caso di errore o warning)
2952        
2953        	/********** funzione per estrarre i dati di dettaglio di una UO *************/
2954        	function LoadDettUO(
2955        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
2956        																	-- (obblig). Codice identificativo del token di connessione
2957        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
2958        			IdUOIO				IN OUT	DMT_STRUTTURA_ORG.ID_UO%type ,		-- Id. della UO
2959        																	-- in output, salvo in caso di errore, è sempre valorizzato
2960        			NriLivelliUOIO			IN OUT	VARCHAR2,						-- N.ri dei livelli (come appaiono nella GUI) della UO
2961        																	-- in output, salvo in caso di errore, è sempre valorizzato
2962        			DenominazioneIO			IN OUT	VARCHAR2,						-- Denominazione della UO
2963        																	-- in input può essere sia la denominazione semplice che la concatenazione con separatore "|" delle denominazioni delle UO superiori + quella della UO
2964        																	-- in output è sempre la denominazione semplice
2965        			TsRifIn				IN		VARCHAR2 default TO_CHAR(sysdate, 'DD/MM/RRRR HH24:MI:SS'),
2966        																	-- Stringa con il timestamp (nel formato GG/MM/AAAA HH24:MI:SS) di riferimento al quale la UO deve avere gli estremi specificati in input e al quale si riferiscono gli altri dati restituiti in output
2967        			IdUOSupOut				OUT		DMT_STRUTTURA_ORG.ID_UO%type,			-- Id.della UO superiore. Se non valorizzato significa che è una U.O. di primo livello
2968        			NroLivelloGerarchicoUOSupOut	OUT		DMT_STRUTTURA_ORG.LIVELLO_GERARCHICO%type,-- N.ro che indica il livello gerarchico della UO superiore. Se non valorizzato significa che è una U.O. di primo livello
2969        			NroLivelloGerarchicoOut		OUT		DMT_STRUTTURA_ORG.LIVELLO_GERARCHICO%type,-- N.ro che indica il livello gerarchico della UO
2970        			CodTipoOut				OUT		DMT_STRUTTURA_ORG.COD_TIPO%type,		-- Codice del tipo della UO.
2971        			DesTipoOut				OUT		VARCHAR2,						-- Descrizione del tipo della UO
2972        			DtIstituzioneOut			OUT		VARCHAR2,						-- Data di istituzione (nel formato dato dal parametro di conf. FMT_STD_DATA).
2973        			DtSoppressioneOut			OUT		VARCHAR2,						-- Data di soppressione / cessazione (nel formato dato dal parametro di conf. FMT_STD_DATA).
2974        			NroPosizioneOut			OUT		DMT_STRUTTURA_ORG.NRO_POSIZIONE%type,	-- N.ro che indica la posizione della UO all'interno della struttura organizzativa (per avere un ordinamento alternativo rispetto a quello con i livelli)
2975        			CompetenzeOut			OUT		DMT_STRUTTURA_ORG.COMPETENZE%type,		-- Competenze della UO
2976        			StoriaOut				OUT		DMT_STRUTTURA_ORG.STORIA%type,		-- Storia della UO
2977        			IdProfiloOut			OUT		DMT_PROFILI.ID_PROFILO%type ,			-- Id. del profilo di DMT_PROFILI assegnato alla UO
2978        			NomeProfiloOut			OUT		DMT_PROFILI.NOME_PROFILO%type,		-- Nome del profilo di DMT_PROFILI assegnato alla UO
2979        			XMLDatiProfiloOut			OUT		NOCOPY CLOB,					-- XML (conforme a schema SezioneCache.xsd) che contiene tutti gli attributi del profilo (tranne i gruppi di provilegi)
2980        			XMLGruppiPrivOut			OUT		NOCOPY CLOB,					-- Lista con i gruppi di privilegi assegnati direttamente (ovvero non tramite profilo) alla UO (XML conforme a schema LISTA_STD.xsd)
2981        																	-- Ogni gruppo è un tag "Riga" che può contenere le seguenti colonne:
2982        																	-- 1: Identificativo del gruppo di privilegi
2983        																	-- 2: Nome del gruppo di privilegi
2984        			FlgDichIPAOut			OUT		PLS_INTEGER,					-- (valori 1/0) Se 1 è una UO dichiarata all'Indice PA
2985        			DtDichIPAOut			OUT		VARCHAR2,						-- Data di dichiarazione della UO all'indice PA (nel formato dato dal parametro di conf. FMT_STD_DATA).
2986        			CIProvUOOut				OUT 		DMT_STRUTTURA_ORG.PROV_CI_UO%TYPE,		-- Codice identificativo della UO nel sistema di provenienza
2987        			FlgLockedOut			OUT		PLS_INTEGER,					-- (valori 1/0) Indicatore di UO riservata dal sistema e non modificabile/cancellabile da GUI
2988        			XMLGruppiAppOut			OUT		NOCOPY CLOB,					-- Lista con i gruppi cui appartiene la UO
2989        																	-- Ogni gruppo di appartenenza è un tag "Riga" con le colonne:
2990        																	-- 1: Id. del gruppo
2991        																	-- 2: Nome del gruppo
2992        																	-- 3: flag 1/0 che indica se nel gruppo sono incluse le sotto-UO
2993        																	-- 4: flag 1/0 che indica se nel gruppo sono incluse le scrivanie
2994        			XMLContattiOut			OUT		NOCOPY CLOB,					-- Lista con i contatti (rif. telefonici, fax, e-mail) della UO (XML conforme a schema LISTA_STD.xsd)
2995        																	-- Ogni contatto è tag "Riga" che può contenere le seguenti colonne:
2996        																	-- 1: Identificativo (ROWID preceduto da Tipo - T/F/E) con cui il contatto è già stata registrato in banca dati
2997        																	-- 2: (obblig.) Flag che indica il tipo di contatto. Valori possibili: T=Telefono; F=Fax; E=e-Mail
2998        																	-- 3: N.ro di telefono/fax o indirizzo e-mail
2999        																	-- 4: Tipo di numero di telefono (abitazione, ufficio, cell. ecc.) Valori da apposita dictionary entry
3000        																	-- 5: (valori 1/0/NULL) Flag di indirizzo e-mail di Posta Elettronica Certificata
3001        																	-- 6: (valori 1/0/NULL) Flag di indirizzo e-mail dichiarato all'Indice PA
3002        																	-- 7: (valori 1/0/NULL) Flag di indirizzo e-mail che è Casella Istituzionale di una PA
3003        																	-- 8: Estremi del gestore della casella se è di Posta Elettronica Certificata
3004        			RowidOut				OUT		VARCHAR2,						-- Rowid del record della UO
3005        			AttributiAddOut			OUT		NOCOPY CLOB,					-- Lista degli eventuali ulteriori attributi con cui caratterizzare la UO (XML conforme a schema LISTA_STD.xsd)
3006        																	-- Ogni attributo è un tag "Riga" che contiene le seguenti colonne:
3007        																	-- 1: N.ro (valori da 1 a n) del riquadro (fieldset) in cui mostrare l'attributo
3008        																	-- 2: Nome identificativo dell'attributo (ATTR_NAME)
3009        																	-- 3: Label del campo con cui rappresentare l'attributo
3010        																	-- 4: Tipo di attributo. Valori: DATE, DATETIME, TEXT, TEXT-AREA, CHECK, INTEGER, EURO, DECIMAL, COMBO-BOX, LISTA
3011        																	-- 5: N.ro massimo di caratteri/cifre
3012        																	-- 6: Larghezza del campo con cui rappresentare l'attributo (size)
3013        																	-- 7: Valore dell'attributo
3014        																	-- 8: Label del riquadro (fieldset) in cui mostrare l'attributo
3015        																	-- 9: (valori 1/0) 1 indica che l'attributo è obbligatorio, 0 che è facoltativo
3016        																	-- 10: Altezza (in nro righe) del campo con cui rappresentare l'attributo (se TEXT-AREA)
3017        																	-- 11:(valori 1/0) 1 indica se l'attributo è modificabile, 0 che è in sola visualizzazione
3018        			BachSizeOut				OUT		PLS_INTEGER,					-- Indica il massimo n.ro di record per ogni pagina da mostrare nelle liste del dettaglio
3019        			FlgMostraAltriAttrOut		OUT		PLS_INTEGER,					-- (valori 1/0) Se 1 nella GUI vanno mostrati gli attributi addizionali (ce ne sono di visibile all'utente), se 0 no
3020        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
3021        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
3022                    ErrMsgOut                OUT         VARCHAR2                        -- Messaggio d'errore
3023                    ) return PLS_INTEGER;                                            -- Vale 1 se tutto è andato a buon fine , altrimenti 0 (in caso di errore o warning)
3024        
3025        
3026            /********** funzione per estrarre i dati di dettaglio di una UO *************/
3027            function LoadDettUO(
3028                    CodIdConnectionTokenIn        IN            DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
3029                                                                            -- (obblig). Codice identificativo del token di connessione
3030                    IdUserLavoroIn            IN        DMT_USERS.ID_USER%type DEFAULT NULL,    -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
3031                    IdUOIO                IN OUT    DMT_STRUTTURA_ORG.ID_UO%type ,        -- Id. della UO
3032                                                                            -- in output, salvo in caso di errore, è sempre valorizzato
3033                    NriLivelliUOIO            IN OUT    VARCHAR2,                        -- N.ri dei livelli (come appaiono nella GUI) della UO
3034                                                                            -- in output, salvo in caso di errore, è sempre valorizzato
3035                    DenominazioneIO            IN OUT    VARCHAR2,                        -- Denominazione della UO
3036                                                                            -- in input può essere sia la denominazione semplice che la concatenazione con separatore "|" delle denominazioni delle UO superiori + quella della UO
3037                                                                            -- in output è sempre la denominazione semplice
3038                    TsRifIn                IN        VARCHAR2 default TO_CHAR(sysdate, 'DD/MM/RRRR HH24:MI:SS'),
3039                                                                            -- Stringa con il timestamp (nel formato GG/MM/AAAA HH24:MI:SS) di riferimento al quale la UO deve avere gli estremi specificati in input e al quale si riferiscono gli altri dati restituiti in output
3040                    IdUOSupOut                OUT        DMT_STRUTTURA_ORG.ID_UO%type,            -- Id.della UO superiore. Se non valorizzato significa che è una U.O. di primo livello
3041                    NroLivelloGerarchicoUOSupOut    OUT        DMT_STRUTTURA_ORG.LIVELLO_GERARCHICO%type,-- N.ro che indica il livello gerarchico della UO superiore. Se non valorizzato significa che è una U.O. di primo livello
3042                    NroLivelloGerarchicoOut        OUT        DMT_STRUTTURA_ORG.LIVELLO_GERARCHICO%type,-- N.ro che indica il livello gerarchico della UO
3043                    CodTipoOut                OUT        DMT_STRUTTURA_ORG.COD_TIPO%type,        -- Codice del tipo della UO.
3044                    DesTipoOut                OUT        VARCHAR2,                        -- Descrizione del tipo della UO
3045                    DtIstituzioneOut            OUT        VARCHAR2,                        -- Data di istituzione (nel formato dato dal parametro di conf. FMT_STD_DATA).
3046                    DtSoppressioneOut            OUT        VARCHAR2,                        -- Data di soppressione / cessazione (nel formato dato dal parametro di conf. FMT_STD_DATA).
3047                    NroPosizioneOut            OUT        DMT_STRUTTURA_ORG.NRO_POSIZIONE%type,    -- N.ro che indica la posizione della UO all'interno della struttura organizzativa (per avere un ordinamento alternativo rispetto a quello con i livelli)
3048                    CompetenzeOut            OUT        DMT_STRUTTURA_ORG.COMPETENZE%type,        -- Competenze della UO
3049                    StoriaOut                OUT        DMT_STRUTTURA_ORG.STORIA%type,        -- Storia della UO
3050                    IdProfiloOut            OUT        DMT_PROFILI.ID_PROFILO%type ,            -- Id. del profilo di DMT_PROFILI assegnato alla UO
3051                    NomeProfiloOut            OUT        DMT_PROFILI.NOME_PROFILO%type,        -- Nome del profilo di DMT_PROFILI assegnato alla UO
3052                    XMLDatiProfiloOut            OUT        NOCOPY CLOB,                    -- XML (conforme a schema SezioneCache.xsd) che contiene tutti gli attributi del profilo (tranne i gruppi di provilegi)
3053                    XMLGruppiPrivOut            OUT        NOCOPY CLOB,                    -- Lista con i gruppi di privilegi assegnati direttamente (ovvero non tramite profilo) alla UO (XML conforme a schema LISTA_STD.xsd)
3054                                                                            -- Ogni gruppo è un tag "Riga" che può contenere le seguenti colonne:
3055                                                                            -- 1: Identificativo del gruppo di privilegi
3056                                                                            -- 2: Nome del gruppo di privilegi
3057                    FlgDichIPAOut            OUT        PLS_INTEGER,                    -- (valori 1/0) Se 1 è una UO dichiarata all'Indice PA
3058                    DtDichIPAOut            OUT        VARCHAR2,                        -- Data di dichiarazione della UO all'indice PA (nel formato dato dal parametro di conf. FMT_STD_DATA).
3059                    CIProvUOOut                OUT         DMT_STRUTTURA_ORG.PROV_CI_UO%TYPE,        -- Codice identificativo della UO nel sistema di provenienza
3060                    FlgLockedOut            OUT        PLS_INTEGER,                    -- (valori 1/0) Indicatore di UO riservata dal sistema e non modificabile/cancellabile da GUI
3061                    XMLGruppiAppOut            OUT        NOCOPY CLOB,                    -- Lista con i gruppi cui appartiene la UO
3062                                                                            -- Ogni gruppo di appartenenza è un tag "Riga" con le colonne:
3063                                                                            -- 1: Id. del gruppo
3064                                                                            -- 2: Nome del gruppo
3065                                                                            -- 3: flag 1/0 che indica se nel gruppo sono incluse le sotto-UO
3066                                                                            -- 4: flag 1/0 che indica se nel gruppo sono incluse le scrivanie
3067                    XMLContattiOut            OUT        NOCOPY CLOB,                    -- Lista con i contatti (rif. telefonici, fax, e-mail) della UO (XML conforme a schema LISTA_STD.xsd)
3068                                                                            -- Ogni contatto è tag "Riga" che può contenere le seguenti colonne:
3069                                                                            -- 1: Identificativo (ROWID preceduto da Tipo - T/F/E) con cui il contatto è già stata registrato in banca dati
3070                                                                            -- 2: (obblig.) Flag che indica il tipo di contatto. Valori possibili: T=Telefono; F=Fax; E=e-Mail
3071                                                                            -- 3: N.ro di telefono/fax o indirizzo e-mail
3072                                                                            -- 4: Tipo di numero di telefono (abitazione, ufficio, cell. ecc.) Valori da apposita dictionary entry
3073                                                                            -- 5: (valori 1/0/NULL) Flag di indirizzo e-mail di Posta Elettronica Certificata
3074                                                                            -- 6: (valori 1/0/NULL) Flag di indirizzo e-mail dichiarato all'Indice PA
3075                                                                            -- 7: (valori 1/0/NULL) Flag di indirizzo e-mail che è Casella Istituzionale di una PA
3076                                                                            -- 8: Estremi del gestore della casella se è di Posta Elettronica Certificata
3077                    RowidOut                OUT        VARCHAR2,                        -- Rowid del record della UO
3078                    AttributiAddOut            OUT        NOCOPY CLOB,                    -- Lista degli eventuali ulteriori attributi con cui caratterizzare la UO (XML conforme a schema LISTA_STD.xsd)
3079                                                                            -- Ogni attributo è un tag "Riga" che contiene le seguenti colonne:
3080                                                                            -- 1: N.ro (valori da 1 a n) del riquadro (fieldset) in cui mostrare l'attributo
3081                                                                            -- 2: Nome identificativo dell'attributo (ATTR_NAME)
3082                                                                            -- 3: Label del campo con cui rappresentare l'attributo
3083                                                                            -- 4: Tipo di attributo. Valori: DATE, DATETIME, TEXT, TEXT-AREA, CHECK, INTEGER, EURO, DECIMAL, COMBO-BOX, LISTA
3084                                                                            -- 5: N.ro massimo di caratteri/cifre
3085                                                                            -- 6: Larghezza del campo con cui rappresentare l'attributo (size)
3086                                                                            -- 7: Valore dell'attributo
3087                                                                            -- 8: Label del riquadro (fieldset) in cui mostrare l'attributo
3088                                                                            -- 9: (valori 1/0) 1 indica che l'attributo è obbligatorio, 0 che è facoltativo
3089                                                                            -- 10: Altezza (in nro righe) del campo con cui rappresentare l'attributo (se TEXT-AREA)
3090                                                                            -- 11:(valori 1/0) 1 indica se l'attributo è modificabile, 0 che è in sola visualizzazione
3091                    BachSizeOut                OUT        PLS_INTEGER,                    -- Indica il massimo n.ro di record per ogni pagina da mostrare nelle liste del dettaglio
3092                    FlgMostraAltriAttrOut        OUT        PLS_INTEGER,                    -- (valori 1/0) Se 1 nella GUI vanno mostrati gli attributi addizionali (ce ne sono di visibile all'utente), se 0 no
3093                    ErrContextOut            OUT        VARCHAR2,                        -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
3094                    ErrCodeOut                OUT        PLS_INTEGER,                    -- N.ro errore di uscita
3095        			ErrMsgOut				OUT 		VARCHAR2,						-- Messaggio d'errore
3096        			IdOrganigrammaIn		IN			DMT_ORGANIGRAMMI.ID_ORGANIGRAMMA%type DEFAULT NULL,
3097        																			-- Id. dell'organigramma in cui reperire i dati della UO. Se non specificato è l'ID dell'unico organigramma in cui compare la UO (se individuabile)
3098        			XMLPuntiProtocolloOut	OUT		NOCOPY CLOB 					-- Lista XML con i dati dei punti di protocollo associati
3099        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine , altrimenti 0 (in caso di errore o warning)
3100        
3101        	/********** funzione per estrarre i dati di dettaglio di una UO *************/
3102        	/********** analoga alla funzione precedente con in più gli output con dati della/e UO predecessori e successori da cui la UO è derivata o in cui è confluita/è stata splittata***/
3103        	function LoadDettUOEstesa(
3104        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
3105        																	-- (obblig). Codice identificativo del token di connessione
3106        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
3107        			IdUOIO				IN OUT	DMT_STRUTTURA_ORG.ID_UO%type ,		-- Id. della UO
3108        																	-- in output, salvo in caso di errore, è sempre valorizzato
3109        			NriLivelliUOIO			IN OUT	VARCHAR2,						-- N.ri dei livelli (come appaiono nella GUI) della UO
3110        																	-- in output, salvo in caso di errore, è sempre valorizzato
3111        			DenominazioneIO			IN OUT	VARCHAR2,						-- Denominazione della UO
3112        																	-- in input può essere sia la denominazione semplice che la concatenazione con separatore "|" delle denominazioni delle UO superiori + quella della UO
3113        																	-- in output è sempre la denominazione semplice
3114        			TsRifIn				IN		VARCHAR2 default TO_CHAR(sysdate, 'DD/MM/RRRR HH24:MI:SS'),
3115        																	-- Stringa con il timestamp (nel formato GG/MM/AAAA HH24:MI:SS) di riferimento al quale la UO deve avere gli estremi specificati in input e al quale si riferiscono gli altri dati restituiti in output
3116        			IdUOSupOut				OUT		DMT_STRUTTURA_ORG.ID_UO%type,			-- Id.della UO superiore. Se non valorizzato significa che è una U.O. di primo livello
3117        			NroLivelloGerarchicoUOSupOut	OUT		DMT_STRUTTURA_ORG.LIVELLO_GERARCHICO%type,-- N.ro che indica il livello gerarchico della UO superiore. Se non valorizzato significa che è una U.O. di primo livello
3118        			NroLivelloGerarchicoOut		OUT		DMT_STRUTTURA_ORG.LIVELLO_GERARCHICO%type,-- N.ro che indica il livello gerarchico della UO
3119        			CodTipoOut				OUT		DMT_STRUTTURA_ORG.COD_TIPO%type,		-- Codice del tipo della UO.
3120        			DesTipoOut				OUT		VARCHAR2,						-- Descrizione del tipo della UO
3121        			DtIstituzioneOut			OUT		VARCHAR2,						-- Data di istituzione (nel formato dato dal parametro di conf. FMT_STD_DATA).
3122        			DtSoppressioneOut			OUT		VARCHAR2,						-- Data di soppressione / cessazione (nel formato dato dal parametro di conf. FMT_STD_DATA).
3123        			NroPosizioneOut			OUT		DMT_STRUTTURA_ORG.NRO_POSIZIONE%type,	-- N.ro che indica la posizione della UO all'interno della struttura organizzativa (per avere un ordinamento alternativo rispetto a quello con i livelli)
3124        			CompetenzeOut			OUT		DMT_STRUTTURA_ORG.COMPETENZE%type,		-- Competenze della UO
3125        			StoriaOut				OUT		DMT_STRUTTURA_ORG.STORIA%type,		-- Storia della UO
3126        			IdProfiloOut			OUT		DMT_PROFILI.ID_PROFILO%type ,			-- Id. del profilo di DMT_PROFILI assegnato alla UO
3127        			NomeProfiloOut			OUT		DMT_PROFILI.NOME_PROFILO%type,		-- Nome del profilo di DMT_PROFILI assegnato alla UO
3128        			XMLDatiProfiloOut			OUT		NOCOPY CLOB,					-- XML (conforme a schema SezioneCache.xsd) che contiene tutti gli attributi del profilo (tranne i gruppi di provilegi)
3129        			XMLGruppiPrivOut			OUT		NOCOPY CLOB,					-- Lista con i gruppi di privilegi assegnati direttamente (ovvero non tramite profilo) alla UO (XML conforme a schema LISTA_STD.xsd)
3130        																	-- Ogni gruppo è un tag "Riga" che può contenere le seguenti colonne:
3131        																	-- 1: Identificativo del gruppo di privilegi
3132        																	-- 2: Nome del gruppo di privilegi
3133        			FlgDichIPAOut			OUT		PLS_INTEGER,					-- (valori 1/0) Se 1 è una UO dichiarata all'Indice PA
3134        			DtDichIPAOut			OUT		VARCHAR2,						-- Data di dichiarazione della UO all'indice PA (nel formato dato dal parametro di conf. FMT_STD_DATA).
3135        			CIProvUOOut				OUT 		DMT_STRUTTURA_ORG.PROV_CI_UO%TYPE,		-- Codice identificativo della UO nel sistema di provenienza
3136        			FlgLockedOut			OUT		PLS_INTEGER,					-- (valori 1/0) Indicatore di UO riservata dal sistema e non modificabile/cancellabile da GUI
3137        			XMLGruppiAppOut			OUT		NOCOPY CLOB,					-- Lista con i gruppi cui appartiene la UO
3138        																	-- Ogni gruppo di appartenenza è un tag "Riga" con le colonne:
3139        																	-- 1: Id. del gruppo
3140        																	-- 2: Nome del gruppo
3141        																	-- 3: flag 1/0 che indica se nel gruppo sono incluse le sotto-UO
3142        																	-- 4: flag 1/0 che indica se nel gruppo sono incluse le scrivanie
3143        			XMLContattiOut			OUT		NOCOPY CLOB,					-- Lista con i contatti (rif. telefonici, fax, e-mail) della UO (XML conforme a schema LISTA_STD.xsd)
3144        																	-- Ogni contatto è tag "Riga" che può contenere le seguenti colonne:
3145        																	-- 1: Identificativo (ROWID preceduto da Tipo - T/F/E) con cui il contatto è già stata registrato in banca dati
3146        																	-- 2: (obblig.) Flag che indica il tipo di contatto. Valori possibili: T=Telefono; F=Fax; E=e-Mail
3147        																	-- 3: N.ro di telefono/fax o indirizzo e-mail
3148        																	-- 4: Tipo di numero di telefono (abitazione, ufficio, cell. ecc.) Valori da apposita dictionary entry
3149        																	-- 5: (valori 1/0/NULL) Flag di indirizzo e-mail di Posta Elettronica Certificata
3150        																	-- 6: (valori 1/0/NULL) Flag di indirizzo e-mail dichiarato all'Indice PA
3151        																	-- 7: (valori 1/0/NULL) Flag di indirizzo e-mail che è Casella Istituzionale di una PA
3152        																	-- 8: Estremi del gestore della casella se è di Posta Elettronica Certificata
3153        			RowidOut				OUT		VARCHAR2,						-- Rowid del record della UO
3154        			AttributiAddOut			OUT		NOCOPY CLOB,					-- Lista degli eventuali ulteriori attributi con cui caratterizzare la UO (XML conforme a schema LISTA_STD.xsd)
3155        																	-- Ogni attributo è un tag "Riga" che contiene le seguenti colonne:
3156        																	-- 1: N.ro (valori da 1 a n) del riquadro (fieldset) in cui mostrare l'attributo
3157        																	-- 2: Nome identificativo dell'attributo (ATTR_NAME)
3158        																	-- 3: Label del campo con cui rappresentare l'attributo
3159        																	-- 4: Tipo di attributo. Valori: DATE, DATETIME, TEXT, TEXT-AREA, CHECK, INTEGER, EURO, DECIMAL, COMBO-BOX, LISTA
3160        																	-- 5: N.ro massimo di caratteri/cifre
3161        																	-- 6: Larghezza del campo con cui rappresentare l'attributo (size)
3162        																	-- 7: Valore dell'attributo
3163        																	-- 8: Label del riquadro (fieldset) in cui mostrare l'attributo
3164        																	-- 9: (valori 1/0) 1 indica che l'attributo è obbligatorio, 0 che è facoltativo
3165        																	-- 10: Altezza (in nro righe) del campo con cui rappresentare l'attributo (se TEXT-AREA)
3166        																	-- 11:(valori 1/0) 1 indica se l'attributo è modificabile, 0 che è in sola visualizzazione
3167        			BachSizeOut				OUT		PLS_INTEGER,					-- Indica il massimo n.ro di record per ogni pagina da mostrare nelle liste del dettaglio
3168        			FlgMostraAltriAttrOut		OUT		PLS_INTEGER,					-- (valori 1/0) Se 1 nella GUI vanno mostrati gli attributi addizionali (ce ne sono di visibile all'utente), se 0 no
3169        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
3170        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
3171        			ErrMsgOut				OUT 		VARCHAR2,						-- Messaggio d'errore
3172        			IdOrganigrammaIn		IN			DMT_ORGANIGRAMMI.ID_ORGANIGRAMMA%type DEFAULT NULL,
3173        																			-- Id. dell'organigramma in cui reperire i dati della UO. Se non specificato è l'ID dell'unico organigramma in cui compare la UO (se individuabile)
3174        			XMLPuntiProtocolloOut	OUT		NOCOPY CLOB, 					-- Lista XML con i dati dei punti di protocollo associati
3175        			XMLPrececessoriOut		OUT		NOCOPY CLOB, 					-- Lista XML con i dati delle UO predecessori
3176        																			-- Ogni riga è una UO predecessore e contiene le colonne
3177        																			-- 1) Tipo di azione che lega al predecessore: accorpamento, split
3178        																			-- 2) Id. UO del precedessore
3179        																			-- 3) Codice/livelli del predecessore
3180        																			-- 4) Denominazione del predecessore
3181        			XMLSuccessoriOut		OUT		NOCOPY CLOB, 					-- Lista XML con i dati delle UO successori
3182        																			-- Ogni riga è una UO successore e contiene le colonne
3183        																			-- 1) Tipo di azione che lega al successore: accorpamento, split
3184        																			-- 2) Id. UO del successore
3185        																			-- 3) Codice/livelli del successore
3186        																			-- 4) Denominazione del successore
3187        			FlgPresentiMailOut		OUT		PLS_INTEGER,					-- Flag 1/0/NULL che indica se c'è almeno una mail assegnata alla UO (=1) o nessuna
3188        			IdUODestMailOut			OUT		INTEGER,						-- Id. della UO a cui spostare le mail assegnate alla UO (in genere impostata in caso di cessazione della UO)
3189        			LivelliUODestMailOut	OUT		VARCHAR2,						-- Livelli della UO a cui spostare le mail assegnate alla UO (in genere impostata in caso di cessazione della UO)
3190        			DesUODestMailOut		OUT		VARCHAR2,						-- Denominazione della UO a cui spostare le mail assegnate alla UO (in genere impostata in caso di cessazione della UO)
3191        			StatoSpostMailOut		OUT		VARCHAR2,						-- Indica lo stato dello spostamento delle mail dalla UO ad altra indicata: da avviare, in corso, completato
3192        			TsInizioSpostMailOut	OUT		VARCHAR2,						-- Data e ora (prevista o effettiva) di inizio spostamento delle mail nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP
3193        			TsFineSpostMailOut		OUT		VARCHAR2,						-- Data e ora di fine spostamento delle mail nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP
3194        			NroMailAssOut			OUT		INTEGER,						-- N.ro di mail ancora assegnate alla UO
3195        			TsRilevNroMailAssOut	OUT		VARCHAR2,						-- Data e ora di rilevamento - nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP - del n.ro di mail assegnate alla UO indicato in NroMailAssOut
3196        			FlgPresentiDocFascOut	OUT		PLS_INTEGER,					-- Flag 1/0/NULL che indica se c'è almeno un documento o fascicolo assegnato alla UO (=1) o nessuno
3197        			IdUODestDocFascOut		OUT		INTEGER,						-- Id. della UO a cui spostare documenti e fascicoli assegnati alla UO (in genere impostata in caso di cessazione della UO)
3198        			LivelliUODestDocFascOut	OUT		VARCHAR2,						-- Livelli della UO a cui spostare documenti e fascicoli assegnati alla UO (in genere impostata in caso di cessazione della UO)
3199        			DesUODestDocFascOut		OUT		VARCHAR2,						-- Denominazione della UO a cui spostare documenti e fascicoli assegnati alla UO (in genere impostata in caso di cessazione della UO)
3200        			StatoSpostDocFascOut	OUT		VARCHAR2,						-- Indica lo stato dello spostamento di documenti e fascicoli dalla UO ad altra indicata: da avviare, in corso, completato
3201        			TsInizioSpostDocFascOut	OUT		VARCHAR2,						-- Data e ora (prevista o effettiva) di inizio spostamento di documenti e fascicoli nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP
3202        			TsFineSpostDocFascOut	OUT		VARCHAR2,						-- Data e ora di fine spostamento di documenti e fascicoli nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP
3203        			NroDocAssOut			OUT		INTEGER,						-- N.ro di documenti ancora assegnati alla UO
3204        			TsRilevNroDocAssOut		OUT		VARCHAR2,						-- Data e ora di rilevamento - nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP - del n.ro di documenti assegnati alla UO indicato in NroDocAssOut
3205        			NroFascAssOut			OUT		INTEGER,						-- N.ro di fascicoli ancora assegnati alla UO
3206        			TsRilevNroFascAssOut	OUT		VARCHAR2						-- Data e ora di rilevamento - nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP - del n.ro di fascicoli assegnati alla UO indicato in NroDocFascOut
3207        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine , altrimenti 0 (in caso di errore o warning)
3208        
3209        	/*********** funzione per cancellare fisicamente una UO ****************/
3210        	function DUO(
3211        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
3212        																	-- (obblig). Codice identificativo del token di connessione
3213        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
3214        			IdUOIn				IN 		DMT_STRUTTURA_ORG.ID_UO%type ,		-- Id. della UO da eliminare
3215        			NriLivelliUOIn			IN		VARCHAR2,						-- N.ri livelli della UO da eliminare
3216        																	-- I nri vanno indicati così come appaiono nella GUI e con il saparatore previsto nella GUI per i livelli UO
3217        			DenominazioneIn			IN		DMT_STRUTTURA_ORG.DENOMINAZIONE%type,	-- Denominazione della UO da eliminare (ricerca case insensitiive in like senza forzare % finale)
3218        			MotiviIn				IN		DMT_ACTIVITIES.NOTE%type,			-- Motivi della cancellazione/annullamento
3219        			FlgIgnoreWarningIn 		IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 0 o NULL significa che in presenza di WARNING la stored si comporta come in caso di errore; se 1 gli WARNING vengono ignorati
3220        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
3221        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
3222        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
3223        			WarningMsgOut			OUT		VARCHAR2,						-- Messaggio di warning (valorizzato solo se non c'è errore)
3224        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
3225        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
3226        			ErrMsgOut				OUT 		VARCHAR2,						-- Messaggio d'errore
3227        			IdOrganigrammaIn		IN			DMT_ORGANIGRAMMI.ID_ORGANIGRAMMA%type DEFAULT NULL
3228        																			-- Id. dell'organigramma da cui eliminare la UO. Se non specificato è l'ID dell'unico organigramma in cui compare la UO (se individuabile)
3229        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine (senza warning), altrimenti 0 (in caso di errore o warning)
3230        
3231        	/****** funzione per creare o modificare relazioni di un utente con la struttura organizzativa ******/
3232        	function IURelUOUser(
3233        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
3234        																	-- (obblig). Codice identificativo del token di connessione
3235        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
3236        			CIRelUserUOIO			IN OUT	VARCHAR2,						-- Codice identificativo della relazione UO-utente da modificare. Se NULL si intende che la relazione è da creare ex-novo
3237        																	-- E' dato da <ID_UO>.<ID_USER>.<flag del tipo di relazione (A/L/D)>.<inizio validità relazione nel formato DD/MM/RRRR>.<ID_RUOLO_AMM>
3238        			IdUOIn				IN		DMT_STRUTTURA_ORG.ID_UO%type DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
3239        																	-- Id.della UO a cui collegare l'utente.
3240        			NriLivelliUOIn			IN		VARCHAR2 DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
3241        																	-- N.ri livelli della UO a cui collegare l'utente.
3242        																	-- I nri vanno indicati così come appaiono nella GUI e con il saparatore previsto nella GUI per i livelli UO
3243        			DenominazioneUOIn			IN		VARCHAR2 DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
3244        																	-- Denominazione della UO a cui collegare l'utente.
3245        																	-- Può essere la denominazione semplice o la concatenazione con separatore "|" delle denominazioni delle UO gerarchicamente superiori + quella della UO
3246        			IdUserIn				IN		DMT_USERS.ID_USER%type DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
3247        																	-- Id.dell'utente da collegare alla U.O.
3248        																	-- Viene considerato solo se i 2 argomenti successivi sono valorizzati e in caso non congruente con essi viene ignorato
3249        			DesUserIn				IN		DMT_USERS.DES_USER%type DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
3250        																	-- Descrizione dell'utenza da collegare alla U.O.
3251        			UsernameIn				IN		DMT_USERS.USERNAME%type DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
3252        																	-- Username dell'utenza da collegare alla U.O.
3253        			DtInizioVldIn			IN		VARCHAR2 DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'DATE_VAL_NO_UPD'),
3254        																	-- (obblig.) Data di inizio validità della relazione (nel formato dato dal parametro di conf. FMT_STD_DATA).
3255        			DtFineVldIn				IN		VARCHAR2 DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'DATE_VAL_NO_UPD'),
3256        																	-- Data di fine validità della relazione (nel formato dato dal parametro di conf. FMT_STD_DATA).
3257        			FlgTipoRelIn			IN		VARCHAR2 DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
3258        																	-- (obblig.) Tipo della relazione utente - U.O.. Valori possibili:
3259        																	-- A = appartenenza gerarchica
3260        																	-- D = funzionale, ovvero "delega"
3261        																	-- L = a gestire documentazione della UO anche se quest'ultima è cessata
3262        			FlgInclSottoUOIn			IN		PLS_INTEGER DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
3263        																	-- (valori 1/0; viene considerato solo se la relazione è di tipo L o D) Indica se la relazione dell'utente è anche verso le sotto-UO della U.O. indicata
3264        			FlgInclScrivVirtIn		IN		PLS_INTEGER DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
3265        																	-- (valori 1/0; viene considerato solo se la relazione è di tipo L o D) Indica se la relazione dell'utente è anche verso le scrivanie virtuali della U.O. indicata (e delle sue sotto-UO se anch'esse sono incluse nella relazione)
3266        			FlgXScrivaniaIn			IN		VARCHAR2 DEFAULT 'V',				-- (valori N/V/NULL) Indica se in corrispondenza dell'associazione utente-UO deve esserci scrvania virtuale o meno e se questa deve essere creata ex-novo o meno. Valori ammessi:
3267        																	-- N = relazione con scrivania, da creare ex-novo
3268        																	-- V = relazione con scrivania, scelta tra una già esistente
3269        																	-- NULL = relazione senza scrivania (scelta possibile solo se il tipo di relazione è L o D)
3270        			IdScrivaniaIO			IN OUT	DMT_SCRIVANIE_VIRTUALI.ID_SCRIVANIA%type,	-- (in input è considerato solo se FlgXScrivaniaIn=V) Id. della scrivania già esistente da dare all'utente nella relazione
3271        																	-- In output è l'id. della scrivania (preesistente o appena creata) occupata dall'utente nella relazione
3272        			IntestazioneScrivaniaIn		IN		DMT_SCRIVANIE_VIRTUALI.INTESTAZIONE%type DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
3273        																	-- Intestazione della scrivania già esistente da dare all'utente nella relazione
3274        			NuovaIntestazioneScrivaniaIO	IN OUT	DMT_SCRIVANIE_VIRTUALI.INTESTAZIONE%type,	-- Nuova intestazione della scrivania già esistente o da creare/creata ex-novo che è occupata dall'utente nella relazione
3275        																	-- Se in input non è valorizzata o è valorizzata a <COMPOSIZIONE AUTOMATICA> e c'è la scrivania, la sua intestazione verrà creata o aggiornata in automatico e restituita in output
3276        			IdRuoloAmmIn			IN		DMT_RUOLI_AMM.ID_RUOLO_AMM%type DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
3277        																	-- Id. del ruolo ricoperto dall'utente nella sua relazione con la UO
3278        			DesRuoloAmmIn			IN		DMT_RUOLI_AMM.DES_RUOLO_AMM%type DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
3279        																	-- Descrizione del ruolo ricoperto dall'utente nella sua relazione con la UO
3280        			ListaEsclusioniUOPPIn	IN			VARCHAR2 DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
3281        																	-- Esclusioni delle UO collegate al Punto di Protocollo vs cui è definita la relazione: sono le UO collegate al punto di protocollo vs le quali l'utente non deve acquisire relazione di tipo L come altrimenti accade
3282        																	-- E' una lista di ID_UO separati da ; o ,
3283        			FlgPrimarioConRuoloIn		IN		PLS_INTEGER DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
3284        																	--(1/0/NULL) Indica se l'utente è il primario degli utenti con lo stesso ruolo (eventualmente nella UO)
3285        			IdProfiloIn				IN		DMT_PROFILI.ID_PROFILO%type DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
3286        																	-- Id. del profilo di DMT_PROFILI (uno di quelli che hanno un nome) da assegnare alla scrivania occupata dall'utente
3287        			NomeProfiloIn			IN		DMT_PROFILI.NOME_PROFILO%type DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
3288        																	-- Nome del profilo di DMT_PROFILI da assegnare alla scrivania occupata dall'utente (ricerca case-insensitive in like)
3289        			XMLDatiProfiloIn			IN		CLOB DEFAULT NULL,				-- XML (conforme a schema SezioneCache.xsd) che contiene tutti gli attributi del profilo della scrivania occupata dall'utente (tranne i gruppi di privilegi) da settare/aggiornare
3290        																	-- ATTENZIONE: Si intende che gli attributi corrispondenti a tag non presenti restino invariati
3291        																	-- Nell'XML possono esserci tag corrispondenti ad attributi di profilatura solo se non si è specificato un profilo predefinito con i due argomenti IdProfiloIn e/o NomeProfiloIn
3292        			FlgModGruppiPrivIn		IN		VARCHAR2 DEFAULT 'I',				-- (valori I/C) Indica se i gruppi di privilegi indicati nell'argomento successivo sono forniti in modo incrementale (=I) (solo quelle da inserire/cancellare) oppure completo (=C), vale a dire che dovranno soppiantare tutti quelli già associati alla scivania occupata dall'utente
3293        			XMLGruppiPrivIn			IN		CLOB DEFAULT NULL,				-- Lista con i gruppi di privilegi assegnati/da assegnare direttamente (ovvero non tramite profilo) alla scrivania occupata dall'utente  (XML conforme a schema LISTA_STD.xsd)
3294        																	-- Ogni gruppo è un tag "Riga" che può contenere le seguenti colonne:
3295        																	-- 1: Identificativo del gruppo di privilegi
3296        																	-- 2: Nome del gruppo di privilegi (ricerca case insesnsitive in like)
3297        																	-- 3: (valori 1/0/NULL) Flag di gruppo da eliminare
3298        			FlgModGruppiAppIn			IN		VARCHAR2 DEFAULT 'I',				-- (valori I/C) Indica se i gruppi cui appartiene la scrivania occupata dall'utente indicati nell'argomento successivo sono forniti in modo incrementale (=I) (solo quelle da aggiungere o cancellare) oppure completo (=C), vale a dire che dovranno soppiantare tutte quelle già specificati (e relativi al dominio di lavoro) in caso di scrivania già esistente
3299        			XMLGruppiAppIn			IN		CLOB DEFAULT NULL,				-- Lista con i gruppi cui appartiene la scrivania occupata dall'utente
3300        																	-- Ogni gruppo di appartenenza è un tag "Riga" con le colonne:
3301        																	-- 1: Id. del gruppo
3302        																	-- 2: Nome del gruppo
3303        																	-- 3: (valori 1/0) Flag di appartenenza a gruppo da eliminare
3304        			RowidScrivaniaOut			OUT		VARCHAR2,						-- Rowid del record della scrivania occupata dall'utente
3305        			AttributiAddIn			IN		CLOB DEFAULT NULL,				-- XML contenente nomi e valori degli attributi dinamici della scrivania da aggiornare (conforme allo schema SezioneCache.xsd)
3306        																	-- Gli attributi già presenti in DB e per i quali non c'è corrispondente nell'XML restano invariati
3307        																	-- Per tutti gli attributi vale quanto segue:
3308        																	-- Un attributo da settare è un tag "Variabile" dell'XML il cui tag "Nome" contiene il nome identificativo dell'attributo (ATTR_NAME di DMT_ATTRIBUTES_DEF)
3309        																	-- Un attributo da settare è una variabile con tag "ValoreSemplice" se è un attributo a singolo valore e non strutturato (cioè con tipo diverso da COMPLEX)
3310        																	-- altrimenti è una variabile con tag "Lista" che ha un'unica colonna con "Nro" pari a 1 se l'attributo non è strutturato, che ha invece tante colonne quanti gli attributi componenti (ordinate in base al loro NRO_ORD_IN_SUP) se l'attributo è complesso
3311        																	-- Nel caso di variabili con tag "Lista" i valori specificati nell'XML si aggiungono o sostituiscono quelli già presenti in DB a seconda che nell'XML sia presente o meno una variabile con tag "Nome" pari a #Append_<Nome attributo> e tag "ValoreSemplice" pari a 1
3312        																	-- In particolare se non sono specificati valori nell'XML (tag Lista vuoto) e se i valori non sono da aggiungere significa che tutti i valori dell'attributo già presenti in DB vanno rimossi
3313        			FlgStoricizzaDatiIn		IN		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0) Se 1 i veranno storicizzati: cambio di UO; cambio di utenza; intestazione della scrivania
3314        			FlgIgnoreWarningIn 		IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 0 o NULL significa che in presenza di WARNING la stored si comporta come in caso di errore; se 1 gli WARNING vengono ignorati
3315        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
3316        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
3317        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
3318        			WarningMsgOut			OUT		VARCHAR2,						-- Messaggio di warning (valorizzato solo se non c'è errore)
3319        			FlgDatiDaStoricizzareOut	OUT		PLS_INTEGER,					-- (valori 1/NULL) Se FlgStoricizzaDatiIn non è valorizzato e se si sono modificati dati che è previsto storicizzare viene restituito pari a 1
3320        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
3321        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
3322        			ErrMsgOut				OUT 	VARCHAR2,						-- Messaggio d'errore
3323        			FlgIgnoreSingolaAppIn	IN		PLS_INTEGER	DEFAULT NULL,		-- Se 1 salta il controllo che l'utente abbia in un certo momento una sola relazione di appartenenza gerarchica
3324        			FlgTipoDestDocIn		IN		VARCHAR2 DEFAULT NULL,			-- (valori UO/SV) Tipo - UO o SV (=scrivania) - del destinatario a cui a cui spostare documenti e fascicoli assegnati alla scrivania
3325        			IdUOSVDestDocIn			IN		INTEGER DEFAULT NULL,			-- Id. della UO o scrivania a cui spostare documenti e fascicoli assegnati alla scrivania (in genere impostata in caso di cessazione della UO)
3326        			CallingFuncIn			IN		VARCHAR2 DEFAULT NULL			-- Funzione chiamante
3327        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine (senza warning), altrimenti 0 (in caso di errore o warning)
3328        
3329        	/*********** funzione per cancellare fisicamente una relazione UO-utente ****************/
3330        	function DRelUOUser(
3331        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
3332        																	-- (obblig). Codice identificativo del token di connessione
3333        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
3334        			IdUOIn				IN		DMT_STRUTTURA_ORG.ID_UO%type DEFAULT NULL,
3335        																	-- Id.della UO della relazione
3336        			NriLivelliUOIn			IN		VARCHAR2 DEFAULT NULL,				-- N.ri livelli della UO della relazione
3337        																	-- I nri vanno indicati così come appaiono nella GUI e con il saparatore previsto nella GUI per i livelli UO
3338        			DenominazioneUOIn			IN		VARCHAR2 DEFAULT NULL,				-- Denominazione della UO della relazione.
3339        																	-- Può essere la denominazione semplice o la concatenazione con separatore "|" delle denominazioni delle UO gerarchicamente superiori + quella della UO
3340        			IdUserIn				IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id.dell'utente della relazione
3341        			DesUserIn				IN		DMT_USERS.DES_USER%type DEFAULT NULL,	-- Descrizione dell'utenza della relazione
3342        			UsernameIn				IN		DMT_USERS.USERNAME%type DEFAULT NULL,	-- Username dell'utenza della relazione
3343        			FlgTipoRelIn			IN		VARCHAR2 DEFAULT NULL,				-- Tipo della relazione utente - U.O.. Valori possibili:
3344        																				-- A = appartenenza gerarchica
3345        																				-- D = funzionale, ovvero "delega"
3346        																				-- L = a gestire documentazione della UO anche se quest'ultima è cessata
3347        			DtInizioVldIn			IN		VARCHAR2 DEFAULT NULL,				-- Data di inizio validità della relazione (nel formato dato dal parametro di conf. FMT_STD_DATA).
3348        			IdRuoloAmmIn			IN		VARCHAR2 DEFAULT NULL,				-- Id. del ruolo ricoperto
3349        			DesRuoloAmmIn			IN		VARCHAR2 DEFAULT NULL,				-- Descrizione del ruolo ricoperto
3350        			MotiviIn				IN		DMT_ACTIVITIES.NOTE%type DEFAULT NULL,	-- Motivi della cancellazione
3351        			FlgIgnoreWarningIn 		IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 0 o NULL significa che in presenza di WARNING la stored si comporta come in caso di errore; se 1 gli WARNING vengono ignorati
3352        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
3353        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
3354        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
3355        			WarningMsgOut			OUT		VARCHAR2,						-- Messaggio di warning (valorizzato solo se non c'è errore)
3356        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
3357        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
3358        			ErrMsgOut				OUT 	VARCHAR2,						-- Messaggio d'errore
3359        			CallingFuncIn			IN		VARCHAR2 DEFAULT NULL			-- Funzione chiamante
3360        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine (senza warning), altrimenti 0 (in caso di errore o warning)
3361        
3362        	/******** funzione per estrarre i dati di dettaglio di una scrivania di cui siano noti id. e/o intestazione **********/
3363        	function LoadDettScrivania(
3364        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
3365        																	-- (obblig). Codice identificativo del token di connessione
3366        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
3367        			IdScrivaniaIO			IN OUT	DMT_SCRIVANIE_VIRTUALI.ID_SCRIVANIA%type,	-- Id.della scrivania virtuale
3368        			IntestazioneScrivaniaIO		IN OUT	DMT_SCRIVANIE_VIRTUALI.INTESTAZIONE%type,	-- Attuale intestazione della scrivania virtuale
3369        			IdProfiloOut			OUT		DMT_PROFILI.ID_PROFILO%type ,			-- Id. del profilo di DMT_PROFILI assegnato alla scrivania
3370        			NomeProfiloOut			OUT		DMT_PROFILI.NOME_PROFILO%type,		-- Nome del profilo di DMT_PROFILI assegnato alla scrivania
3371        			XMLDatiProfiloOut			OUT		NOCOPY CLOB,					-- XML (conforme a schema SezioneCache.xsd) che contiene tutti gli attributi del profilo della scrivania (tranne i gruppi di privilegi)
3372        			XMLGruppiPrivOut			OUT		NOCOPY CLOB,					-- Lista con i gruppi di privilegi assegnati direttamente (ovvero non tramite profilo) alla scrivania (XML conforme a schema LISTA_STD.xsd)
3373        																	-- Ogni gruppo è un tag "Riga" che può contenere le seguenti colonne:
3374        																	-- 1: Identificativo del gruppo di privilegi
3375        																	-- 2: Nome del gruppo di privilegi
3376        			XMLGruppiAppOut			OUT		NOCOPY CLOB,					-- Lista con i gruppi cui appartiene la scrivania occupata dall'utente nella relazione
3377        																	-- Ogni gruppo di appartenenza è un tag "Riga" con le colonne:
3378        																	-- 1: Id. del gruppo
3379        																	-- 2: Nome del gruppo
3380        			RowidOut				OUT		VARCHAR2,						-- Rowid del record della scrivania
3381        			AttributiAddOut			OUT		NOCOPY CLOB,					-- Lista degli eventuali ulteriori attributi con cui caratterizzare la scrivania (XML conforme a schema LISTA_STD.xsd)
3382        																	-- Ogni attributo è un tag "Riga" che contiene le seguenti colonne:
3383        																	-- 1: N.ro (valori da 1 a n) del riquadro (fieldset) in cui mostrare l'attributo
3384        																	-- 2: Nome identificativo dell'attributo (ATTR_NAME)
3385        																	-- 3: Label del campo con cui rappresentare l'attributo
3386        																	-- 4: Tipo di attributo. Valori: DATE, DATETIME, TEXT, TEXT-AREA, CHECK, INTEGER, EURO, DECIMAL, COMBO-BOX, LISTA
3387        																	-- 5: N.ro massimo di caratteri/cifre
3388        																	-- 6: Larghezza del campo con cui rappresentare l'attributo (size)
3389        																	-- 7: Valore dell'attributo
3390        																	-- 8: Label del riquadro (fieldset) in cui mostrare l'attributo
3391        																	-- 9: (valori 1/0) 1 indica che l'attributo è obbligatorio, 0 che è facoltativo
3392        																	-- 10: Altezza (in nro righe) del campo con cui rappresentare l'attributo (se TEXT-AREA)
3393        																	-- 11:(valori 1/0) 1 indica se l'attributo è modificabile, 0 che è in sola visualizzazione
3394        			BachSizeOut				OUT		PLS_INTEGER,					-- Indica il massimo n.ro di record per ogni pagina da mostrare nelle liste del dettaglio
3395        			FlgMostraAltriAttrOut		OUT		PLS_INTEGER,					-- (valori 1/0) Se 1 nella GUI vanno mostrati gli attributi addizionali (ce ne sono di visibile all'utente), se 0 no
3396        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
3397        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
3398        			ErrMsgOut				OUT 		VARCHAR2						-- Messaggio d'errore
3399        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine , altrimenti 0 (in caso di errore o warning)
3400        
3401        	/****** funzione per estrarre i dettagli di una relazione di un utente con la struttura organizzativa ******/
3402        	function LoadDettRelUOUser(
3403        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
3404        																	-- (obblig). Codice identificativo del token di connessione
3405        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
3406        			IdUOIO				IN OUT	DMT_STRUTTURA_ORG.ID_UO%type,			-- Id.della UO della relazione
3407        			NriLivelliUOIO			IN OUT	VARCHAR2,						-- N.ri livelli della UO della relazione
3408        																	-- I nri vanno indicati così come appaiono nella GUI e con il saparatore previsto nella GUI per i livelli UO
3409        			DenominazioneUOIO			IN OUT	VARCHAR2,						-- Denominazione della UO della relazione.
3410        																	-- Può essere la denominazione semplice o la concatenazione con separatore "|" delle denominazioni delle UO gerarchicamente superiori + quella della UO
3411        			IdUserIO				IN OUT	DMT_USERS.ID_USER%type,				-- Id.dell'utente della relazione
3412        			DesUserIO				IN OUT	DMT_USERS.DES_USER%type,			-- Descrizione dell'utenza della relazione
3413        			UsernameIO				IN OUT	DMT_USERS.USERNAME%type,			-- Username dell'utenza della relazione
3414        			FlgTipoRelIO			IN OUT	VARCHAR2,						-- Tipo della relazione utente - U.O.. Valori possibili:
3415        																			-- A = appartenenza gerarchica
3416        																			-- D = funzionale, ovvero "delega"
3417        																			-- L = a gestire documentazione della UO anche se quest'ultima è cessata
3418        			DtInizioVldIO			IN OUT 	VARCHAR2,						-- Data di inizio validità della relazione (nel formato dato dal parametro di conf. FMT_STD_DATA).
3419        			DtFineVldOut			OUT		VARCHAR2,						-- Data di fine validità della relazione (nel formato dato dal parametro di conf. FMT_STD_DATA).
3420        			FlgInclSottoUOOut			OUT		PLS_INTEGER,					-- (valori 1/0; può essere 1 solo se la relazione è di tipo L o D) Indica se la relazione dell'utente è anche verso le sotto-UO della U.O. indicata
3421        			FlgInclScrivVirtOut		OUT		PLS_INTEGER,					-- (valori 1/0; può essere 1 solo se la relazione è di tipo L o D) Indica se la relazione dell'utente è anche verso le scrivanie virtuali della U.O. indicata (e delle sue sotto-UO se anch'esse sono incluse nella relazione)
3422        			IdScrivaniaOut			OUT		DMT_SCRIVANIE_VIRTUALI.ID_SCRIVANIA%type,	-- Id. della scrivania occupata dall'utente nella relazione
3423        			IntestazioneScrivaniaOut	OUT		DMT_SCRIVANIE_VIRTUALI.INTESTAZIONE%type,	-- Intestazione della scrivania occupata dall'utente nella relazione
3424        			IdRuoloAmmIO			IN OUT	DMT_RUOLI_AMM.ID_RUOLO_AMM%type,		-- Id. del ruolo ricoperto dall'utente nella sua relazione con la UO
3425        			DesRuoloAmmOut			OUT		DMT_RUOLI_AMM.DES_RUOLO_AMM%type,		-- Descrizione del ruolo ricoperto dall'utente nella sua relazione con la UO
3426        			FlgPrimarioConRuoloOut		OUT		PLS_INTEGER,					--(1/0) Indica se l'utente è il primario degli utenti con lo stesso ruolo (eventualmente nella UO)
3427        			IdProfiloOut			OUT		DMT_PROFILI.ID_PROFILO%type ,			-- Id. del profilo di DMT_PROFILI assegnato alla scrivania occupata dall'utente nella relazione
3428        			NomeProfiloOut			OUT		DMT_PROFILI.NOME_PROFILO%type,		-- Nome del profilo di DMT_PROFILI assegnato alla scrivania occupata dall'utente nella relazione
3429        			XMLDatiProfiloOut			OUT		NOCOPY CLOB,					-- XML (conforme a schema SezioneCache.xsd) che contiene tutti gli attributi del profilo della scrivania occupata dall'utente nella relazione (tranne i gruppi di privilegi)
3430        			XMLGruppiPrivOut			OUT		NOCOPY CLOB,					-- Lista con i gruppi di privilegi assegnati direttamente (ovvero non tramite profilo) alla scrivania occupata dall'utente nella relazione (XML conforme a schema LISTA_STD.xsd)
3431        																	-- Ogni gruppo è un tag "Riga" che può contenere le seguenti colonne:
3432        																	-- 1: Identificativo del gruppo di privilegi
3433        																	-- 2: Nome del gruppo di privilegi
3434        			XMLGruppiAppOut			OUT		NOCOPY CLOB,					-- Lista con i gruppi cui appartiene la scrivania occupata dall'utente nella relazione
3435        																	-- Ogni gruppo di appartenenza è un tag "Riga" con le colonne:
3436        																	-- 1: Id. del gruppo
3437        																	-- 2: Nome del gruppo
3438        			FlgUOPPOut				OUT		PLS_INTEGER,			-- Se 1 indica che la UO verso cui c'è la relazione è un punto di protocollo
3439        			XMLUOPPOut				OUT		NOCOPY CLOB,			-- Lista delle UO collegate al punto di protocollo verso cui c'è la relazione
3440        																	-- Ogni riga rappresenta una UO collegata al punto di protocollo ed è un tag "Riga" che contiene le seguenti colonne:
3441        																	-- 1: Id UO della UO collegata al punto di protocollo
3442        																	-- 2: Livelli della UO collegata al punto di protocollo (come vanno mostrati nella GUI)
3443        																	-- 3: Denominazione della UO collegata al punto di protocollo
3444        																	-- 4: (flag 1/0) Se 1 l'utente deriva dalla relazione con il PP quella verso la UO collegata al PP, se 0 no
3445        			RowidOut				OUT		VARCHAR2,				-- Rowid del record della scrivania occupata dall'utente nella relazione
3446        			AttributiAddOut			OUT		NOCOPY CLOB,			-- Lista degli eventuali ulteriori attributi con cui caratterizzare la scrivania occupata dall'utente nella relazione (XML conforme a schema LISTA_STD.xsd)
3447        																	-- Ogni attributo è un tag "Riga" che contiene le seguenti colonne:
3448        																	-- 1: N.ro (valori da 1 a n) del riquadro (fieldset) in cui mostrare l'attributo
3449        																	-- 2: Nome identificativo dell'attributo (ATTR_NAME)
3450        																	-- 3: Label del campo con cui rappresentare l'attributo
3451        																	-- 4: Tipo di attributo. Valori: DATE, DATETIME, TEXT, TEXT-AREA, CHECK, INTEGER, EURO, DECIMAL, COMBO-BOX, LISTA
3452        																	-- 5: N.ro massimo di caratteri/cifre
3453        																	-- 6: Larghezza del campo con cui rappresentare l'attributo (size)
3454        																	-- 7: Valore dell'attributo
3455        																	-- 8: Label del riquadro (fieldset) in cui mostrare l'attributo
3456        																	-- 9: (valori 1/0) 1 indica che l'attributo è obbligatorio, 0 che è facoltativo
3457        																	-- 10: Altezza (in nro righe) del campo con cui rappresentare l'attributo (se TEXT-AREA)
3458        																	-- 11:(valori 1/0) 1 indica se l'attributo è modificabile, 0 che è in sola visualizzazione
3459        			BachSizeOut				OUT		PLS_INTEGER,					-- Indica il massimo n.ro di record per ogni pagina da mostrare nelle liste del dettaglio
3460        			FlgMostraAltriAttrOut		OUT		PLS_INTEGER,					-- (valori 1/0) Se 1 nella GUI vanno mostrati gli attributi addizionali (ce ne sono di visibile all'utente), se 0 no
3461        			FlgPresentiDocFascOut	OUT		PLS_INTEGER,					-- Flag 1/0/NULL che indica se c'è almeno un documento o fascicolo assegnato alla scrivania (=1) o nessuno
3462        			FlgTipoDestDocOut		OUT		VARCHAR2,						-- (valori UO/SV) Tipo - UO o SV (=scrivania) - del destinatario a cui a cui spostare documenti e fascicoli assegnati alla scrivania
3463        			IdUOSVDestDocFascOut	OUT		INTEGER,						-- Id. della UO o scrivania a cui spostare documenti e fascicoli assegnati alla scrivania (in genere impostata in caso di cessazione della UO)
3464        			LivelliUODestDocFascOut	OUT		VARCHAR2,						-- Livelli della UO a cui spostare documenti e fascicoli assegnati alla scrivania (in genere impostata in caso di cessazione della UO)
3465        			DesUODestDocFascOut		OUT		VARCHAR2,						-- Denominazione della UO o scrivania a cui spostare documenti e fascicoli assegnati alla scrivania (in genere impostata in caso di cessazione della UO)
3466        			StatoSpostDocFascOut	OUT		VARCHAR2,						-- Indica lo stato dello spostamento di documenti e fascicoli dalla scrivania ad altra UO o scrivania indicata: da avviare, in corso, completato
3467        			TsInizioSpostDocFascOut	OUT		VARCHAR2,						-- Data e ora (prevista o effettiva) di inizio spostamento di documenti e fascicoli nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP
3468        			TsFineSpostDocFascOut	OUT		VARCHAR2,						-- Data e ora di fine spostamento di documenti e fascicoli nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP
3469        			NroDocAssOut			OUT		INTEGER,						-- N.ro di documenti ancora assegnati alla scrivania
3470        			TsRilevNroDocAssOut		OUT		VARCHAR2,						-- Data e ora di rilevamento - nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP - del n.ro di documenti assegnati alla scrivania indicato in NroDocAssOut
3471        			NroFascAssOut			OUT		INTEGER,						-- N.ro di fascicoli ancora assegnati alla scrivania
3472        			TsRilevNroFascAssOut	OUT		VARCHAR2,						-- Data e ora di rilevamento - nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP - del n.ro di fascicoli assegnati alla scrivania indicato in NroDocFascOut
3473        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
3474        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
3475        			ErrMsgOut				OUT 		VARCHAR2					-- Messaggio d'errore
3476        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine , altrimenti 0 (in caso di errore o warning)
3477        
3478        	/*** Funzione di creazione delega da utente a utente											***/
3479        	/*** se la delega già esiste non viene dato errore (viene solo aggiornato il perido di validità)			***/
3480        	function AddDelegaVsUser(
3481        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
3482        																	-- (obblig). Codice identificativo del token di connessione
3483        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
3484        			DelDa_IdUserIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a cui dare la delega.
3485        			DelDa_DesUserIn			IN 		DMT_USERS.DES_USER%type DEFAULT NULL,	-- Cognome e nome /descrizione dell'utente a cui dare la delega
3486        			DelDa_UsernameIn			IN		DMT_USERS.USERNAME%type DEFAULT NULL,	-- Username (interna al sistema) dell'utente a cui dare la delega
3487        			DelVs_IdUserIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente verso cui dare la delega.
3488        			DelVs_DesUserIn			IN 		DMT_USERS.DES_USER%type DEFAULT NULL,	-- Cognome e nome /descrizione dell'utente verso cui dare la delega
3489        			DelVs_UsernameIn			IN		DMT_USERS.USERNAME%type DEFAULT NULL,	-- Username (interna al sistema) dell'utente a cui dare la delega
3490        			DtInizioVldIn			IN		VARCHAR2 DEFAULT NULL,				-- Data di inizio validità (nel formato dato dal parametro di conf. FMT_STD_DATA) della delega.
3491        			DtFineVldIn				IN		VARCHAR2 DEFAULT NULL,				-- Data di fine validità (nel formato dato dal parametro di conf. FMT_STD_DATA) della delega.
3492        			NaturaMotiviIn			IN		VARCHAR2 DEFAULT NULL,				-- Natura/motivi della delega
3493        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
3494        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
3495        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
3496        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
3497        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
3498        			ErrMsgOut				OUT 		VARCHAR2						-- Messaggio d'errore
3499        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine, altrimenti 0 (in caso di errore o warning)
3500        
3501        	/******** funzione per gestire/aggiornare le deleghe di un dato utente vs altri utenti ********/
3502        	function SetDelegheUserVsUsers(
3503        			CodIdConnectionTokenIn		IN	    DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
3504        																						-- (obblig). Codice identificativo del token di connessione
3505        			IdUserLavoroIn				IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
3506        			IdUserIn					IN 		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente di cui gestire/aggiornare le deleghe
3507        			UsernameIn					IN		DMT_USERS.USERNAME%type DEFAULT NULL,	-- Username (interna al sistema) dell'utente di cui gestire/aggiornare le deleghe
3508        			DesUserIn					IN 		DMT_USERS.DES_USER%type DEFAULT NULL,	-- Cognome e nome/descrizione dell'utente (ricerca case insensitive in like senza forzare il % finale) di cui gestire/aggiornare le deleghe
3509        																						-- ATTENZIONE: Se nessuno dei 3 argomenti precedenti è valorizzato si intende che l'utente di cui gestire/aggiornare le deleghe sia quello connesso
3510        			FlgModDelegheIn				IN		VARCHAR2 DEFAULT 'I',					-- (valori I/C) Indica se le deleghe vs utenti indicate nell'argomento successivo sono fornite in modo incrementale (=I) (solo quelle da aggiungere o cancellare) oppure completo (=C), vale a dire che dovranno soppiantare tutte quelle già specificate (solo quelle relative ad utenti accreditati sul dominio di lavoro)
3511        			XMLDelegheIn				IN		CLOB DEFAULT NULL,						-- Lista delle deleghe vs utenti da aggiornare (XML conforme a schema LISTA_STD.xsd)
3512        																						-- Ogni delega è un tag "Riga" che contiene le seguenti colonne:
3513        																						-- 1: Rowid che indica il record di delega da aggiornare/eliminare
3514        																						-- 2: Identificativo (ID_USER) dell'utente verso cui c'è la delega
3515        																						-- 3: Denominazione/descrizione dell'utente verso cui c'è la delega (o suo inizio; ricerca case insensitive in like senza forzare il % finale).
3516        																						-- 4: Data di inizio validità della delega (nel formato dato dal parametro di config. FMT_STD_DATA). Se NULL si intende valida da tempo illimitato
3517        																						-- 5: Data di fine validità della delega (nel formato dato dal parametro di config. FMT_STD_DATA). Se NULL si intende valida illimitatamente.
3518        																						-- 6: Motivo/i della delega
3519        																						-- 7: (valori 1/0/NULL) Flag di delega da eliminare
3520        			FlgRollBckFullIn		IN 			PLS_INTEGER DEFAULT NULL,				-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
3521        																						-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
3522        			FlgAutoCommitIn			IN 			PLS_INTEGER DEFAULT NULL,				-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
3523        			ErrContextOut			OUT			VARCHAR2,								-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
3524        			ErrCodeOut				OUT			PLS_INTEGER,							-- N.ro errore di uscita
3525        			ErrMsgOut				OUT 		VARCHAR2								-- Messaggio d'errore
3526        			) return PLS_INTEGER;														-- Vale 1 se tutto è andato a buon fine, altrimenti 0 (in caso di errore)
3527        
3528        	/******** funzione per ottenere le deleghe di un dato utente vs altri utenti accreditati sul dominio di lavoro ********/
3529        	function GetDelegheUserVsUsers(
3530        			CodIdConnectionTokenIn		IN	    DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
3531        																						-- (obblig). Codice identificativo del token di connessione
3532        			IdUserLavoroIn				IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
3533        			IdUserIn					IN 		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente di cui ottenere le deleghe va altri utenti accreditati sul dominio di lavoro
3534        			UsernameIn					IN		DMT_USERS.USERNAME%type DEFAULT NULL,	-- Username (interna al sistema) dell'utente di cui ottenere le deleghe va altri utenti accreditati sul dominio di lavoro
3535        			DesUserIn					IN 		DMT_USERS.DES_USER%type DEFAULT NULL,	-- Cognome e nome/descrizione dell'utente (ricerca case insensitive in like senza forzare il % finale) di cui ottenere le deleghe va altri utenti accreditati sul dominio di lavoro
3536        																						-- ATTENZIONE: Se nessuno dei 3 argomenti precedenti è valorizzato si intende che l'utente di cui ottenere le deleghe va altri utenti accreditati sul dominio di lavoro sia quello connesso
3537        			XMLDelegheOut				OUT		NOCOPY CLOB,							-- Lista delle deleghe vs utenti accreditati sul dato dominio (XML conforme a schema LISTA_STD.xsd)
3538        																						-- Ogni delega è un tag "Riga" che contiene le seguenti colonne:
3539        																						-- 1: Rowid che indica il record-delega
3540        																						-- 2: Identificativo (ID_USER) dell'utente verso cui c'è la delega
3541        																						-- 3: Denominazione/descrizione dell'utente verso cui c'è la delega
3542        																						-- 4: Data di inizio validità della delega (nel formato dato dal parametro di config. FMT_STD_DATA). Se NULL si intende valida da tempo illimitato
3543        																						-- 5: Data di fine validità della delega (nel formato dato dal parametro di config. FMT_STD_DATA). Se NULL si intende valida illimitatamente.
3544        																						-- 6: Motivo/i della delega
3545        			ErrContextOut			OUT			VARCHAR2,								-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
3546        			ErrCodeOut				OUT			PLS_INTEGER,							-- N.ro errore di uscita
3547        			ErrMsgOut				OUT 		VARCHAR2								-- Messaggio d'errore
3548        			) return PLS_INTEGER;														-- Vale 1 se tutto è andato a buon fine, altrimenti 0 (in caso di errore)
3549        
3550        	/*########mancano
3551        	ricerca profili e load. dett. profilo
3552        	*/
3553        
3554        	--------funzione per sapere il tipo di relazione - appartenenza gerarchica o funzionale/delega - da proporre
3555        	--------per una nuova collocazione di un dato utente in una data UO (eventualmente come sostituzione di altro utente)
3556        	function GetTipoNuovaRelUOUser(
3557        		IdUOIn						IN		DMT_STRUTTURA_ORG.ID_UO%type,	-- (obblig.) Id. della UO in cui creare la nuova postazione in organigramma
3558        		IdUserIn					IN		DMT_USERS.ID_USER%type,			-- (obblig.) Id. dell'utente cui assegnare la nuova postazione in organigramma
3559        		DtInizioVldIn				IN		VARCHAR2 DEFAULT NULL,			-- Data di inizio validità della relazione da creare (nel formato DD/MM/RRRR)
3560        																			-- Se non valorizzata si intende pari alla data odierna
3561        		CIRelUserUOToSubstIn		IN 		VARCHAR2,						-- Codice identificativo della relazione UO-utente da sostituire con la nuova postazione.
3562        																			-- E' dato da <ID_UO>.<ID_USER>.<flag del tipo di relazione (A/L/D)>.<inizio validità relazione nel formato DD/MM/RRRR>.<ID_RUOLO_AMM>
3563        		FlgTipoRelOut				OUT		VARCHAR2,						-- Indica il tipo di relazione da proporre per la nuova postazione
3564        																			-- A = appartenenza gerarchica
3565        																			-- D = funzionale/delega
3566        		ErrContextOut				OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
3567        		ErrCodeOut					OUT		PLS_INTEGER,					-- N.ro errore di uscita
3568        		ErrMsgOut					OUT 	VARCHAR2						-- Messaggio d'errore
3569        		) return PLS_INTEGER;												-- Vale 1 se tutto è andato a buon fine, altrimenti 0 (in caso di errore)
3570        
3571        	------ funzione per sostituire un utente nella postazione di un altro
3572        	function SubstUserInRelUO(
3573        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
3574        																	-- (obblig). Codice identificativo del token di connessione
3575        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
3576        			CIRelUserUOIO			IN OUT	VARCHAR2,						-- Codice identificativo della relazione UO-utente in cui mettere in nuovo utente
3577        																			-- E' dato da <ID_UO>.<ID_USER>.<flag del tipo di relazione (A/L/D)>.<inizio validità relazione nel formato DD/MM/RRRR>.<ID_RUOLO_AMM>
3578        			IdUserNewIn				IN		DMT_USERS.ID_USER%type DEFAULT NULL,
3579        																			-- Id.del nuovo utente da mettere nella postazione
3580        			DesUserNewIn			IN		DMT_USERS.DES_USER%type DEFAULT NULL,
3581        																			-- Nome del nuovo utente da mettere nella postazione
3582        			UsernameNewIn			IN		DMT_USERS.USERNAME%type DEFAULT NULL,
3583        																			-- Username del nuovo utente da mettere nella postazione
3584        			DtInizioVldIn			IN		VARCHAR2,						-- (obblig.) Data di decorrenza associazione nuovo utente con la postazione(nel formato dato dal parametro di conf. FMT_STD_DATA).
3585        			DtFineVldIn				IN		VARCHAR2 DEFAULT NULL,			-- Data di fine validità associazione nuovo utente con la postazione (nel formato dato dal parametro di conf. FMT_STD_DATA).
3586        			FlgTipoRelIn			IN		VARCHAR2,						-- (obblig.) Tipo della relazione utente - U.O.. Valori possibili:
3587        																			-- A = appartenenza gerarchica
3588        																			-- D = funzionale, ovvero "delega"
3589        																			-- L = a gestire documentazione della UO anche se quest'ultima è cessata
3590        			FlgInclSottoUOIn		IN		PLS_INTEGER DEFAULT NULL,		-- (valori 1/0) Indica se la relazione del nuovo utente con la UO è anche verso le sotto-UO della U.O. indicata
3591        			FlgInclScrivVirtIn		IN		PLS_INTEGER DEFAULT NULL,		-- (valori 1/0) Indica se la relazione del nuovo utente è anche verso le scrivanie virtuali della U.O. indicata (e delle sue sotto-UO se anch'esse sono incluse nella relazione)
3592        			IdRuoloAmmIn			IN		DMT_RUOLI_AMM.ID_RUOLO_AMM%type DEFAULT NULL,
3593        																			-- Id. del ruolo ricoperto dal nuovo utente nella sua relazione con la UO
3594        			DesRuoloAmmIn			IN		DMT_RUOLI_AMM.DES_RUOLO_AMM%type DEFAULT NULL,
3595        																			-- Descrizione del ruolo ricoperto dal nuovo utente nella sua relazione con la UO
3596        			ListaEsclusioniUOPPIn	IN			VARCHAR2 DEFAULT NULL,
3597        																			-- Esclusioni delle UO collegate al Punto di Protocollo vs cui è definita la relazione: sono le UO collegate al punto di protocollo vs le quali l'utente non deve acquisire relazione di tipo L come altrimenti accade
3598        																			-- E' una lista di ID_UO separati da ; o ,
3599        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,	-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
3600        																			-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
3601        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,		-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
3602        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
3603        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
3604        			ErrMsgOut				OUT 		VARCHAR2					-- Messaggio d'errore
3605        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine, altrimenti 0 (in caso di errore)
3606        
3607        	/***** funzione per associare ad una o più UO uno o più punti di protocollo 	 *****/
3608        	/***** se il punto di protocollo era già associato alla UO non viene dato errore *****/
3609        	function AssociaPuntiProtocollo(
3610        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
3611        																			-- (obblig). Codice identificativo del token di connessione
3612        			IdUserLavoroIn				IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
3613        			XMLUOIn						IN		CLOB,						-- Lista xml (secondo schema ListaStd.xsd) delle UO cui aggiungere i punti di protocollo.
3614        																			-- Ogni UO è una riga con una sola colonna con l'ID_UO
3615        			XMLPuntiProtIn				IN		CLOB,						-- Lista xml (secondo schema ListaStd.xsd) dei punti di protocollo
3616        																			-- Ogni punto di protocollo è una riga con una sola colonna con l'ID_UO
3617        			EsitiOut					OUT		NOCOPY CLOB,				-- Lista XML conforme a schema ListaSTD.xsd che contiene gli esiti dell'operazione su ciascuna UO in input
3618        																			-- Ogni UO corrisponde ad un tag riga con le colonne:
3619        																				-- 1: ID_UO
3620        																				-- 2: Codice/livelli UO
3621        																				-- 3: Denominazione UO
3622        																				-- 4: Esito operazione: OK, KO
3623        																				-- 5: Messaggio di errore
3624        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,	-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
3625        																			-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
3626        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,		-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
3627        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
3628        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
3629        			ErrMsgOut				OUT 		VARCHAR2					-- Messaggio d'errore
3630        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine, altrimenti 0 (in caso di errore)
3631        
3632        	/***** funzione per scollegare da una o più UO uno o più punti di protocollo 	 	 *****/
3633        	/***** se il punto di protocollo NON era già associato alla UO non viene dato errore *****/
3634        	function ScollegaPuntiProtocollo(
3635        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
3636        																			-- (obblig). Codice identificativo del token di connessione
3637        			IdUserLavoroIn				IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
3638        			XMLUOIn						IN		CLOB,						-- Lista xml (secondo schema ListaStd.xsd) delle UO da cui togliere i punti di protocollo.
3639        																			-- Ogni UO è una riga con una sola colonna con l'ID_UO
3640        			XMLPuntiProtIn				IN		CLOB,						-- Lista xml (secondo schema ListaStd.xsd) dei punti di protocollo
3641        																			-- Ogni punto di protocollo è una riga con una sola colonna con l'ID_UO
3642        			EsitiOut					OUT		NOCOPY CLOB,				-- Lista XML conforme a schema ListaSTD.xsd che contiene gli esiti dell'operazione su ciascuna UO in input
3643        																			-- Ogni UO corrisponde ad un tag riga con le colonne:
3644        																				-- 1: ID_UO
3645        																				-- 2: Codice/livelli UO
3646        																				-- 3: Denominazione UO
3647        																				-- 4: Esito operazione: OK, KO
3648        																				-- 5: Messaggio di errore
3649        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,	-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
3650        																			-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
3651        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,		-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
3652        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
3653        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
3654        			ErrMsgOut				OUT 		VARCHAR2					-- Messaggio d'errore
3655        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine, altrimenti 0 (in caso di errore)
3656        
3657        	---- funzione per aggiungere o toglere dai destinatari preferiti di un utente - quello collegato o per cui si sta lavorano - una UO o scrivania o utente o gruppo
3658        	function AddDelDestPreferito(
3659        			CodIdConnectionTokenIn	IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
3660        																						-- (obblig). Codice identificativo del token di connessione
3661        			IdUserLavoroIn			IN			DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
3662        			FlgTipoIn				IN			VARCHAR2,								-- (obblig.) Tipo di destinatario: UO = Unità Operativa, SV = Scrivania, UT = Utente, G = Gruppo
3663        			IdDestPrefIn			IN			INTEGER,								-- (obblig.) Id. della UO/scrivania/utente/gruppo da mettere tra i preferiti
3664        			FlgAddDelIn				IN			VARCHAR2 DEFAULT 'A',					-- (obblig.) Indica se UO/scrivania/utente/gruppo da aggiungere (A) o togliere (D) dai preferiti
3665        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,				-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
3666        																						-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
3667        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,					-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
3668        			ErrContextOut			OUT		VARCHAR2,									-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
3669        			ErrCodeOut				OUT		PLS_INTEGER,								-- N.ro errore di uscita
3670        			ErrMsgOut				OUT 		VARCHAR2								-- Messaggio d'errore
3671        			) return PLS_INTEGER;														-- Vale 1 se tutto è andato a buon fine, altrimenti 0 (in caso di errore)
3672        
3673        	-----------funzione che data una UO - il suo ID - trova l'id. della UO - la stessa in input o la prima superiore - che risulta presente nell'atto di definizione organigramma
3674        	function GetIdUOSupInAtto(
3675        			IdUOIn					IN		DMT_STRUTTURA_ORG.ID_UO%type,				-- (obblig.) Id. della UO per cui trovare la UO superiore o coincidente che risulta presente nell'atto di definizione organigramma
3676        			TsRifIn			IN		VARCHAR2 default TO_CHAR(sysdate, 'DD/MM/RRRR HH24:MI:SS')
3677        																						-- Stringa con il timestamp (nel formato GG/MM/AAAA HH24:MI:SS) al quale si richiede di determinare la UO superiore o coincidente che risulta presente nell'atto di definizione organigramma
3678        			) return DMT_STRUTTURA_ORG.ID_UO%type;										-- Id. della UO superiore o coincidente che risulta presente nell'atto di definizione organigramma
3679        
3680        	-----------procedura che resetta le preference di idUODefault e cod.organigramma degli utenti per tener conto dei cambi di organigramma (da lanciare ogni notte dopo mezzanotte)
3681        	procedure ResetUOCodOrgDefault;
3682        
3683        
3684        	/****** funzione per spostare una postazione utente sotto una diversa UO ******/
3685        	function MovePostazioneUtente(
3686        			CodIdConnectionTokenIn	IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
3687        																						-- (obblig). Codice identificativo del token di connessione
3688        			IdUserLavoroIn			IN			DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
3689        			CIRelUserUOIO			IN OUT		VARCHAR2,								-- Codice identificativo della relazione UO-utente da spostare.
3690        																						-- E' dato da <ID_UO>.<ID_USER>.<flag del tipo di relazione (A/L/D)>.<inizio validità relazione nel formato DD/MM/RRRR>.<ID_RUOLO_AMM>
3691        			IdUOIn					IN			DMT_STRUTTURA_ORG.ID_UO%type DEFAULT NULL,
3692        																						-- Id.della UO sotto cui spostare l'utente.
3693        			NriLivelliUOIn			IN			VARCHAR2 DEFAULT NULL,					-- N.ri livelli della UO sotto cui spostare l'utente.
3694        																						-- I nri vanno indicati così come appaiono nella GUI e con il saparatore previsto nella GUI per i livelli UO
3695        			DenominazioneUOIn		IN			VARCHAR2 DEFAULT NULL,					-- Denominazione della UO sotto cui spostare l'utente.
3696        																						-- Può essere la denominazione semplice o la concatenazione con separatore "|" delle denominazioni delle UO gerarchicamente superiori + quella della UO
3697        			DtInizioVldIn			IN			VARCHAR2,								-- (obblig.) Data di inizio validità della relazione con la nuova UO(nel formato dato dal parametro di conf. FMT_STD_DATA).
3698        			DtFineVldIn				IN			VARCHAR2,								-- Data di fine validità della relazione con la nuova UO(nel formato dato dal parametro di conf. FMT_STD_DATA).
3699        			FlgTipoRelIn			IN			VARCHAR2 DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
3700        																						-- (obblig.) Tipo della relazione utente - U.O.. Valori possibili:
3701        																						-- A = appartenenza gerarchica
3702        																						-- D = funzionale, ovvero "delega"
3703        																						-- L = a gestire documentazione della UO anche se quest'ultima è cessata
3704        			FlgInclSottoUOIn		IN			PLS_INTEGER DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
3705        																						-- (valori 1/0) Indica se la relazione dell'utente è anche verso le sotto-UO della U.O. indicata
3706        			FlgInclScrivVirtIn		IN			PLS_INTEGER DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
3707        																						-- (valori 1/0) Indica se la relazione dell'utente è anche verso le scrivanie virtuali della U.O. indicata (e delle sue sotto-UO se anch'esse sono incluse nella relazione)
3708        			NuovaIntestazioneScrivaniaIO IN OUT	DMT_SCRIVANIE_VIRTUALI.INTESTAZIONE%type,	-- Nuova intestazione della scrivania che è occupata dall'utente nella relazione
3709        																						-- Se in input non è valorizzata o è valorizzata a <COMPOSIZIONE AUTOMATICA> e c'è la scrivania, la sua intestazione verrà creata o aggiornata in automatico e restituita in output
3710        			IdRuoloAmmIn			IN			DMT_RUOLI_AMM.ID_RUOLO_AMM%type DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
3711        																						-- Id. del ruolo ricoperto dall'utente nella sua relazione con la UO
3712        			DesRuoloAmmIn			IN			DMT_RUOLI_AMM.DES_RUOLO_AMM%type DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
3713        																						-- Descrizione del ruolo ricoperto dall'utente nella sua relazione con la UO
3714        			ListaEsclusioniUOPPIn	IN			VARCHAR2 DEFAULT NULL,
3715        																						-- Esclusioni delle UO collegate al Punto di Protocollo vs cui viene spostata relazione: sono le UO collegate al punto di protocollo vs le quali l'utente non deve acquisire relazione di tipo L come altrimenti accade
3716        																						-- E' una lista di ID_UO separati da ; o ,
3717        			FlgPrimarioConRuoloIn	IN			PLS_INTEGER DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
3718        																						--(1/0/NULL) Indica se l'utente è il primario degli utenti con lo stesso ruolo (eventualmente nella UO)
3719        			AttributiAddIn			IN			CLOB DEFAULT NULL,						-- XML contenente nomi e valori degli attributi dinamici della scrivania da spostare (conforme allo schema SezioneCache.xsd)
3720        																						-- Gli attributi già presenti in DB e per i quali non c'è corrispondente nell'XML restano invariati
3721        																						-- Per tutti gli attributi vale quanto segue:
3722        																						-- Un attributo da settare è un tag "Variabile" dell'XML il cui tag "Nome" contiene il nome identificativo dell'attributo (ATTR_NAME di DMT_ATTRIBUTES_DEF)
3723        																						-- Un attributo da settare è una variabile con tag "ValoreSemplice" se è un attributo a singolo valore e non strutturato (cioè con tipo diverso da COMPLEX)
3724        																						-- altrimenti è una variabile con tag "Lista" che ha un'unica colonna con "Nro" pari a 1 se l'attributo non è strutturato, che ha invece tante colonne quanti gli attributi componenti (ordinate in base al loro NRO_ORD_IN_SUP) se l'attributo è complesso
3725        																						-- Nel caso di variabili con tag "Lista" i valori specificati nell'XML si aggiungono o sostituiscono quelli già presenti in DB a seconda che nell'XML sia presente o meno una variabile con tag "Nome" pari a #Append_<Nome attributo> e tag "ValoreSemplice" pari a 1
3726        																						-- In particolare se non sono specificati valori nell'XML (tag Lista vuoto) e se i valori non sono da aggiungere significa che tutti i valori dell'attributo già presenti in DB vanno rimossi
3727        			FlgRollBckFullIn		IN 		PLS_INTEGER DEFAULT NULL,					-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
3728        																						-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
3729        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,					-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
3730        			ErrContextOut			OUT		VARCHAR2,									-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
3731        			ErrCodeOut				OUT		PLS_INTEGER,								-- N.ro errore di uscita
3732        			ErrMsgOut				OUT 		VARCHAR2								-- Messaggio d'errore
3733        			) return PLS_INTEGER;														-- Vale 1 se tutto è andato a buon fine, altrimenti 0 (in caso di errore)
3734        
3735        	----------funzione per ottenere le variazioni (storicizzate) dei dati di una UO o postazione utente indicata in input
3736        	function GetVariazioniDatiUOSV(
3737        			FlgUOSVIn				IN		VARCHAR2,									-- (obblig.) Flag SV/UO: indica se le variazioni dati da estrarre sono di una UO o di una postazione utente (SV)
3738        			IdUOSVIn				IN		INTEGER,									-- (obblig.) Id. della UO o postazione utente per cui estrarre i dati storici
3739        			VariazioniDalIn			IN		VARCHAR2,									-- Estremo inferiore dell'eventuale intervello temporale in cui devono essersi verificate le variazioni da estrarre (nel formato dato dal parametro di conf. FMT_STD_DATA)
3740        			VariazioniAlIn			IN		VARCHAR2,									-- Estremo superiore dell'eventuale intervello temporale in cui devono essersi verificate le variazioni da estrarre (nel formato dato dal parametro di conf. FMT_STD_DATA)																		--
3741        			VariazioniMLOut		OUT		NOCOPY CLOB,									-- Lista XML (secondo schema ListaStd.xsd) con le variazioni dati della UO/postazione utente
3742        																						-- Ogni riga è una variazione e contiene le seguenti colonne:
3743        																						-- 1: Data della variazione (nel formato dato dal parametro di conf. FMT_STD_DATA)
3744        																						-- 2: Data di istituzione della UO (nel formato dato dal parametro di conf. FMT_STD_DATA) prima della variazione
3745        																						-- 3: Livello gerarchico della UO prima della variazione
3746        																						-- 4: Tipo della UO prima della variazione
3747        																						-- 5: Codice/livelli della UO prima della variazione
3748        																						-- 6: Denominazione UO
3749        																						-- 7: Utente collegato alla postazione (Cognome e Nome + Username)
3750        																						-- 8: Motivo variazione
3751        																						-- 9: Estremi atto variazione
3752        																						-- 10: Intestazione della scrivania prima della variazione
3753        																						-- 11: Ruolo dell'utente nella UO
3754        																						-- 12: Flag 1/0 di delega alle UO subordinate
3755        																						-- 13: Flag 1/0 di delega alle postazioni utente subordinate
3756        																						-- 14: Utente che ha effettuato la variazione
3757        			ErrContextOut			OUT		VARCHAR2,									-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
3758        			ErrCodeOut				OUT		PLS_INTEGER,								-- N.ro errore di uscita
3759        			ErrMsgOut				OUT 	VARCHAR2									-- Messaggio d'errore
3760        			) return PLS_INTEGER;														-- Vale 1 se tutto è andato a buon fine, altrimenti 0 (in caso di errore)
3761        
3762        	----procedura che elimina le relazioni di UO e utenti vs i Punti di Protocollo cessati
3763        	procedure RimuoviRelVsPPCessati;
3764        
3765        	----------funzione per popolare il modulo organigramma grafico
3766        	---------- carica solo UO e relazioni utente-UO attive prese dall'organigramma vigente
3767        	function LoadOrganigrammaXModGrafico(
3768        			 CodIdConnectionTokenIn IN      DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%type,
3769        																						-- (obblig). Codice identificativo del token di connessione
3770                    IdUserLavoroIn          IN      DMT_USERS.ID_USER%type DEFAULT NULL,    	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
3771                    FlgIncludiUtentiIn      IN      PLS_INTEGER DEFAULT NULL,            		-- (valori 2/1/0/NULL): se 2 indica che nell'albero vanno mostrare sia le UO e tutti gli utenti collegati (con o senza scrivania), se 1 che vanno mostrate le UO e gli utenti con scrivania, se 0 o NULL solo le UO
3772                    TipoRelUtentiConUOIn    IN      VARCHAR2 DEFAULT NULL,               		-- (viene considerato solo se FlgIncludiUtentiIn>0) Indica il/i tipi di relazione che gli utenti da mostrare devono avere all'istante TsRifIn con le UO:
3773        																						--  Valori ammessi:
3774        																						--  A = Appartenenza
3775        																						--  D = Delega (ovvero Funzionale)
3776        																						--  L = a Lavorare per (ovvero "A gestire la documentazione della UO")
3777        																						-- o una loro cancatenazione con ";" come separatore
3778        																						-- Se non valorizzato è come se contenesse tutti i valori previsti
3779        			IdUORootIn            	IN		VARCHAR2 DEFAULT NULL,                 		-- Identificativo della UO a partire della quale caricare l'organigramma
3780        																						-- Se in input non è valorizzato si intende pari l'intera struttura organizzativa
3781                    LivelloMaxIn			IN		PLS_INTEGER,								-- Indica il max livello gerarchico delle UO da estrarre
3782        																						-- ad es. se 3 significa che verranno estratte solo UO del livelli 1, 2 e 3
3783        			CodTipiUOIn				IN		VARCHAR2 DEFAULT NULL,						-- Codice/i dei tipi UO da estrarre
3784        																						-- Se più di uno sono separati da ;
3785        																						-- es: se vale DIREZIONE;AREA significa che verranno estratte solo le UO di questi tipi
3786        			OrganigrammaXMLOut      OUT     NOCOPY CLOB,                    			-- XML con strutture ed utenti della porzione di organigramma chiesta
3787        																						-- XML del tipo:
3788        																						-- <Organigramma>
3789        																						-- <UO>
3790        																						-- 		<idNode>1780</idNode>
3791        																						-- 		<idUo>1780</idUo>
3792        																						-- 		<tipo>SETT</tipo>
3793        																						-- 		<parentId/>
3794        																						-- 		<nome>XXX</nome>
3795        																						-- 		<nroProgr>1</nroProgr>
3796        																						-- 		<codRapidoUo>1.E/codRapidoUo>
3797        																						-- 		<flgEsplodiNodo>1</flgEsplodiNodo>
3798        																						-- 		<competenze/>
3799        																						-- 		<note></note>
3800        																						-- 		<level>1</level>
3801        																						-- 		<listaUtentiAssociati>
3802        																						-- 			<utenteAssociato>
3803        																						-- 				<idUser>100154</idUser>
3804        																						-- 				<cognomeNome>Buono Federica</cognomeNome>
3805        																						-- 				<matricola>xxx</matricola>
3806        																						-- 				<idRuolo/>
3807        																						-- 				<descrizioneRuolo/>
3808        																						-- 				<idScrivania/>
3809        																						-- 			</utenteAssociato>
3810        																						-- 		</listaUtentiAssociati>
3811        																						-- 	</UO>
3812        																						-- 	</Organigramma>
3813                    ErrContextOut           OUT        VARCHAR2,                        		-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
3814                    ErrCodeOut              OUT        PLS_INTEGER,                    			-- N.ro errore di uscita
3815                    ErrMsgOut               OUT        VARCHAR2)                        		-- Messaggio d'errore
3816                    return PLS_INTEGER;                                           				-- Vale 1 se tutto è andato a buon fine, altrimenti 0
3817        
3818        END DMPK_DEF_SECURITY;